[0m02:34:51.674126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256cb0c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256bf406b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256bacd8b0>]}


============================== 02:34:51.677663 | bff75f5a-4575-4324-ae44-ededc7dcd341 ==============================
[0m02:34:51.677663 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:34:51.678133 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m02:34:51.685661 [info ] [MainThread]: dbt version: 1.10.13
[0m02:34:51.686033 [info ] [MainThread]: python version: 3.12.3
[0m02:34:51.686295 [info ] [MainThread]: python path: /home/chun/Develop/datacore/venv/bin/python3
[0m02:34:51.686559 [info ] [MainThread]: os info: Linux-6.14.0-34-generic-x86_64-with-glibc2.39
[0m02:34:51.786932 [info ] [MainThread]: Using profiles dir at /home/chun/Develop/datacore
[0m02:34:51.787393 [info ] [MainThread]: Using profiles.yml file at /home/chun/Develop/datacore/profiles.yml
[0m02:34:51.787661 [info ] [MainThread]: Using dbt_project.yml file at /home/chun/Develop/datacore/dbt_project.yml
[0m02:34:51.788829 [info ] [MainThread]: adapter type: duckdb
[0m02:34:51.789102 [info ] [MainThread]: adapter version: 1.10.0
[0m02:34:51.885721 [info ] [MainThread]: Configuration:
[0m02:34:51.886191 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:34:51.886471 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:34:51.886736 [info ] [MainThread]: Required dependencies:
[0m02:34:51.887022 [debug] [MainThread]: Executing "git --help"
[0m02:34:51.890799 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:34:51.891452 [debug] [MainThread]: STDERR: "b''"
[0m02:34:51.891804 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:34:51.892108 [info ] [MainThread]: Connection:
[0m02:34:51.892407 [info ] [MainThread]:   database: datacore
[0m02:34:51.892665 [info ] [MainThread]:   schema: main
[0m02:34:51.892918 [info ] [MainThread]:   path: datacore.duckdb
[0m02:34:51.893169 [info ] [MainThread]:   config_options: None
[0m02:34:51.893430 [info ] [MainThread]:   extensions: None
[0m02:34:51.893685 [info ] [MainThread]:   settings: {}
[0m02:34:51.893936 [info ] [MainThread]:   external_root: .
[0m02:34:51.894190 [info ] [MainThread]:   use_credential_provider: None
[0m02:34:51.894461 [info ] [MainThread]:   attach: None
[0m02:34:51.894711 [info ] [MainThread]:   filesystems: None
[0m02:34:51.894961 [info ] [MainThread]:   remote: None
[0m02:34:51.895213 [info ] [MainThread]:   plugins: None
[0m02:34:51.895490 [info ] [MainThread]:   disable_transactions: False
[0m02:34:51.895877 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:51.971497 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:34:51.995323 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:34:51.995691 [debug] [MainThread]: On debug: select 1 as id
[0m02:34:51.995953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:34:52.010430 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m02:34:52.011395 [debug] [MainThread]: On debug: Close
[0m02:34:52.011756 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:34:52.012046 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:34:52.012877 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39526767, "process_in_blocks": "3912", "process_kernel_time": 0.213427, "process_mem_max_rss": "140680", "process_out_blocks": "24", "process_user_time": 1.490998}
[0m02:34:52.013267 [debug] [MainThread]: Command `dbt debug` succeeded at 02:34:52.013185 after 0.40 seconds
[0m02:34:52.013546 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:34:52.013841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256c3e2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c255a324260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c256acaa1b0>]}
[0m02:34:52.014172 [debug] [MainThread]: Flushing usage events
[0m02:34:53.493517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:34:58.837081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9fd3fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f77ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f548f20>]}


============================== 02:34:58.841172 | 9185fe2d-257f-4b9b-959e-1ef7e3dc74eb ==============================
[0m02:34:58.841172 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:34:58.841651 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_cache_events': 'False'}
[0m02:34:59.041812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9ed22f90>]}
[0m02:34:59.100517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9fb4d250>]}
[0m02:34:59.102204 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:34:59.184093 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:34:59.184695 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:34:59.185011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e8eff4500>]}
[0m02:35:00.859322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2ca4b050>]}
[0m02:35:00.972701 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:00.974991 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:01.091880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2cbc5100>]}
[0m02:35:01.092452 [info ] [MainThread]: Found 18 models, 15 data tests, 1 seed, 4 sources, 463 macros
[0m02:35:01.092793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c93c980>]}
[0m02:35:01.094643 [info ] [MainThread]: 
[0m02:35:01.094996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:01.095258 [info ] [MainThread]: 
[0m02:35:01.095750 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:01.100491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:01.140469 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:01.140883 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:01.141179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:01.156734 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m02:35:01.158146 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:01.158837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_staging)
[0m02:35:01.159238 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:01.165485 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.165831 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:01.166099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.167202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.168378 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.168649 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:01.169375 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:01.169627 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.169877 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:01.170342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:01.171037 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:01.171313 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:01.171567 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:01.173366 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m02:35:01.173668 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:01.176864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now list_datacore_main_staging)
[0m02:35:01.182721 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:01.183047 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:01.183312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.184088 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.184356 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:01.184616 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.198177 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:35:01.199412 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:01.200507 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:01.200779 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:01.201365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_ods)
[0m02:35:01.204643 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:01.204974 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:01.205227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.206018 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.206282 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:01.206553 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.211154 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.212299 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:01.213131 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:01.213400 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:01.213942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_dwd)
[0m02:35:01.215669 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:01.215942 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:01.216198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.216836 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.217092 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:01.217357 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.221897 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.223018 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:01.223821 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:01.224082 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:01.224623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ads)
[0m02:35:01.226376 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:01.226646 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:01.226895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.227513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.227767 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:01.228022 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.232285 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.233380 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:01.234169 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:01.234435 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:01.234972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main)
[0m02:35:01.236668 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:01.236937 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:01.237182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.237774 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.238026 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:01.238288 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.241221 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:01.242285 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:01.243089 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:01.243357 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:01.243901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_metadata)
[0m02:35:01.245638 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:01.245911 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:01.246159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.246821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.247075 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:01.247341 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.250250 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:01.251333 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:01.252143 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:01.252412 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:01.253196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dws)
[0m02:35:01.254917 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:01.255186 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:01.255449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:01.256064 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:01.256323 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:01.256578 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:01.261075 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:01.262170 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:01.262972 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:01.263231 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:01.264129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c9682f0>]}
[0m02:35:01.265071 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.265609 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.266087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:01.267155 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:01.267664 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.268143 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.268621 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.269367 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:01.269857 [debug] [MainThread]: On master: Close
[0m02:35:01.273886 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:01.274791 [info ] [Thread-1 (]: 1 of 4 START sql view model main_staging.stg_payment_method_dict ............... [RUN]
[0m02:35:01.275565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now model.datacore.stg_payment_method_dict)
[0m02:35:01.276173 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:01.288259 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:01.289106 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:01.319926 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:01.320768 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:01.321129 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:01.321470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.322409 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.322747 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:01.323099 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."payment_method_dict"
  );

[0m02:35:01.324013 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."payment_method_dict"
  );

[0m02:35:01.324389 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.324844 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: ROLLBACK
[0m02:35:01.328562 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_payment_method_dict'
[0m02:35:01.328923 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:01.331179 [debug] [Thread-1 (]: Runtime Error in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.332746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c78c3e0>]}
[0m02:35:01.333391 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main_staging.stg_payment_method_dict ...... [[31mERROR[0m in 0.06s]
[0m02:35:01.333988 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:01.334400 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:01.335261 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_payment_method_dict' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.336039 [info ] [Thread-1 (]: 2 of 4 START sql view model main_staging.stg_toll_station ...................... [RUN]
[0m02:35:01.338280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:01.338668 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:01.342062 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:01.342586 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:01.347206 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:01.347817 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:01.348177 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:01.348523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.349423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.349764 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:01.350112 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."toll_station"
  );

[0m02:35:01.350886 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."toll_station"
  );

[0m02:35:01.351255 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.351708 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: ROLLBACK
[0m02:35:01.354274 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_toll_station'
[0m02:35:01.354612 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:01.357078 [debug] [Thread-1 (]: Runtime Error in model stg_toll_station (models/staging/stg_toll_station.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.357495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c7ae930>]}
[0m02:35:01.358048 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main_staging.stg_toll_station ............. [[31mERROR[0m in 0.02s]
[0m02:35:01.358562 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:01.358925 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:01.359523 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_toll_station' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_toll_station (models/staging/stg_toll_station.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.360045 [info ] [Thread-1 (]: 3 of 4 START sql view model main_staging.stg_toll_transaction .................. [RUN]
[0m02:35:01.360690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:01.361015 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:01.364419 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:01.364896 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:01.367370 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:01.367849 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:01.368171 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:01.368487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.369322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.369637 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:01.370033 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "main"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:01.371240 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "main"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:01.371672 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.372070 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: ROLLBACK
[0m02:35:01.374456 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_toll_transaction'
[0m02:35:01.374780 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:01.376785 [debug] [Thread-1 (]: Runtime Error in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.377172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2c77ec90>]}
[0m02:35:01.377719 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model main_staging.stg_toll_transaction ......... [[31mERROR[0m in 0.02s]
[0m02:35:01.378221 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:01.378574 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:01.379276 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_toll_transaction' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.379942 [info ] [Thread-1 (]: 4 of 4 START sql view model main_staging.stg_vehicle_type_dict ................. [RUN]
[0m02:35:01.380672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:01.380987 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:01.383921 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.384401 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:01.386750 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.387222 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.387548 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:01.387855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:01.388671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:01.388980 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:01.389300 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."vehicle_type_dict"
  );

[0m02:35:01.390006 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "main"."raw"."vehicle_type_dict"
  );

[0m02:35:01.390352 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:01.390745 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: ROLLBACK
[0m02:35:01.393176 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.stg_vehicle_type_dict'
[0m02:35:01.393510 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:01.395529 [debug] [Thread-1 (]: Runtime Error in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.395921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9185fe2d-257f-4b9b-959e-1ef7e3dc74eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e2cafe930>]}
[0m02:35:01.396470 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model main_staging.stg_vehicle_type_dict ........ [[31mERROR[0m in 0.02s]
[0m02:35:01.396972 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:01.397771 [debug] [Thread-4 (]: Marking all children of 'model.datacore.stg_vehicle_type_dict' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)
  Binder Error: Catalog "main" does not exist!.
[0m02:35:01.399638 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.400250 [debug] [MainThread]: On master: BEGIN
[0m02:35:01.400804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:01.401971 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:01.402550 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.403092 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:01.403637 [debug] [MainThread]: On master: COMMIT
[0m02:35:01.404492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:01.405043 [debug] [MainThread]: On master: Close
[0m02:35:01.405808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:01.406361 [debug] [MainThread]: Connection 'model.datacore.stg_vehicle_type_dict' was properly closed.
[0m02:35:01.407003 [info ] [MainThread]: 
[0m02:35:01.407654 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m02:35:01.409745 [debug] [MainThread]: Command end result
[0m02:35:01.457469 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:01.459369 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:01.464675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:01.465010 [info ] [MainThread]: 
[0m02:35:01.465361 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:35:01.465647 [info ] [MainThread]: 
[0m02:35:01.466019 [error] [MainThread]: [31mFailure in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)[0m
[0m02:35:01.466371 [error] [MainThread]:   Runtime Error in model stg_payment_method_dict (models/staging/stg_payment_method_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.466629 [info ] [MainThread]: 
[0m02:35:01.466950 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_payment_method_dict.sql
[0m02:35:01.467214 [info ] [MainThread]: 
[0m02:35:01.467543 [error] [MainThread]: [31mFailure in model stg_toll_station (models/staging/stg_toll_station.sql)[0m
[0m02:35:01.467864 [error] [MainThread]:   Runtime Error in model stg_toll_station (models/staging/stg_toll_station.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.468120 [info ] [MainThread]: 
[0m02:35:01.468450 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_toll_station.sql
[0m02:35:01.468708 [info ] [MainThread]: 
[0m02:35:01.469029 [error] [MainThread]: [31mFailure in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)[0m
[0m02:35:01.469356 [error] [MainThread]:   Runtime Error in model stg_toll_transaction (models/staging/stg_toll_transaction.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.469608 [info ] [MainThread]: 
[0m02:35:01.469918 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_toll_transaction.sql
[0m02:35:01.470175 [info ] [MainThread]: 
[0m02:35:01.470526 [error] [MainThread]: [31mFailure in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)[0m
[0m02:35:01.470848 [error] [MainThread]:   Runtime Error in model stg_vehicle_type_dict (models/staging/stg_vehicle_type_dict.sql)
  Binder Error: Catalog "main" does not exist!
[0m02:35:01.471099 [info ] [MainThread]: 
[0m02:35:01.471410 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/staging/stg_vehicle_type_dict.sql
[0m02:35:01.471666 [info ] [MainThread]: 
[0m02:35:01.471956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=4
[0m02:35:01.472838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6919713, "process_in_blocks": "472", "process_kernel_time": 0.283924, "process_mem_max_rss": "161056", "process_out_blocks": "4056", "process_user_time": 3.773285}
[0m02:35:01.473241 [debug] [MainThread]: Command `dbt run` failed at 02:35:01.473151 after 2.69 seconds
[0m02:35:01.473598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f7eb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f7ea8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e9f7e9490>]}
[0m02:35:01.473921 [debug] [MainThread]: Flushing usage events
[0m02:35:02.919842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:22.674247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c604ffe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c614dbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c617023c0>]}


============================== 02:35:22.678359 | bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110 ==============================
[0m02:35:22.678359 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:22.678906 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select staging', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80'}
[0m02:35:22.899395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5fbfd8e0>]}
[0m02:35:22.959437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f737050>]}
[0m02:35:22.961113 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:23.043238 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:23.174436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:23.176352 [debug] [MainThread]: Partial parsing: updated file: datacore://models/sources.yml
[0m02:35:23.960366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f1da810>]}
[0m02:35:24.064407 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:24.066596 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:24.082318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f3daa50>]}
[0m02:35:24.082887 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:24.083234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f2c5bb0>]}
[0m02:35:24.085214 [info ] [MainThread]: 
[0m02:35:24.085577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:24.085871 [info ] [MainThread]: 
[0m02:35:24.086378 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:24.091577 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:24.125356 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:24.125752 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:24.126032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:24.143264 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:35:24.144623 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:24.145408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_staging)
[0m02:35:24.145798 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:24.151970 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.152289 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:24.152572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.153985 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.155139 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.155430 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:24.155875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:24.156122 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.156382 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:24.156909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:24.157599 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:24.157864 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:24.158112 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:24.158517 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:24.158772 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:24.161947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now list_datacore_main_ads)
[0m02:35:24.167094 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:24.167425 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:24.167683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.168763 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.169120 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:24.169458 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.183768 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m02:35:24.185065 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:24.186099 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:24.186376 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:24.186948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:35:24.190043 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:24.190384 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:24.190731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.191669 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.192025 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:24.192393 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.197724 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:24.199277 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:24.200408 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:24.200761 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:24.201520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_dwd)
[0m02:35:24.203801 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:24.204176 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:24.204524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.205402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.205761 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:24.206123 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.211515 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:24.213074 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:24.214154 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:24.214521 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:24.215274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_staging)
[0m02:35:24.217528 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:24.217905 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:24.218253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.219075 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.219374 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:24.219668 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.224568 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:24.225812 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:24.226684 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:24.226961 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:24.227584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:35:24.229471 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:24.229767 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:24.230042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.230735 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.231015 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:24.231295 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.235076 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:24.236355 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:24.237233 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:24.237523 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:24.238437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dws)
[0m02:35:24.240322 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:24.240617 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:24.240888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.241816 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.242093 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:24.242384 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.245649 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:24.246818 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:24.247703 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:24.247984 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:24.248563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m02:35:24.250390 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:24.250684 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:24.250955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:24.251661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:24.251938 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:24.252222 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:24.257007 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:24.258164 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:24.259016 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:24.259295 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:24.260244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f21b3b0>]}
[0m02:35:24.261256 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.261830 [debug] [MainThread]: On master: BEGIN
[0m02:35:24.262354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:24.263461 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:24.263984 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.264509 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.264998 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.265808 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:24.266341 [debug] [MainThread]: On master: Close
[0m02:35:24.269658 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:24.270587 [info ] [Thread-1 (]: 1 of 4 START sql view model main_staging.stg_payment_method_dict ............... [RUN]
[0m02:35:24.271352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now model.datacore.stg_payment_method_dict)
[0m02:35:24.272032 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:24.285166 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:24.285778 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:24.313654 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:24.314287 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.314622 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:24.314925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.315836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.316147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.316475 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:35:24.317373 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.322814 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.323193 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:35:24.324000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.333191 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:24.333569 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.333882 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:24.335621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.342143 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:24.342538 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:35:24.343332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.345454 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:24.347337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c6013ca70>]}
[0m02:35:24.347890 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_staging.stg_payment_method_dict .......... [[32mOK[0m in 0.08s]
[0m02:35:24.348418 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:24.348779 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:24.349250 [info ] [Thread-1 (]: 2 of 4 START sql view model main_staging.stg_toll_station ...................... [RUN]
[0m02:35:24.349629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:24.349948 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:24.352732 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:24.353253 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:24.355594 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:24.356089 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.356412 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:24.356718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.357820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.358129 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.358460 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:35:24.359395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.361819 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.362150 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:35:24.362809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.363829 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:24.364155 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.364466 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:24.365762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.367630 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:24.367957 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:35:24.368551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.369656 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:24.370221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bec087c80>]}
[0m02:35:24.370743 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main_staging.stg_toll_station ................. [[32mOK[0m in 0.02s]
[0m02:35:24.371243 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:24.371604 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:24.372067 [info ] [Thread-1 (]: 3 of 4 START sql view model main_staging.stg_toll_transaction .................. [RUN]
[0m02:35:24.372435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:24.372751 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:24.375970 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:24.376504 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:24.378926 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:24.379440 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.379764 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:24.380074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.380909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.381219 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.381626 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:24.383622 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:24.386117 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.386472 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:35:24.387213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.388245 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:24.388583 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.388893 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:24.390513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.392425 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:24.392763 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:35:24.393409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.394524 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:24.395093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bec42f230>]}
[0m02:35:24.395618 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main_staging.stg_toll_transaction ............. [[32mOK[0m in 0.02s]
[0m02:35:24.396119 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:24.396476 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:24.396918 [info ] [Thread-1 (]: 4 of 4 START sql view model main_staging.stg_vehicle_type_dict ................. [RUN]
[0m02:35:24.397283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:24.397605 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:24.400332 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.400840 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:24.404887 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.405447 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.405774 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:24.406089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:24.406938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.407250 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.407578 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:35:24.408480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.410839 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.411174 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:35:24.411920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.412947 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:24.413277 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.413592 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:24.414873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:24.416699 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:24.417031 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:35:24.417628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:24.418726 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:24.419264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb4ffeb5-f9a0-41ed-8f0a-9dbbc8b59110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777bec0c7fb0>]}
[0m02:35:24.419788 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main_staging.stg_vehicle_type_dict ............ [[32mOK[0m in 0.02s]
[0m02:35:24.420284 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:24.422172 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.422889 [debug] [MainThread]: On master: BEGIN
[0m02:35:24.423404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:24.424526 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:24.425041 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.425574 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:24.426064 [debug] [MainThread]: On master: COMMIT
[0m02:35:24.426937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:24.427473 [debug] [MainThread]: On master: Close
[0m02:35:24.428213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:24.428711 [debug] [MainThread]: Connection 'model.datacore.stg_vehicle_type_dict' was properly closed.
[0m02:35:24.429342 [info ] [MainThread]: 
[0m02:35:24.429916 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m02:35:24.431826 [debug] [MainThread]: Command end result
[0m02:35:24.479673 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:24.481670 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:24.487095 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:24.487483 [info ] [MainThread]: 
[0m02:35:24.487825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:35:24.488096 [info ] [MainThread]: 
[0m02:35:24.488404 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:35:24.489262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8663715, "process_in_blocks": "0", "process_kernel_time": 0.280344, "process_mem_max_rss": "160052", "process_out_blocks": "4104", "process_user_time": 2.91799}
[0m02:35:24.489675 [debug] [MainThread]: Command `dbt run` succeeded at 02:35:24.489593 after 1.87 seconds
[0m02:35:24.490008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5fb0d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4c1e8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c4f2f78f0>]}
[0m02:35:24.490347 [debug] [MainThread]: Flushing usage events
[0m02:35:25.913844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:30.692445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27b3c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27c51cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca2781a6c0>]}


============================== 02:35:30.696022 | 56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff ==============================
[0m02:35:30.696022 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:30.696513 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/home/chun/Develop/datacore/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m02:35:30.901543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca29c327b0>]}
[0m02:35:30.962112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca282f6f90>]}
[0m02:35:30.963827 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:31.045574 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:31.177898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:31.178314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:31.241808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27c7d730>]}
[0m02:35:31.355513 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:31.357431 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:31.371830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca174ad190>]}
[0m02:35:31.372392 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:31.372723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27383560>]}
[0m02:35:31.375123 [info ] [MainThread]: 
[0m02:35:31.375482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:31.375763 [info ] [MainThread]: 
[0m02:35:31.376265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:31.382558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:31.419242 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.419635 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.419908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:31.435315 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m02:35:31.436657 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.438666 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.439053 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.439339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.440339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.441359 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.443065 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.443394 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.443652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.444586 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.445581 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.447262 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.447606 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.447861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.448780 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.449749 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.451418 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.451762 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.452021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.452958 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.453952 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.455655 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:31.455969 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:31.456227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.457181 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.458164 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:31.458890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_dws)
[0m02:35:31.459266 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m02:35:31.466213 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.466587 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.466847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.468244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.469453 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.469714 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m02:35:31.470155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.470409 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.470653 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m02:35:31.471193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.471874 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:31.472134 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:31.472381 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:31.474109 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.474539 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m02:35:31.475259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_metadata)
[0m02:35:31.475728 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:35:31.477295 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.477581 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.477833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.478781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.479834 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.480096 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:35:31.480566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.480817 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.481064 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:35:31.481513 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.482186 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:31.482455 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:31.482700 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:31.483745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.484007 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:35:31.484554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_dwd)
[0m02:35:31.484946 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m02:35:31.486464 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.486734 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.486987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.487898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.488953 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.489212 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m02:35:31.489681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.489927 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.490173 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m02:35:31.490696 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.491371 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:31.491631 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:31.491874 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:31.492924 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.493184 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m02:35:31.493728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now create_datacore_main_ods)
[0m02:35:31.494133 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m02:35:31.495637 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.495902 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.496154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.497058 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.498085 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.498370 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m02:35:31.498798 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.499043 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.499286 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m02:35:31.499731 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.500408 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:31.500665 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:31.500905 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:31.502625 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.502889 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m02:35:31.503446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_ads)
[0m02:35:31.503836 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m02:35:31.505356 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.505630 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.505882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.506790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.507838 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.508096 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m02:35:31.508525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.508770 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.509015 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m02:35:31.509472 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.510148 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:31.510415 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:31.510658 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:31.512388 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.512651 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m02:35:31.513191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now create_datacore_main_staging)
[0m02:35:31.513598 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:31.515156 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.515436 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:31.515688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.516613 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.517669 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.517954 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:31.518383 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.518633 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.518880 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:31.519333 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.520008 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:31.520264 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:31.520514 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:31.520907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:31.521162 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:31.524874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now list_datacore_main_dws)
[0m02:35:31.530091 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:31.530393 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:31.530641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.531294 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.531557 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:31.531812 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.545033 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:35:31.546172 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:31.547168 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:31.547437 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:31.548036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m02:35:31.549686 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:31.549959 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:31.550205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.550782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.551101 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:31.551369 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.554915 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.555998 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:31.556819 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:31.557074 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:31.557594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:35:31.559158 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:31.559428 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:31.559672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.560332 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.560581 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:31.560838 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.563844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.564890 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:31.565677 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:31.565924 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:31.566440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main)
[0m02:35:31.567995 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:31.568259 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:31.568514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.569059 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.569333 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:31.569598 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.574325 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:31.575384 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:31.576174 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:31.576437 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:31.576956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ods)
[0m02:35:31.579866 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:31.580146 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:31.580404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.581006 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.581259 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:31.581524 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.586440 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:35:31.587614 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:31.588457 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:31.588732 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:31.589348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m02:35:31.655138 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:31.655582 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:31.655863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.656642 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.656922 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:31.657209 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.660650 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.661834 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:31.662689 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:31.662968 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:31.663915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m02:35:31.665721 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:31.666011 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:31.666280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:31.666888 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:31.667166 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:31.667459 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:31.670769 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:31.672034 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:31.672879 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:31.673154 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:31.675335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca287923f0>]}
[0m02:35:31.676158 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:31.676670 [debug] [MainThread]: On master: BEGIN
[0m02:35:31.677145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:31.678193 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:31.678690 [debug] [MainThread]: On master: COMMIT
[0m02:35:31.679160 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:31.679631 [debug] [MainThread]: On master: COMMIT
[0m02:35:31.680390 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:31.680876 [debug] [MainThread]: On master: Close
[0m02:35:31.684266 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:35:31.685215 [info ] [Thread-1 (]: 1 of 18 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m02:35:31.685984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now model.datacore.meta_data_lineage)
[0m02:35:31.686625 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:35:31.700097 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:35:31.701151 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:35:31.730998 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:35:31.731682 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.732004 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:35:31.732316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.733118 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.733435 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.733806 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª



-- ‰ªérawÂà∞stagingÁöÑË°ÄÁºò
SELECT 
    'raw.toll_transaction' AS source_table,
    'staging.stg_toll_transaction' AS target_table,
    'Ê∏ÖÊ¥ó' AS transformation_type,
    'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT 
    'raw.toll_station',
    'staging.stg_toll_station',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.vehicle_type_dict',
    'staging.stg_vehicle_type_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.payment_method_dict',
    'staging.stg_payment_method_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
-- ‰ªéstagingÂà∞odsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'staging.stg_toll_transaction',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®Âíå‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊî∂Ë¥πÁ´ô‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_vehicle_type_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîËΩ¶Âûã‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_payment_method_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊîØ‰ªòÊñπÂºè‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_station',
    'ËΩ¨Êç¢',
    '‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
-- ‰ªéodsÂà∞dwdÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'ods.ods_toll_transaction',
    'dwd.dwd_toll_transaction_detail',
    'ËΩ¨Êç¢',
    '‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆËΩ¨Êç¢'
-- ‰ªédwdÂà∞dwsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_toll_revenue_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÊ±áÊÄª'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_traffic_flow_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÊ±áÊÄªËΩ¶ÊµÅÈáè'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_station_performance_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ôÊ±áÊÄªÁª©Êïà'
-- ‰ªédwsÂà∞adsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dws.dws_toll_revenue_daily',
    'ads.ads_toll_revenue_report',
    'ËÅöÂêà',
    'ÁîüÊàêÊî∂ÂÖ•Êä•Ë°®'
UNION ALL
SELECT 
    'dws.dws_traffic_flow_daily',
    'ads.ads_traffic_trend_analysis',
    'ËÅöÂêà',
    'ÁîüÊàêËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'ads.ads_quality_monitoring_dashboard',
    'ËÅöÂêà',
    'ÁîüÊàêË¥®ÈáèÁõëÊéßÁúãÊùø'
    );
  
  
[0m02:35:31.737334 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:31.742842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.743204 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:35:31.743943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.755969 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:31.756359 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.756671 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:31.758398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.763237 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:31.763594 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:35:31.764328 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.766602 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:35:31.768477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca28431fd0>]}
[0m02:35:31.769071 [info ] [Thread-1 (]: 1 of 18 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.08s]
[0m02:35:31.769647 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:35:31.770041 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:35:31.770562 [info ] [Thread-1 (]: 2 of 18 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m02:35:31.770969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m02:35:31.771322 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:35:31.774504 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:35:31.775050 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:35:31.777788 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:35:31.778349 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.778690 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:35:31.779019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.779850 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.780177 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.780595 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ



SELECT 
    'staging' AS schema_name,
    'stg_toll_transaction' AS table_name,
    'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description,
    'Êî∂Ë¥π‰∏öÂä°' AS business_domain,
    'Êî∂Ë¥πÁ≥ªÁªü' AS data_source,
    'ÂÆûÊó∂' AS update_frequency,
    'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner,
    'staging' AS data_layer,
    CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 
    'staging',
    'stg_toll_station',
    'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'staging',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_transaction',
    'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_station',
    'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dwd',
    'dwd_toll_transaction_detail',
    'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dwd',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_toll_revenue_daily',
    'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_traffic_flow_daily',
    'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_station_performance_daily',
    'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_toll_revenue_report',
    'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_traffic_trend_analysis',
    'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_quality_monitoring_dashboard',
    'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø',
    'Êï∞ÊçÆÁÆ°ÁêÜ',
    'Êï∞ÊçÆ‰∏≠Âè∞',
    'ÂÆûÊó∂',
    'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®',
    'ads',
    CURRENT_TIMESTAMP
    );
  
  
[0m02:35:31.784055 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:31.788358 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.788749 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:35:31.789540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.790722 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:31.791076 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.791411 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:31.792882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.794917 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:31.795269 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:35:31.795905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.797104 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:35:31.797762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140e0980>]}
[0m02:35:31.798314 [info ] [Thread-1 (]: 2 of 18 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.03s]
[0m02:35:31.798849 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:35:31.799225 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:31.799716 [info ] [Thread-1 (]: 3 of 18 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m02:35:31.800093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.stg_payment_method_dict)
[0m02:35:31.800442 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:31.803442 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:31.804022 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:31.820786 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:31.821505 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.821822 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:31.822118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.822961 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.823265 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.823591 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:35:31.824426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.826979 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.827346 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m02:35:31.828076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.830406 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.830741 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:35:31.831396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.834389 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:31.834753 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.835060 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:31.836459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.838410 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:31.838734 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:35:31.840034 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.841176 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:31.841729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca17702c00>]}
[0m02:35:31.842243 [info ] [Thread-1 (]: 3 of 18 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m02:35:31.842743 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:31.843091 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:31.843567 [info ] [Thread-1 (]: 4 of 18 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m02:35:31.843938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:31.844251 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:31.847039 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:31.847602 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:31.850071 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:31.850607 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.850921 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:31.851218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.851972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.852273 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.852593 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:35:31.853451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.855912 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.856255 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m02:35:31.856952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.860780 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.861174 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:35:31.861962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.863186 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:31.863629 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.863935 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:31.865437 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.867765 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:31.868127 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:35:31.869498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.870755 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:31.871559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140b9ca0>]}
[0m02:35:31.872108 [info ] [Thread-1 (]: 4 of 18 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.03s]
[0m02:35:31.872658 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:31.873039 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:31.873699 [info ] [Thread-1 (]: 5 of 18 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m02:35:31.874105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:31.874457 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:31.877985 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:31.878580 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:31.881221 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:31.881774 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.882119 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:31.882457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.883252 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.883592 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.884020 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST((exit_time - entry_time) AS BIGINT) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:31.885993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.888738 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.889104 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m02:35:31.889873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.892298 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.892666 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:35:31.893359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.894511 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:31.894862 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.895295 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:31.897005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.899063 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:31.899424 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:35:31.900751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.901955 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:31.902552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140b29c0>]}
[0m02:35:31.903105 [info ] [Thread-1 (]: 5 of 18 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m02:35:31.903647 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:31.904022 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:31.904512 [info ] [Thread-1 (]: 6 of 18 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m02:35:31.904896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:31.905229 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:31.908213 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.908794 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:31.911331 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.911855 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.912192 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:31.912524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.913324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.913651 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.913992 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:35:31.914862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.917504 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.917867 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m02:35:31.918619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.921103 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.921480 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:35:31.922177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.923355 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:31.923698 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.924023 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:31.925341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.929133 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:31.929538 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:35:31.930936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.932152 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:31.932736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9cc4ae330>]}
[0m02:35:31.933291 [info ] [Thread-1 (]: 6 of 18 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m02:35:31.933838 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:31.934205 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m02:35:31.934699 [info ] [Thread-1 (]: 7 of 18 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m02:35:31.935232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m02:35:31.935592 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m02:35:31.938639 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m02:35:31.939227 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m02:35:31.941862 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m02:35:31.942420 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.942759 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m02:35:31.943084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.943892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.944221 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.944582 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m02:35:31.946920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:31.949666 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.950020 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m02:35:31.950716 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.951872 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:31.952215 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.952543 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:31.954015 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.956021 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:31.956377 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m02:35:31.956976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.958163 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m02:35:31.958812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca141cf4d0>]}
[0m02:35:31.959368 [info ] [Thread-1 (]: 7 of 18 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.02s]
[0m02:35:31.959903 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m02:35:31.960283 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:35:31.960767 [info ] [Thread-1 (]: 8 of 18 START sql table model main_metadata.meta_data_dictionary ............... [RUN]
[0m02:35:31.961157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m02:35:31.961515 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:35:31.965000 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:35:31.965546 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:35:31.968168 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:35:31.968717 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.969059 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:35:31.969396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:31.970203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.970549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.970951 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:35:31.974969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:35:31.977860 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.978229 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:35:31.978970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.980242 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:31.980604 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.980936 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:31.982354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:31.984332 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:31.984684 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:35:31.985282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:31.986474 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:35:31.987237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca179e6480>]}
[0m02:35:31.987789 [info ] [Thread-1 (]: 8 of 18 OK created sql table model main_metadata.meta_data_dictionary .......... [[32mOK[0m in 0.03s]
[0m02:35:31.988340 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:35:31.988719 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m02:35:31.989185 [info ] [Thread-1 (]: 9 of 18 START sql table model main_ods.ods_toll_transaction .................... [RUN]
[0m02:35:31.989588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m02:35:31.989931 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m02:35:31.993957 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m02:35:31.994490 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m02:35:31.998722 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m02:35:31.999257 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:31.999600 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m02:35:31.999920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:32.000737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:32.001063 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:32.001454 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:35:32.012153 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:35:32.012717 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:32.013184 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: ROLLBACK
[0m02:35:32.016973 [debug] [Thread-1 (]: Failed to rollback 'model.datacore.ods_toll_transaction'
[0m02:35:32.017359 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m02:35:32.019980 [debug] [Thread-1 (]: Runtime Error in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)
  Conversion Error: Unimplemented type for cast (INTERVAL -> BIGINT)
  
  LINE 55: LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict"...
               ^
[0m02:35:32.020438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d6b2d6-f4a5-4b72-a4c8-9730de61f0ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9cc4b8ad0>]}
[0m02:35:32.021003 [error] [Thread-1 (]: 9 of 18 ERROR creating sql table model main_ods.ods_toll_transaction ........... [[31mERROR[0m in 0.03s]
[0m02:35:32.021551 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m02:35:32.022286 [debug] [Thread-4 (]: Marking all children of 'model.datacore.ods_toll_transaction' to be skipped because of status 'error'.  Reason: Runtime Error in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)
  Conversion Error: Unimplemented type for cast (INTERVAL -> BIGINT)
  
  LINE 55: LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict"...
               ^.
[0m02:35:32.024376 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m02:35:32.024738 [info ] [Thread-1 (]: 10 of 18 SKIP relation main_dwd.dwd_toll_transaction_detail .................... [[33mSKIP[0m]
[0m02:35:32.025104 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m02:35:32.025948 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:32.026379 [info ] [Thread-1 (]: 11 of 18 SKIP relation main_ads.ads_quality_monitoring_dashboard ............... [[33mSKIP[0m]
[0m02:35:32.026742 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:32.027075 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m02:35:32.027480 [info ] [Thread-1 (]: 12 of 18 SKIP relation main_dws.dws_station_performance_daily .................. [[33mSKIP[0m]
[0m02:35:32.027839 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m02:35:32.028170 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m02:35:32.028574 [info ] [Thread-1 (]: 13 of 18 SKIP relation main_dws.dws_toll_revenue_daily ......................... [[33mSKIP[0m]
[0m02:35:32.028928 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m02:35:32.029255 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m02:35:32.029698 [info ] [Thread-1 (]: 14 of 18 SKIP relation main_dws.dws_traffic_flow_daily ......................... [[33mSKIP[0m]
[0m02:35:32.030073 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m02:35:32.030409 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:35:32.030788 [info ] [Thread-1 (]: 15 of 18 SKIP relation main_metadata.meta_data_quality_metrics ................. [[33mSKIP[0m]
[0m02:35:32.031230 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:35:32.031587 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m02:35:32.031959 [info ] [Thread-1 (]: 16 of 18 SKIP relation main_ads.ads_toll_revenue_report ........................ [[33mSKIP[0m]
[0m02:35:32.032328 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m02:35:32.032657 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m02:35:32.033033 [info ] [Thread-1 (]: 17 of 18 SKIP relation main_ads.ads_traffic_trend_analysis ..................... [[33mSKIP[0m]
[0m02:35:32.033492 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m02:35:32.033835 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:35:32.034199 [info ] [Thread-1 (]: 18 of 18 SKIP relation main_metadata.meta_data_asset_catalog ................... [[33mSKIP[0m]
[0m02:35:32.034566 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:35:32.035978 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:32.036675 [debug] [MainThread]: On master: BEGIN
[0m02:35:32.037164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:32.038195 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:32.038702 [debug] [MainThread]: On master: COMMIT
[0m02:35:32.039185 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:32.039665 [debug] [MainThread]: On master: COMMIT
[0m02:35:32.040440 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:32.040926 [debug] [MainThread]: On master: Close
[0m02:35:32.041623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:32.042074 [debug] [MainThread]: Connection 'model.datacore.ods_toll_transaction' was properly closed.
[0m02:35:32.042711 [info ] [MainThread]: 
[0m02:35:32.043253 [info ] [MainThread]: Finished running 14 table models, 4 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m02:35:32.046705 [debug] [MainThread]: Command end result
[0m02:35:32.093541 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:32.095488 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:32.101190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:32.101504 [info ] [MainThread]: 
[0m02:35:32.101831 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:35:32.102120 [info ] [MainThread]: 
[0m02:35:32.102470 [error] [MainThread]: [31mFailure in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)[0m
[0m02:35:32.102801 [error] [MainThread]:   Runtime Error in model ods_toll_transaction (models/ods/ods_toll_transaction.sql)
  Conversion Error: Unimplemented type for cast (INTERVAL -> BIGINT)
  
  LINE 55: LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict"...
               ^
[0m02:35:32.103065 [info ] [MainThread]: 
[0m02:35:32.103382 [info ] [MainThread]:   compiled code at target/compiled/datacore/models/ods/ods_toll_transaction.sql
[0m02:35:32.103649 [info ] [MainThread]: 
[0m02:35:32.103943 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=9 NO-OP=0 TOTAL=18
[0m02:35:32.104798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4698493, "process_in_blocks": "0", "process_kernel_time": 0.234499, "process_mem_max_rss": "163540", "process_out_blocks": "3264", "process_user_time": 2.581488}
[0m02:35:32.105194 [debug] [MainThread]: Command `dbt run` failed at 02:35:32.105113 after 1.47 seconds
[0m02:35:32.105537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca291c78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca27ef3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca140aea80>]}
[0m02:35:32.105853 [debug] [MainThread]: Flushing usage events
[0m02:35:33.560171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:42.142134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c3644890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c5a6df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c38ead20>]}


============================== 02:35:42.146392 | 7f256e27-3177-431c-8c22-f1d85def646f ==============================
[0m02:35:42.146392 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:42.146868 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select staging.+', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/home/chun/Develop/datacore/logs', 'warn_error': 'None'}
[0m02:35:42.348058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c302a210>]}
[0m02:35:42.405981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c302b590>]}
[0m02:35:42.407515 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:42.488223 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:42.618893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:42.619635 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/stg_toll_transaction.sql
[0m02:35:43.039847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b0003530>]}
[0m02:35:43.209419 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:43.211191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:43.225855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b017fd10>]}
[0m02:35:43.226357 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:43.226699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f256e27-3177-431c-8c22-f1d85def646f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f670d6ea20>]}
[0m02:35:43.227388 [warn ] [MainThread]: The selection criterion 'staging.+' does not match any enabled nodes
[0m02:35:43.228593 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:35:43.229075 [debug] [MainThread]: Command end result
[0m02:35:43.259049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:43.260816 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:43.263682 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:43.264542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1734496, "process_in_blocks": "0", "process_kernel_time": 0.214818, "process_mem_max_rss": "145544", "process_out_blocks": "3896", "process_user_time": 2.224125}
[0m02:35:43.264950 [debug] [MainThread]: Command `dbt run` succeeded at 02:35:43.264864 after 1.17 seconds
[0m02:35:43.265291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6c3e7a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b0001490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6b019cef0>]}
[0m02:35:43.265633 [debug] [MainThread]: Flushing usage events
[0m02:35:44.398255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:35:48.838129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e66bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992f021160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e90f470>]}


============================== 02:35:48.842342 | 1287c672-0c8e-4c4b-a343-b8fa676f778c ==============================
[0m02:35:48.842342 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:35:48.842850 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'False'}
[0m02:35:49.060911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992de1c320>]}
[0m02:35:49.130406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e72e2a0>]}
[0m02:35:49.132095 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:35:49.215038 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:35:49.354320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:35:49.354730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:35:49.421679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991e2afb90>]}
[0m02:35:49.529667 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:49.531368 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:49.544350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991df61100>]}
[0m02:35:49.544814 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:35:49.545121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991dee5610>]}
[0m02:35:49.547223 [info ] [MainThread]: 
[0m02:35:49.547538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:49.547797 [info ] [MainThread]: 
[0m02:35:49.548220 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:49.554114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:35:49.597253 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.597676 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.597966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:49.615506 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:35:49.616993 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.619199 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.619546 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.619816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.620994 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.622082 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.623873 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.624199 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.624472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.625775 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.626818 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.628588 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.628908 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.629170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.630333 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.631380 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.633188 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.633527 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.633789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.635092 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.636141 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.637932 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:35:49.638219 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:35:49.638530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.639678 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.640726 [debug] [ThreadPool]: On list_datacore: Close
[0m02:35:49.641462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:35:49.641848 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:35:49.649198 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.649593 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.649873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.651219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.652543 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.652813 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:35:49.653273 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.653531 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.653778 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:35:49.654263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.654971 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:49.655236 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:35:49.655491 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:35:49.655938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.656202 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:35:49.656776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_ods)
[0m02:35:49.657176 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m02:35:49.658836 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.659111 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.659377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.660700 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.661796 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.662059 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m02:35:49.662507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.662756 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.663002 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m02:35:49.663502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.664193 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:49.664461 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:35:49.664705 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:35:49.665141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.665405 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m02:35:49.665921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_staging)
[0m02:35:49.666307 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:35:49.667850 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.668129 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.668406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.669418 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.670517 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.670784 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:35:49.671227 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.671490 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.671741 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:35:49.672188 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.672879 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:49.673140 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:35:49.673397 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:35:49.673794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.674055 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:35:49.674601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now create_datacore_main_dws)
[0m02:35:49.674999 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m02:35:49.676516 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.676789 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.677046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.678040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.679134 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.679405 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m02:35:49.679880 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.680129 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.680385 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m02:35:49.680877 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.681572 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:49.681833 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:35:49.682082 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:35:49.682506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.682766 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m02:35:49.683297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_dwd)
[0m02:35:49.683691 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m02:35:49.685218 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.685500 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.685770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.686750 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.687830 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.688092 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m02:35:49.688523 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.688773 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.689022 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m02:35:49.689473 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.690154 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:49.690420 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:35:49.690664 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:35:49.691058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.691320 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m02:35:49.691847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now create_datacore_main_ads)
[0m02:35:49.692234 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m02:35:49.693857 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.694136 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:35:49.694404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.695393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.696494 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.696758 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m02:35:49.697178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.697437 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.697687 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m02:35:49.698175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.698873 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:49.699133 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:35:49.699387 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:35:49.699782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:49.700042 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m02:35:49.703637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now list_datacore_main_metadata)
[0m02:35:49.715285 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:49.716009 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:35:49.716553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.717948 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.718497 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:35:49.719032 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.742958 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m02:35:49.744653 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:35:49.745732 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:35:49.746001 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:35:49.746646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ods)
[0m02:35:49.749587 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:49.749925 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:35:49.750199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.750896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.751168 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:35:49.751468 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.754890 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.756138 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:35:49.757041 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:35:49.757328 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:35:49.757884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:35:49.760004 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:49.760318 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:35:49.760588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.761178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.761464 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:35:49.761748 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.765657 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:35:49.766820 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:35:49.767637 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:35:49.767890 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:35:49.768415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:35:49.771065 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:49.771358 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:35:49.771606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.772202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.772459 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:35:49.772716 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.776186 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.777271 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:35:49.778077 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:35:49.778339 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:35:49.778851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dws)
[0m02:35:49.781785 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:49.782074 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:35:49.782332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.782936 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.783189 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:35:49.783455 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.787004 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.788057 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:35:49.788861 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:35:49.789116 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:35:49.789634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:35:49.851997 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:49.852426 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:35:49.852685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.853381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.853633 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:35:49.853891 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.857216 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.858335 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:35:49.859148 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:35:49.859416 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:35:49.860234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ads)
[0m02:35:49.861850 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:49.862120 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:35:49.862373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:49.862942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:35:49.863195 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:35:49.863464 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:35:49.866837 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:35:49.867905 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:35:49.868708 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:35:49.868963 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:35:49.869819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991dd394f0>]}
[0m02:35:49.870718 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:49.871245 [debug] [MainThread]: On master: BEGIN
[0m02:35:49.871754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:49.872915 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:35:49.873431 [debug] [MainThread]: On master: COMMIT
[0m02:35:49.873924 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:49.874420 [debug] [MainThread]: On master: COMMIT
[0m02:35:49.875207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:49.875727 [debug] [MainThread]: On master: Close
[0m02:35:49.879007 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:35:49.879940 [info ] [Thread-1 (]: 1 of 18 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m02:35:49.880700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now model.datacore.meta_data_lineage)
[0m02:35:49.881335 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:35:49.894756 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:35:49.895738 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:35:49.927002 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:35:49.927780 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.928137 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:35:49.928484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:49.929340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.929672 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.930080 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª



-- ‰ªérawÂà∞stagingÁöÑË°ÄÁºò
SELECT 
    'raw.toll_transaction' AS source_table,
    'staging.stg_toll_transaction' AS target_table,
    'Ê∏ÖÊ¥ó' AS transformation_type,
    'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT 
    'raw.toll_station',
    'staging.stg_toll_station',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.vehicle_type_dict',
    'staging.stg_vehicle_type_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
UNION ALL
SELECT 
    'raw.payment_method_dict',
    'staging.stg_payment_method_dict',
    'Ê∏ÖÊ¥ó',
    'Êï∞ÊçÆÊ∏ÖÊ¥ó'
-- ‰ªéstagingÂà∞odsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'staging.stg_toll_transaction',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®Âíå‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊî∂Ë¥πÁ´ô‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_vehicle_type_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîËΩ¶Âûã‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_payment_method_dict',
    'ods.ods_toll_transaction',
    'ÂÖ≥ËÅî',
    'ÂÖ≥ËÅîÊîØ‰ªòÊñπÂºè‰ø°ÊÅØ'
UNION ALL
SELECT 
    'staging.stg_toll_station',
    'ods.ods_toll_station',
    'ËΩ¨Êç¢',
    '‰∏öÂä°Â≠óÊÆµÊâ©Â±ï'
-- ‰ªéodsÂà∞dwdÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'ods.ods_toll_transaction',
    'dwd.dwd_toll_transaction_detail',
    'ËΩ¨Êç¢',
    '‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆËΩ¨Êç¢'
-- ‰ªédwdÂà∞dwsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_toll_revenue_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÊ±áÊÄª'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_traffic_flow_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÊ±áÊÄªËΩ¶ÊµÅÈáè'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'dws.dws_station_performance_daily',
    'Ê±áÊÄª',
    'ÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ôÊ±áÊÄªÁª©Êïà'
-- ‰ªédwsÂà∞adsÁöÑË°ÄÁºò
UNION ALL
SELECT 
    'dws.dws_toll_revenue_daily',
    'ads.ads_toll_revenue_report',
    'ËÅöÂêà',
    'ÁîüÊàêÊî∂ÂÖ•Êä•Ë°®'
UNION ALL
SELECT 
    'dws.dws_traffic_flow_daily',
    'ads.ads_traffic_trend_analysis',
    'ËÅöÂêà',
    'ÁîüÊàêËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê'
UNION ALL
SELECT 
    'dwd.dwd_toll_transaction_detail',
    'ads.ads_quality_monitoring_dashboard',
    'ËÅöÂêà',
    'ÁîüÊàêË¥®ÈáèÁõëÊéßÁúãÊùø'
    );
  
  
[0m02:35:49.932907 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:49.938833 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.939284 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:35:49.940551 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.941882 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.942251 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:35:49.943439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.949822 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.950233 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:35:49.951182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.953834 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.954196 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:35:49.954936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:49.970127 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:49.970578 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.970921 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:35:49.972703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.978131 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:35:49.978545 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:35:49.979981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.982333 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:35:49.984176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2db4d0>]}
[0m02:35:49.984793 [info ] [Thread-1 (]: 1 of 18 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.10s]
[0m02:35:49.985372 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:35:49.985763 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:35:49.986268 [info ] [Thread-1 (]: 2 of 18 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m02:35:49.986682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m02:35:49.987030 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:35:49.990025 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:35:49.990603 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:35:49.994758 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:35:49.995409 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:49.995759 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:35:49.996097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:49.996896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:49.997232 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:49.997647 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ



SELECT 
    'staging' AS schema_name,
    'stg_toll_transaction' AS table_name,
    'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description,
    'Êî∂Ë¥π‰∏öÂä°' AS business_domain,
    'Êî∂Ë¥πÁ≥ªÁªü' AS data_source,
    'ÂÆûÊó∂' AS update_frequency,
    'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner,
    'staging' AS data_layer,
    CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 
    'staging',
    'stg_toll_station',
    'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'staging',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_transaction',
    'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ods',
    'ods_toll_station',
    'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®',
    'Ë∑ØÁΩëÁÆ°ÁêÜ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü',
    'ÊåâÈúÄ',
    'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®',
    'ods',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dwd',
    'dwd_toll_transaction_detail',
    'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'ÂÆûÊó∂',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dwd',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_toll_revenue_daily',
    'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_traffic_flow_daily',
    'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'dws',
    'dws_station_performance_daily',
    'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'dws',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_toll_revenue_report',
    'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_traffic_trend_analysis',
    'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê',
    'Êî∂Ë¥π‰∏öÂä°',
    'Êî∂Ë¥πÁ≥ªÁªü',
    'Êó•',
    'Êî∂Ë¥π‰∏≠ÂøÉ',
    'ads',
    CURRENT_TIMESTAMP
UNION ALL
SELECT 
    'ads',
    'ads_quality_monitoring_dashboard',
    'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø',
    'Êï∞ÊçÆÁÆ°ÁêÜ',
    'Êï∞ÊçÆ‰∏≠Âè∞',
    'ÂÆûÊó∂',
    'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®',
    'ads',
    CURRENT_TIMESTAMP
    );
  
  
[0m02:35:50.001187 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:50.002472 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.002832 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:35:50.003789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.004965 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.005329 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:35:50.006236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.009105 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.009480 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:35:50.010155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.012640 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.013001 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:35:50.013646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.014894 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:50.015248 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.015593 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:35:50.017017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.019067 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:35:50.019442 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:35:50.020832 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.022076 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:35:50.022759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2bddc0>]}
[0m02:35:50.023351 [info ] [Thread-1 (]: 2 of 18 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.04s]
[0m02:35:50.023902 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:35:50.024284 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:35:50.024803 [info ] [Thread-1 (]: 3 of 18 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m02:35:50.025226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.stg_payment_method_dict)
[0m02:35:50.025585 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:35:50.028717 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:35:50.029331 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:35:50.046287 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:35:50.046988 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.047321 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:35:50.047624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.048430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.048736 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.049056 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:35:50.049927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.052475 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.052820 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m02:35:50.053490 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.055795 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.056127 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:35:50.056753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.057817 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:50.058154 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.058485 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:35:50.059720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.061541 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:35:50.061869 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:35:50.063059 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.064173 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:35:50.064710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992fabf350>]}
[0m02:35:50.065230 [info ] [Thread-1 (]: 3 of 18 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m02:35:50.065737 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:35:50.066084 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:35:50.066544 [info ] [Thread-1 (]: 4 of 18 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m02:35:50.066901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:35:50.067219 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:35:50.069984 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:35:50.070548 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:35:50.074452 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:35:50.075031 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.075358 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:35:50.075661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.076501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.076808 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.077123 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:35:50.077992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.080465 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.080814 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m02:35:50.081475 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.083729 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.084060 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:35:50.084674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.085833 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:50.086165 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.086558 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:35:50.087820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.089649 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:35:50.089975 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:35:50.091199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.092338 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:35:50.093078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bded7f80>]}
[0m02:35:50.093618 [info ] [Thread-1 (]: 4 of 18 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.03s]
[0m02:35:50.094122 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:35:50.094479 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:35:50.094942 [info ] [Thread-1 (]: 5 of 18 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m02:35:50.095439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:35:50.095764 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:35:50.098975 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:35:50.099554 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:35:50.101910 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:35:50.102430 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.102752 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:35:50.103061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.103799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.104222 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.104632 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST(EXTRACT(EPOCH FROM (exit_time - entry_time)) AS INTEGER) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:35:50.106550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.109124 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.109476 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m02:35:50.110224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.112502 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.112842 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:35:50.113496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.114582 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:50.114916 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.115226 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:35:50.116924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.119048 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:35:50.119424 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:35:50.120946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.122206 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:35:50.122825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bdeacd40>]}
[0m02:35:50.123409 [info ] [Thread-1 (]: 5 of 18 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m02:35:50.123963 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:35:50.124357 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:35:50.124847 [info ] [Thread-1 (]: 6 of 18 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m02:35:50.125235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:35:50.125591 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:35:50.128587 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.129174 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:35:50.133595 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.134227 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.134587 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:35:50.134916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.135699 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.136033 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.136389 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:35:50.137251 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.139948 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.140316 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m02:35:50.140975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.143438 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.143793 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:35:50.144419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.145585 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:50.145936 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.146272 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:35:50.148223 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:50.150221 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:35:50.150601 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:35:50.151829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.153044 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:35:50.153635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991c14ac90>]}
[0m02:35:50.154199 [info ] [Thread-1 (]: 6 of 18 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m02:35:50.154760 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:35:50.155134 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m02:35:50.155643 [info ] [Thread-1 (]: 7 of 18 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m02:35:50.156165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m02:35:50.156522 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m02:35:50.159527 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m02:35:50.160163 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m02:35:50.162711 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m02:35:50.163243 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.163587 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m02:35:50.163909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.164685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.165011 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.165373 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m02:35:50.167609 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:50.168898 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.169251 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:35:50.170206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.171401 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.171750 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:35:50.172729 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.175600 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.175966 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station" rename to "ods_toll_station__dbt_backup"
[0m02:35:50.176636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.179072 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.179429 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m02:35:50.180030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.181235 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:50.181590 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.181919 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:35:50.183337 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.185331 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:35:50.185680 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m02:35:50.187022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.188285 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m02:35:50.188955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2cd400>]}
[0m02:35:50.189523 [info ] [Thread-1 (]: 7 of 18 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.03s]
[0m02:35:50.190061 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m02:35:50.190503 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:35:50.190973 [info ] [Thread-1 (]: 8 of 18 START sql table model main_metadata.meta_data_dictionary ............... [RUN]
[0m02:35:50.191359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m02:35:50.191698 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:35:50.195186 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:35:50.195784 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:35:50.198343 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:35:50.198880 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.199226 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:35:50.199569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.200355 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.200690 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.201094 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:35:50.206162 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m02:35:50.207243 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.207607 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:35:50.208522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.212489 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.213122 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:35:50.214532 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.217549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.217935 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:35:50.218625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.221084 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.221457 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:35:50.222094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.223338 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:50.223697 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.224034 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:35:50.225432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.227443 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:35:50.227803 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:35:50.229113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.230339 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:35:50.231155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bde9c4d0>]}
[0m02:35:50.231727 [info ] [Thread-1 (]: 8 of 18 OK created sql table model main_metadata.meta_data_dictionary .......... [[32mOK[0m in 0.04s]
[0m02:35:50.232269 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:35:50.232650 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m02:35:50.233116 [info ] [Thread-1 (]: 9 of 18 START sql table model main_ods.ods_toll_transaction .................... [RUN]
[0m02:35:50.233512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m02:35:50.233852 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m02:35:50.237925 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m02:35:50.238516 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m02:35:50.241031 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m02:35:50.241574 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.241921 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m02:35:50.242247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.242998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.243339 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.243727 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:35:50.472119 [debug] [Thread-1 (]: SQL status: OK in 0.228 seconds
[0m02:35:50.475160 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.475542 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction__dbt_tmp" rename to "ods_toll_transaction"
[0m02:35:50.476392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.477543 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:35:50.477890 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.478217 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:35:50.727573 [debug] [Thread-1 (]: SQL status: OK in 0.249 seconds
[0m02:35:50.729740 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:35:50.730074 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

      drop table if exists "datacore"."main_ods"."ods_toll_transaction__dbt_backup" cascade
    
[0m02:35:50.730711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:50.731872 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m02:35:50.741217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991e263b30>]}
[0m02:35:50.741838 [info ] [Thread-1 (]: 9 of 18 OK created sql table model main_ods.ods_toll_transaction ............... [[32mOK[0m in 0.51s]
[0m02:35:50.742356 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m02:35:50.743444 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m02:35:50.743852 [info ] [Thread-1 (]: 10 of 18 START sql table model main_dwd.dwd_toll_transaction_detail ............ [RUN]
[0m02:35:50.744240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_transaction, now model.datacore.dwd_toll_transaction_detail)
[0m02:35:50.744578 [debug] [Thread-1 (]: Began compiling node model.datacore.dwd_toll_transaction_detail
[0m02:35:50.747545 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.748137 [debug] [Thread-1 (]: Began executing node model.datacore.dwd_toll_transaction_detail
[0m02:35:50.750528 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.751055 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.751376 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: BEGIN
[0m02:35:50.751692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:50.752399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:50.752710 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:50.753060 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

  
    
    

    create  table
      "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp"
  
    as (
      -- DWDÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ
-- ÂäüËÉΩÔºö‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÔºå‰æø‰∫éÂêéÁª≠ÂàÜÊûê



SELECT 
    transaction_id,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    vehicle_type_name,
    vehicle_type_desc,
    entry_station_id,
    entry_station_name,
    entry_time,
    exit_time,
    travel_minutes,
    -- ËÆ°ÁÆóÈÄöË°åË∑ùÁ¶ªÔºà‰º∞ÁÆóÔºåÂü∫‰∫éÊó∂Èó¥Ôºâ
    CASE 
        WHEN travel_minutes > 0 THEN 
            ROUND(travel_minutes * 60 / 100.0, 2)  -- ÂÅáËÆæÂπ≥ÂùáÈÄüÂ∫¶100km/h
        ELSE 0
    END AS estimated_distance_km,
    payment_method_code,
    payment_method_name,
    payment_method_desc,
    toll_amount,
    actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    transaction_date,
    transaction_hour,
    day_of_week,
    is_normal_transaction,
    -- ‰∏öÂä°ÂàÜÁ±ª
    CASE 
        WHEN transaction_hour BETWEEN 6 AND 9 THEN 'Êó©È´òÂ≥∞'
        WHEN transaction_hour BETWEEN 17 AND 20 THEN 'ÊôöÈ´òÂ≥∞'
        WHEN transaction_hour BETWEEN 22 AND 6 THEN 'Â§úÈó¥'
        ELSE 'Âπ≥Â≥∞'
    END AS time_period,
    CASE 
        WHEN day_of_week IN (0, 6) THEN 'Âë®Êú´'  -- DOW: 0=Âë®Êó•, 6=Âë®ÂÖ≠
        ELSE 'Â∑•‰ΩúÊó•'
    END AS day_type,
    create_time,
    update_time,
    etl_time
FROM "datacore"."main_ods"."ods_toll_transaction"
    );
  
  
[0m02:35:51.003953 [debug] [Thread-1 (]: SQL status: OK in 0.250 seconds
[0m02:35:51.007807 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:51.008179 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp" rename to "dwd_toll_transaction_detail"
[0m02:35:51.009031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.010155 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:35:51.010499 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:51.010808 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:35:51.268900 [debug] [Thread-1 (]: SQL status: OK in 0.258 seconds
[0m02:35:51.272886 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:35:51.273254 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

      drop table if exists "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_backup" cascade
    
[0m02:35:51.273973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.275215 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: Close
[0m02:35:51.284911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2c8440>]}
[0m02:35:51.285575 [info ] [Thread-1 (]: 10 of 18 OK created sql table model main_dwd.dwd_toll_transaction_detail ....... [[32mOK[0m in 0.54s]
[0m02:35:51.286104 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m02:35:51.287590 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.288272 [info ] [Thread-1 (]: 11 of 18 START sql table model main_ads.ads_quality_monitoring_dashboard ....... [RUN]
[0m02:35:51.288814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dwd_toll_transaction_detail, now model.datacore.ads_quality_monitoring_dashboard)
[0m02:35:51.289175 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.292484 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.293121 [debug] [Thread-1 (]: Began executing node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.295509 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.296034 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.296359 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: BEGIN
[0m02:35:51.296669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.297405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.297712 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.298093 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø
-- ÂäüËÉΩÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶



SELECT 
    transaction_date,
    -- ÊÄª‰ΩìË¥®ÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transactions,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal,
    -- Ë¥®ÈáèÁéá
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÂºÇÂ∏∏Á±ªÂûãÂàÜÂ∏É
    SUM(CASE WHEN transaction_status = 'ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS status_abnormal_count,
    SUM(CASE WHEN transaction_status = 'ÈÄÉË¥π' THEN 1 ELSE 0 END) AS status_evasion_count,
    SUM(CASE WHEN transaction_status = 'ËÆæÂ§áÊïÖÈöú' THEN 1 ELSE 0 END) AS status_equipment_failure_count,
    SUM(CASE WHEN transaction_status = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS status_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êî∂Ë¥πÁ´ôÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_station_missing_count,
    SUM(CASE WHEN data_quality_flag = 'ËΩ¶ÁâåÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_plate_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êó∂Èó¥ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_time_abnormal_count,
    SUM(CASE WHEN data_quality_flag = 'ÈáëÈ¢ùÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_amount_abnormal_count,
    -- ÂëäË≠¶Ê†áËÆ∞
    CASE 
        WHEN SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 90 THEN 'ÂëäË≠¶'
        WHEN SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 95 THEN 'ÂëäË≠¶'
        ELSE 'Ê≠£Â∏∏'
    END AS alert_status,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:35:51.307621 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:35:51.310140 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.310491 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp" rename to "ads_quality_monitoring_dashboard"
[0m02:35:51.311176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.312232 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:35:51.312563 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.312866 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:35:51.314479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.316592 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:35:51.316926 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

      drop table if exists "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_backup" cascade
    
[0m02:35:51.317493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.318587 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: Close
[0m02:35:51.319224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be2ce9f0>]}
[0m02:35:51.319742 [info ] [Thread-1 (]: 11 of 18 OK created sql table model main_ads.ads_quality_monitoring_dashboard .. [[32mOK[0m in 0.03s]
[0m02:35:51.320254 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m02:35:51.320611 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m02:35:51.321050 [info ] [Thread-1 (]: 12 of 18 START sql table model main_dws.dws_station_performance_daily .......... [RUN]
[0m02:35:51.321413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_quality_monitoring_dashboard, now model.datacore.dws_station_performance_daily)
[0m02:35:51.321726 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_station_performance_daily
[0m02:35:51.324558 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_station_performance_daily"
[0m02:35:51.325103 [debug] [Thread-1 (]: Began executing node model.datacore.dws_station_performance_daily
[0m02:35:51.327316 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_station_performance_daily"
[0m02:35:51.327814 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.328129 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: BEGIN
[0m02:35:51.328433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.329153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.329469 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.329818 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª
-- ÂäüËÉΩÔºöÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    -- ‰∫§ÊòìÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    COUNT(DISTINCT lane_id) AS active_lanes,
    -- Êî∂ÂÖ•ÊåáÊ†á
    SUM(actual_amount) AS total_revenue,
    AVG(actual_amount) AS avg_revenue_per_transaction,
    -- ÊïàÁéáÊåáÊ†á
    AVG(travel_minutes) AS avg_processing_time_minutes,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS etc_rate,
    -- È´òÂ≥∞Êó∂ÊÆµÂç†ÊØî
    SUM(CASE WHEN time_period IN ('Êó©È´òÂ≥∞', 'ÊôöÈ´òÂ≥∞') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS peak_hour_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type
    );
  
  
[0m02:35:51.390777 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m02:35:51.393901 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.394292 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp" rename to "dws_station_performance_daily"
[0m02:35:51.395110 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.396299 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:35:51.396677 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.397023 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:35:51.399982 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:51.402145 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:35:51.402522 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

      drop table if exists "datacore"."main_dws"."dws_station_performance_daily__dbt_backup" cascade
    
[0m02:35:51.403154 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.404387 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: Close
[0m02:35:51.413097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991df624b0>]}
[0m02:35:51.413767 [info ] [Thread-1 (]: 12 of 18 OK created sql table model main_dws.dws_station_performance_daily ..... [[32mOK[0m in 0.09s]
[0m02:35:51.414289 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m02:35:51.414658 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m02:35:51.415108 [info ] [Thread-1 (]: 13 of 18 START sql table model main_dws.dws_toll_revenue_daily ................. [RUN]
[0m02:35:51.415484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_station_performance_daily, now model.datacore.dws_toll_revenue_daily)
[0m02:35:51.415807 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_toll_revenue_daily
[0m02:35:51.418865 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.419397 [debug] [Thread-1 (]: Began executing node model.datacore.dws_toll_revenue_daily
[0m02:35:51.423473 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.424040 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.424376 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: BEGIN
[0m02:35:51.424687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.425432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.425749 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.426130 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name,
    -- Ê±áÊÄªÊåáÊ†á
    COUNT(*) AS transaction_count,
    COUNT(DISTINCT vehicle_plate) AS vehicle_count,
    SUM(toll_amount) AS total_toll_amount,
    SUM(actual_amount) AS total_actual_amount,
    SUM(discount_amount) AS total_discount_amount,
    AVG(actual_amount) AS avg_transaction_amount,
    MAX(actual_amount) AS max_transaction_amount,
    MIN(actual_amount) AS min_transaction_amount,
    -- Ê≠£Â∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transaction_count,
    SUM(CASE WHEN is_normal_transaction = 1 THEN actual_amount ELSE 0 END) AS normal_transaction_amount,
    -- ÂºÇÂ∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transaction_count,
    -- Êï∞ÊçÆË¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal_count,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name
    );
  
  
[0m02:35:51.509362 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m02:35:51.512092 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.512447 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp" rename to "dws_toll_revenue_daily"
[0m02:35:51.513192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.514277 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:35:51.514620 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.514931 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:35:51.526481 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:35:51.528671 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:35:51.529014 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

      drop table if exists "datacore"."main_dws"."dws_toll_revenue_daily__dbt_backup" cascade
    
[0m02:35:51.529669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.530809 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: Close
[0m02:35:51.545801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bdef7770>]}
[0m02:35:51.546551 [info ] [Thread-1 (]: 13 of 18 OK created sql table model main_dws.dws_toll_revenue_daily ............ [[32mOK[0m in 0.13s]
[0m02:35:51.547104 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m02:35:51.547499 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m02:35:51.548177 [info ] [Thread-1 (]: 14 of 18 START sql table model main_dws.dws_traffic_flow_daily ................. [RUN]
[0m02:35:51.548640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_toll_revenue_daily, now model.datacore.dws_traffic_flow_daily)
[0m02:35:51.548988 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_traffic_flow_daily
[0m02:35:51.552363 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.552961 [debug] [Thread-1 (]: Began executing node model.datacore.dws_traffic_flow_daily
[0m02:35:51.555744 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.556298 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.556662 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: BEGIN
[0m02:35:51.556998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.557853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.558196 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.558591 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•ËΩ¶ÊµÅÈáèÊ±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type,
    -- ËΩ¶ÊµÅÈáèÊåáÊ†á
    COUNT(*) AS total_vehicles,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' THEN 1 ELSE 0 END) AS passenger_vehicle_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code != 'V01' THEN 1 ELSE 0 END) AS bus_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code >= 'V05' THEN 1 ELSE 0 END) AS truck_count,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(travel_minutes) AS avg_travel_minutes,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) AS etc_count,
    SUM(CASE WHEN payment_method_code != 'P01' THEN 1 ELSE 0 END) AS non_etc_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type
    );
  
  
[0m02:35:51.618297 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m02:35:51.621552 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.622005 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp" rename to "dws_traffic_flow_daily"
[0m02:35:51.623164 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.624722 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:35:51.625125 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.625491 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:35:51.629273 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:35:51.631511 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:35:51.631878 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

      drop table if exists "datacore"."main_dws"."dws_traffic_flow_daily__dbt_backup" cascade
    
[0m02:35:51.632562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.633819 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: Close
[0m02:35:51.645633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991ddcef00>]}
[0m02:35:51.646394 [info ] [Thread-1 (]: 14 of 18 OK created sql table model main_dws.dws_traffic_flow_daily ............ [[32mOK[0m in 0.10s]
[0m02:35:51.646957 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m02:35:51.647365 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:35:51.648060 [info ] [Thread-1 (]: 15 of 18 START sql table model main_metadata.meta_data_quality_metrics ......... [RUN]
[0m02:35:51.648482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_traffic_flow_daily, now model.datacore.meta_data_quality_metrics)
[0m02:35:51.648830 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:35:51.652239 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:35:51.652815 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:35:51.655487 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:35:51.656026 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.656389 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:35:51.656725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.657520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.657860 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.658281 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:35:51.669721 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:35:51.672668 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.673048 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:35:51.673807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.674988 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:35:51.675350 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.675679 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:35:51.677201 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.679257 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:35:51.679627 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:35:51.680223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.681442 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:35:51.682176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198be38f5c0>]}
[0m02:35:51.682746 [info ] [Thread-1 (]: 15 of 18 OK created sql table model main_metadata.meta_data_quality_metrics .... [[32mOK[0m in 0.03s]
[0m02:35:51.683293 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:35:51.683693 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m02:35:51.684191 [info ] [Thread-1 (]: 16 of 18 START sql table model main_ads.ads_toll_revenue_report ................ [RUN]
[0m02:35:51.684597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.ads_toll_revenue_report)
[0m02:35:51.684948 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_toll_revenue_report
[0m02:35:51.689918 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_toll_revenue_report"
[0m02:35:51.690524 [debug] [Thread-1 (]: Began executing node model.datacore.ads_toll_revenue_report
[0m02:35:51.693174 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_toll_revenue_report"
[0m02:35:51.693708 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.694064 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: BEGIN
[0m02:35:51.694413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.695214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.695570 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.695958 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®
-- ÂäüËÉΩÔºöÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®



SELECT 
    transaction_date,
    city,
    highway_code,
    -- ÊÄª‰ΩìÊåáÊ†á
    SUM(total_actual_amount) AS daily_revenue,
    SUM(transaction_count) AS daily_transactions,
    SUM(vehicle_count) AS daily_vehicles,
    AVG(avg_transaction_amount) AS avg_transaction_amount,
    -- ÊåâÊîØ‰ªòÊñπÂºè
    SUM(CASE WHEN payment_method_code = 'P01' THEN total_actual_amount ELSE 0 END) AS etc_revenue,
    SUM(CASE WHEN payment_method_code != 'P01' THEN total_actual_amount ELSE 0 END) AS non_etc_revenue,
    -- ÊåâËΩ¶Âûã
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code < 'V05' THEN total_actual_amount ELSE 0 END) AS passenger_revenue,
    SUM(CASE WHEN vehicle_type_code >= 'V05' THEN total_actual_amount ELSE 0 END) AS truck_revenue,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(normal_transaction_count) * 100.0 / SUM(transaction_count) AS normal_rate,
    SUM(quality_normal_count) * 100.0 / SUM(transaction_count) AS data_quality_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_toll_revenue_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code
    );
  
  
[0m02:35:51.705567 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:35:51.708253 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.708605 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp" rename to "ads_toll_revenue_report"
[0m02:35:51.709359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.710470 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:35:51.710804 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.711115 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:35:51.713485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:51.715427 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:35:51.715768 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

      drop table if exists "datacore"."main_ads"."ads_toll_revenue_report__dbt_backup" cascade
    
[0m02:35:51.716371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.717506 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: Close
[0m02:35:51.720516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991c149e20>]}
[0m02:35:51.721046 [info ] [Thread-1 (]: 16 of 18 OK created sql table model main_ads.ads_toll_revenue_report ........... [[32mOK[0m in 0.04s]
[0m02:35:51.721554 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m02:35:51.721906 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.722554 [info ] [Thread-1 (]: 17 of 18 START sql table model main_ads.ads_traffic_trend_analysis ............. [RUN]
[0m02:35:51.722944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_toll_revenue_report, now model.datacore.ads_traffic_trend_analysis)
[0m02:35:51.723257 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.726130 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.726646 [debug] [Thread-1 (]: Began executing node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.728967 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.729438 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.729759 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: BEGIN
[0m02:35:51.730067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.730796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.731111 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.731470 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê
-- ÂäüËÉΩÔºöËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê



SELECT 
    transaction_date,
    city,
    highway_code,
    day_type,
    -- ËΩ¶ÊµÅÈáèË∂ãÂäø
    SUM(total_vehicles) AS daily_vehicles,
    SUM(unique_vehicles) AS daily_unique_vehicles,
    -- Êó∂ÊÆµÂàÜÂ∏É
    SUM(CASE WHEN time_period = 'Êó©È´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS morning_peak_vehicles,
    SUM(CASE WHEN time_period = 'ÊôöÈ´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS evening_peak_vehicles,
    SUM(CASE WHEN time_period = 'Âπ≥Â≥∞' THEN total_vehicles ELSE 0 END) AS normal_vehicles,
    SUM(CASE WHEN time_period = 'Â§úÈó¥' THEN total_vehicles ELSE 0 END) AS night_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(passenger_vehicle_count) AS passenger_vehicles,
    SUM(bus_count) AS bus_vehicles,
    SUM(truck_count) AS truck_vehicles,
    -- ETC‰ΩøÁî®Áéá
    SUM(etc_count) * 100.0 / SUM(total_vehicles) AS etc_usage_rate,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(avg_travel_minutes) AS avg_travel_minutes,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_traffic_flow_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code,
    day_type
    );
  
  
[0m02:35:51.738912 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:35:51.741614 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.741953 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp" rename to "ads_traffic_trend_analysis"
[0m02:35:51.742710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.743881 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:35:51.744221 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.744540 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:35:51.747034 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:35:51.748966 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:35:51.749320 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

      drop table if exists "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_backup" cascade
    
[0m02:35:51.749945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.751106 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: Close
[0m02:35:51.755347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71991e260950>]}
[0m02:35:51.755980 [info ] [Thread-1 (]: 17 of 18 OK created sql table model main_ads.ads_traffic_trend_analysis ........ [[32mOK[0m in 0.03s]
[0m02:35:51.756513 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m02:35:51.756867 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:35:51.757261 [info ] [Thread-1 (]: 18 of 18 START sql table model main_metadata.meta_data_asset_catalog ........... [RUN]
[0m02:35:51.757710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_traffic_trend_analysis, now model.datacore.meta_data_asset_catalog)
[0m02:35:51.758027 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:35:51.761873 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:35:51.762396 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:35:51.764718 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:35:51.765187 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.765511 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:35:51.765813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:35:51.766535 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.766848 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.767215 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:35:51.775907 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:35:51.780211 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.780610 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:35:51.781389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.782523 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:35:51.782864 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.783178 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:35:51.784798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:35:51.786673 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:35:51.787007 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:35:51.787582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:35:51.788696 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:35:51.791330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1287c672-0c8e-4c4b-a343-b8fa676f778c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7198bdf02d50>]}
[0m02:35:51.791858 [info ] [Thread-1 (]: 18 of 18 OK created sql table model main_metadata.meta_data_asset_catalog ...... [[32mOK[0m in 0.03s]
[0m02:35:51.792364 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:35:51.794882 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.795726 [debug] [MainThread]: On master: BEGIN
[0m02:35:51.796274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:51.798203 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:35:51.798777 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.799330 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.799860 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.800719 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:51.801279 [debug] [MainThread]: On master: Close
[0m02:35:51.802159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:51.802695 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:35:51.803557 [info ] [MainThread]: 
[0m02:35:51.804280 [info ] [MainThread]: Finished running 14 table models, 4 view models in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m02:35:51.810522 [debug] [MainThread]: Command end result
[0m02:35:51.856193 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:35:51.858778 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:35:51.866372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:35:51.866750 [info ] [MainThread]: 
[0m02:35:51.867158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:35:51.867473 [info ] [MainThread]: 
[0m02:35:51.867840 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m02:35:51.869201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0879946, "process_in_blocks": "0", "process_kernel_time": 0.920201, "process_mem_max_rss": "302064", "process_out_blocks": "30016", "process_user_time": 4.66102}
[0m02:35:51.869763 [debug] [MainThread]: Command `dbt run` succeeded at 02:35:51.869662 after 3.09 seconds
[0m02:35:51.870166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992de669c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71992e90f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719929b5fe30>]}
[0m02:35:51.870538 [debug] [MainThread]: Flushing usage events
[0m02:35:53.331150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:36:01.131170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033a4d6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033beda300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033a4d5430>]}


============================== 02:36:01.135204 | 196bf73e-9045-4d2a-a5ad-8bf79e67208a ==============================
[0m02:36:01.135204 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:36:01.135704 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt test', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:36:01.356361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033bccae70>]}
[0m02:36:01.419334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0329958260>]}
[0m02:36:01.421014 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:36:01.502872 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:36:01.641007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:36:01.641459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:36:01.707602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03297122a0>]}
[0m02:36:01.821487 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:36:01.823419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:36:01.846900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0328188f50>]}
[0m02:36:01.847470 [info ] [MainThread]: Found 18 models, 1 seed, 15 data tests, 4 sources, 463 macros
[0m02:36:01.847805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0329933f80>]}
[0m02:36:01.850387 [info ] [MainThread]: 
[0m02:36:01.850781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:36:01.851079 [info ] [MainThread]: 
[0m02:36:01.851597 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:36:01.857778 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore_main'
[0m02:36:01.897743 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:36:01.898126 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:36:01.898391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:01.916737 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:36:01.917168 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:36:01.917461 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.929688 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:36:01.930865 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:36:01.931852 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:36:01.932116 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:36:01.932670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_staging)
[0m02:36:01.934395 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:36:01.934663 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:36:01.934907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.935589 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.935839 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:36:01.936092 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.940431 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:36:01.941780 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:36:01.942613 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:36:01.942873 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:36:01.943442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_ods)
[0m02:36:01.946900 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:36:01.947235 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:36:01.947500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.948157 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.948422 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:36:01.948681 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.954128 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:36:01.955297 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:36:01.956101 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:36:01.956371 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:36:01.956920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_metadata)
[0m02:36:01.958912 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:36:01.959197 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:36:01.959454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.960012 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.960263 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:36:01.960531 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.963990 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:36:01.965185 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:36:01.965969 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:36:01.966225 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:36:01.966753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:36:01.969568 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:36:01.969861 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:36:01.970111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.970674 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.970926 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:36:01.971180 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.976206 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:36:01.977332 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:36:01.978106 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:36:01.978363 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:36:01.978875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_dws)
[0m02:36:01.980857 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:36:01.981139 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:36:01.981392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.981942 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.982189 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:36:01.982454 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.987504 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:36:01.988648 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:36:01.989410 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:36:01.989661 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:36:01.990190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_ads)
[0m02:36:01.992628 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:36:01.992906 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:36:01.993148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:01.993694 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:36:01.993940 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:36:01.994190 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:36:01.997582 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:36:01.998714 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:36:01.999487 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:36:01.999735 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:36:02.001348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196bf73e-9045-4d2a-a5ad-8bf79e67208a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e03281582f0>]}
[0m02:36:02.002198 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.002763 [debug] [MainThread]: On master: BEGIN
[0m02:36:02.003243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:02.004268 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:36:02.004778 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.005268 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.005759 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.006526 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:02.007021 [debug] [MainThread]: On master: Close
[0m02:36:02.010743 [debug] [Thread-1 (]: Began running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.011161 [info ] [Thread-1 (]: 1 of 15 START test not_null_dwd_toll_transaction_detail_transaction_id ......... [RUN]
[0m02:36:02.011595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90)
[0m02:36:02.011910 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.026425 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.027060 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.042791 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.043411 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.043725 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: BEGIN
[0m02:36:02.044016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.044792 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.045094 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:36:02.045400 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.046517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.050076 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: ROLLBACK
[0m02:36:02.050921 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90'
[0m02:36:02.051228 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: Close
[0m02:36:02.052061 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dwd_toll_transaction_detail_transaction_id ............... [[32mPASS[0m in 0.04s]
[0m02:36:02.052575 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:36:02.052918 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.053321 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_payment_method_dict_payment_method_code ........ [RUN]
[0m02:36:02.053679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90, now test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c)
[0m02:36:02.053981 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.057281 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.057846 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.059571 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.060074 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.060386 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: BEGIN
[0m02:36:02.060675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.061397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.061688 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:36:02.061986 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_method_code
from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.063117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.064426 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: ROLLBACK
[0m02:36:02.065266 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c'
[0m02:36:02.065580 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: Close
[0m02:36:02.066162 [info ] [Thread-1 (]: 2 of 15 PASS not_null_stg_payment_method_dict_payment_method_code .............. [[32mPASS[0m in 0.01s]
[0m02:36:02.066652 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:36:02.066989 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.067379 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_toll_station_station_id ........................ [RUN]
[0m02:36:02.067729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c, now test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2)
[0m02:36:02.068027 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.072914 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.073494 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.133328 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.133999 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.134328 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: BEGIN
[0m02:36:02.134630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.135400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.135701 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:36:02.136006 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_station"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.137290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.138617 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: ROLLBACK
[0m02:36:02.139450 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2'
[0m02:36:02.139753 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: Close
[0m02:36:02.140332 [info ] [Thread-1 (]: 3 of 15 PASS not_null_stg_toll_station_station_id .............................. [[32mPASS[0m in 0.07s]
[0m02:36:02.140824 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:36:02.141160 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.141535 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_toll_transaction_station_id .................... [RUN]
[0m02:36:02.141894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2, now test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde)
[0m02:36:02.142196 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.145414 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.145891 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.147603 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.148047 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.148361 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: BEGIN
[0m02:36:02.148647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.149367 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.149660 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:36:02.149960 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_transaction"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.152925 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.154232 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: ROLLBACK
[0m02:36:02.155054 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde'
[0m02:36:02.155359 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: Close
[0m02:36:02.156219 [info ] [Thread-1 (]: 4 of 15 PASS not_null_stg_toll_transaction_station_id .......................... [[32mPASS[0m in 0.01s]
[0m02:36:02.156710 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:36:02.157042 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.157413 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_toll_transaction_transaction_id ................ [RUN]
[0m02:36:02.157758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde, now test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b)
[0m02:36:02.158054 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.161339 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.161832 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.163534 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.163992 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.164294 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: BEGIN
[0m02:36:02.164589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.165330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.165638 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:36:02.165938 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.168845 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.170296 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: ROLLBACK
[0m02:36:02.171139 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b'
[0m02:36:02.171446 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: Close
[0m02:36:02.172035 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_toll_transaction_transaction_id ...................... [[32mPASS[0m in 0.01s]
[0m02:36:02.172528 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:36:02.172865 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.173226 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_vehicle_type_dict_vehicle_type_code ............ [RUN]
[0m02:36:02.173584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b, now test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728)
[0m02:36:02.173884 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.177132 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.177633 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.179331 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.179786 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.180091 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: BEGIN
[0m02:36:02.180387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.181102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.181405 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:36:02.181707 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vehicle_type_code
from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is null



  
  
      
    ) dbt_internal_test
[0m02:36:02.182853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.184121 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: ROLLBACK
[0m02:36:02.184935 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728'
[0m02:36:02.185250 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: Close
[0m02:36:02.185811 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_vehicle_type_dict_vehicle_type_code .................. [[32mPASS[0m in 0.01s]
[0m02:36:02.186299 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:36:02.186650 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.187011 [info ] [Thread-1 (]: 7 of 15 START test test_toll_transaction_accuracy .............................. [RUN]
[0m02:36:02.187363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728, now test.datacore.test_toll_transaction_accuracy)
[0m02:36:02.187659 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.189997 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.190556 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.192231 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.192751 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.193062 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: BEGIN
[0m02:36:02.193363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.194073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.194380 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:36:02.194688 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_accuracy"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂáÜÁ°ÆÊÄß

SELECT 
    transaction_id,
    toll_amount,
    actual_amount,
    discount_amount
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    actual_amount < 0
    OR actual_amount > toll_amount
    OR discount_amount < 0
    OR discount_amount > toll_amount
    OR (actual_amount + discount_amount) > toll_amount * 1.1  -- ÂÖÅËÆ∏10%ËØØÂ∑Æ
  
  
      
    ) dbt_internal_test
[0m02:36:02.197759 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.199124 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: ROLLBACK
[0m02:36:02.199957 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_accuracy'
[0m02:36:02.200255 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: Close
[0m02:36:02.200852 [info ] [Thread-1 (]: 7 of 15 PASS test_toll_transaction_accuracy .................................... [[32mPASS[0m in 0.01s]
[0m02:36:02.201337 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_accuracy
[0m02:36:02.201666 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_completeness
[0m02:36:02.201971 [info ] [Thread-1 (]: 8 of 15 START test test_toll_transaction_completeness .......................... [RUN]
[0m02:36:02.202380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_accuracy, now test.datacore.test_toll_transaction_completeness)
[0m02:36:02.202679 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_completeness
[0m02:36:02.204976 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.205448 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_completeness
[0m02:36:02.207119 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.207570 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.207873 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: BEGIN
[0m02:36:02.208160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.209102 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.209407 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:36:02.209717 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_completeness"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂÆåÊï¥ÊÄß

SELECT 
    transaction_id,
    station_id,
    vehicle_plate,
    vehicle_type_code,
    payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    transaction_id IS NULL
    OR station_id IS NULL
    OR vehicle_plate IS NULL
    OR vehicle_plate = ''
    OR vehicle_type_code IS NULL
    OR payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:36:02.215894 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m02:36:02.217288 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: ROLLBACK
[0m02:36:02.218150 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_completeness'
[0m02:36:02.218462 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: Close
[0m02:36:02.219114 [info ] [Thread-1 (]: 8 of 15 PASS test_toll_transaction_completeness ................................ [[32mPASS[0m in 0.02s]
[0m02:36:02.219613 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_completeness
[0m02:36:02.219949 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_consistency
[0m02:36:02.220331 [info ] [Thread-1 (]: 9 of 15 START test test_toll_transaction_consistency ........................... [RUN]
[0m02:36:02.220681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_completeness, now test.datacore.test_toll_transaction_consistency)
[0m02:36:02.220981 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_consistency
[0m02:36:02.224886 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.225397 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_consistency
[0m02:36:02.227059 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.227511 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.227812 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: BEGIN
[0m02:36:02.228098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.228822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.229118 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:36:02.229428 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_consistency"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆ‰∏ÄËá¥ÊÄß

SELECT 
    transaction_id,
    entry_time,
    exit_time,
    travel_minutes
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    exit_time < entry_time
    OR travel_minutes < 0
    OR travel_minutes > 1440  -- Ë∂ÖËøá24Â∞èÊó∂ËßÜ‰∏∫ÂºÇÂ∏∏
  
  
      
    ) dbt_internal_test
[0m02:36:02.232504 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.233846 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: ROLLBACK
[0m02:36:02.234668 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_consistency'
[0m02:36:02.234966 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: Close
[0m02:36:02.235527 [info ] [Thread-1 (]: 9 of 15 PASS test_toll_transaction_consistency ................................. [[32mPASS[0m in 0.01s]
[0m02:36:02.236014 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_consistency
[0m02:36:02.236357 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.236727 [info ] [Thread-1 (]: 10 of 15 START test test_toll_transaction_referential_integrity ................ [RUN]
[0m02:36:02.237072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_consistency, now test.datacore.test_toll_transaction_referential_integrity)
[0m02:36:02.237381 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.240393 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.240879 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.242579 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.243021 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.243330 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: BEGIN
[0m02:36:02.243618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.244342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.244639 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:36:02.244960 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_referential_integrity"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂºïÁî®ÂÆåÊï¥ÊÄß

SELECT 
    t.transaction_id,
    t.station_id,
    t.vehicle_type_code,
    t.payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail" t
LEFT JOIN "datacore"."main_ods"."ods_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
WHERE 
    s.station_id IS NULL
    OR vt.vehicle_type_code IS NULL
    OR pm.payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:36:02.252781 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:36:02.254233 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: ROLLBACK
[0m02:36:02.255079 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_referential_integrity'
[0m02:36:02.255395 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: Close
[0m02:36:02.256400 [info ] [Thread-1 (]: 10 of 15 PASS test_toll_transaction_referential_integrity ...................... [[32mPASS[0m in 0.02s]
[0m02:36:02.256893 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_referential_integrity
[0m02:36:02.257234 [debug] [Thread-1 (]: Began running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.257611 [info ] [Thread-1 (]: 11 of 15 START test unique_dwd_toll_transaction_detail_transaction_id .......... [RUN]
[0m02:36:02.257963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_referential_integrity, now test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716)
[0m02:36:02.258267 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.263803 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.264337 [debug] [Thread-1 (]: Began executing node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.266116 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.266579 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.266888 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: BEGIN
[0m02:36:02.267180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.267921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.268217 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:36:02.268530 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.287129 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m02:36:02.288765 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: ROLLBACK
[0m02:36:02.289612 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716'
[0m02:36:02.289920 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: Close
[0m02:36:02.292233 [info ] [Thread-1 (]: 11 of 15 PASS unique_dwd_toll_transaction_detail_transaction_id ................ [[32mPASS[0m in 0.03s]
[0m02:36:02.292739 [debug] [Thread-1 (]: Finished running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:36:02.293082 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.293475 [info ] [Thread-1 (]: 12 of 15 START test unique_stg_payment_method_dict_payment_method_code ......... [RUN]
[0m02:36:02.293830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716, now test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1)
[0m02:36:02.294135 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.297367 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.297860 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.299571 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.300054 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.300374 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: BEGIN
[0m02:36:02.300670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.301438 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.301740 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:36:02.302051 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_method_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is not null
group by payment_method_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.304919 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:36:02.306379 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: ROLLBACK
[0m02:36:02.307208 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1'
[0m02:36:02.307522 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: Close
[0m02:36:02.308414 [info ] [Thread-1 (]: 12 of 15 PASS unique_stg_payment_method_dict_payment_method_code ............... [[32mPASS[0m in 0.01s]
[0m02:36:02.308905 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:36:02.309244 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.309634 [info ] [Thread-1 (]: 13 of 15 START test unique_stg_toll_station_station_id ......................... [RUN]
[0m02:36:02.309985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1, now test.datacore.unique_stg_toll_station_station_id.7201f48e61)
[0m02:36:02.310287 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.313520 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.314020 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.315788 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.316270 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.316581 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: BEGIN
[0m02:36:02.316870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.317631 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.317952 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:36:02.318299 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_station_station_id.7201f48e61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    station_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_station"
where station_id is not null
group by station_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.321029 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:36:02.322605 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: ROLLBACK
[0m02:36:02.323529 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_station_station_id.7201f48e61'
[0m02:36:02.323861 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: Close
[0m02:36:02.324934 [info ] [Thread-1 (]: 13 of 15 PASS unique_stg_toll_station_station_id ............................... [[32mPASS[0m in 0.01s]
[0m02:36:02.325478 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:36:02.325852 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.326251 [info ] [Thread-1 (]: 14 of 15 START test unique_stg_toll_transaction_transaction_id ................. [RUN]
[0m02:36:02.326646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_station_station_id.7201f48e61, now test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27)
[0m02:36:02.326977 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.330597 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.331124 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.334948 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.335496 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.335831 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: BEGIN
[0m02:36:02.336146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.336945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.337267 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:36:02.337606 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.359722 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m02:36:02.361549 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: ROLLBACK
[0m02:36:02.362482 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27'
[0m02:36:02.362822 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: Close
[0m02:36:02.366393 [info ] [Thread-1 (]: 14 of 15 PASS unique_stg_toll_transaction_transaction_id ....................... [[32mPASS[0m in 0.04s]
[0m02:36:02.366988 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:36:02.367374 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.367784 [info ] [Thread-1 (]: 15 of 15 START test unique_stg_vehicle_type_dict_vehicle_type_code ............. [RUN]
[0m02:36:02.368184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27, now test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd)
[0m02:36:02.368534 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.372359 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.372884 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.374823 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.375322 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.375661 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: BEGIN
[0m02:36:02.375976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:36:02.376778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:36:02.377099 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:36:02.377443 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vehicle_type_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is not null
group by vehicle_type_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:36:02.379816 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:36:02.381363 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: ROLLBACK
[0m02:36:02.382270 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd'
[0m02:36:02.382609 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: Close
[0m02:36:02.383680 [info ] [Thread-1 (]: 15 of 15 PASS unique_stg_vehicle_type_dict_vehicle_type_code ................... [[32mPASS[0m in 0.02s]
[0m02:36:02.384217 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:36:02.386045 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.386757 [debug] [MainThread]: On master: BEGIN
[0m02:36:02.387237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:02.388365 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:36:02.388899 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.389434 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:02.389941 [debug] [MainThread]: On master: COMMIT
[0m02:36:02.390740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:02.391324 [debug] [MainThread]: On master: Close
[0m02:36:02.392096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:02.392603 [debug] [MainThread]: Connection 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd' was properly closed.
[0m02:36:02.393179 [info ] [MainThread]: 
[0m02:36:02.393785 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m02:36:02.398675 [debug] [MainThread]: Command end result
[0m02:36:02.447328 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:36:02.449484 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:36:02.456563 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:36:02.456896 [info ] [MainThread]: 
[0m02:36:02.457264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:36:02.457615 [info ] [MainThread]: 
[0m02:36:02.457945 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m02:36:02.458884 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3833071, "process_in_blocks": "880", "process_kernel_time": 0.293089, "process_mem_max_rss": "187472", "process_out_blocks": "3088", "process_user_time": 2.535126}
[0m02:36:02.459324 [debug] [MainThread]: Command `dbt test` succeeded at 02:36:02.459229 after 1.38 seconds
[0m02:36:02.459689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0339aaf4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033b3caf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e033983f830>]}
[0m02:36:02.460047 [debug] [MainThread]: Flushing usage events
[0m02:36:03.632750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:40:54.752850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7aec206690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae95e5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae8b27ce0>]}


============================== 02:40:54.757000 | e4710e71-4775-438f-8675-49424c781218 ==============================
[0m02:40:54.757000 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:40:54.757481 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select metadata.meta_table_info', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default'}
[0m02:40:54.959664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4710e71-4775-438f-8675-49424c781218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae899dc70>]}
[0m02:40:55.017844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4710e71-4775-438f-8675-49424c781218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae93001a0>]}
[0m02:40:55.019377 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:40:55.101437 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:40:55.234084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 3 files changed.
[0m02:40:55.234696 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_model_lineage.sql
[0m02:40:55.235002 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_table_info.sql
[0m02:40:55.235337 [debug] [MainThread]: Partial parsing: added file: datacore://models/ods/schema.yml
[0m02:40:55.235619 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_all_models.sql
[0m02:40:55.235912 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_lineage.sql
[0m02:40:55.236565 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/schema.yml
[0m02:40:55.236937 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_data_lineage.sql
[0m02:40:55.237293 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_table_info.sql
[0m02:40:55.481079 [error] [MainThread]: Encountered an error:
Compilation Error in model meta_data_lineage (models/metadata/meta_data_lineage.sql)
  'dict object' has no attribute 'nodes'
[0m02:40:55.482144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.78061324, "process_in_blocks": "0", "process_kernel_time": 0.205928, "process_mem_max_rss": "142000", "process_out_blocks": "16", "process_user_time": 1.839294}
[0m02:40:55.482609 [debug] [MainThread]: Command `dbt run` failed at 02:40:55.482519 after 0.78 seconds
[0m02:40:55.483031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae8e18e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ad845ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7ae8485760>]}
[0m02:40:55.483387 [debug] [MainThread]: Flushing usage events
[0m02:40:56.618573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:41:58.096366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19111990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19117d2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d191119bda0>]}


============================== 02:41:58.099238 | 545a6c3e-73bb-4bc8-aa31-87fcff043430 ==============================
[0m02:41:58.099238 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:41:58.099707 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'log_path': '/home/chun/Develop/datacore/logs', 'debug': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select metadata.meta_table_info', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m02:41:58.302083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1910880050>]}
[0m02:41:58.361123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19112a0b60>]}
[0m02:41:58.362551 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:41:58.443648 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:41:58.576091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 3 files changed.
[0m02:41:58.576653 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_model_lineage.sql
[0m02:41:58.576955 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_table_info.sql
[0m02:41:58.577248 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_lineage.sql
[0m02:41:58.577533 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/get_all_models.sql
[0m02:41:58.577850 [debug] [MainThread]: Partial parsing: added file: datacore://models/ods/schema.yml
[0m02:41:58.578472 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/schema.yml
[0m02:41:58.578836 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_table_info.sql
[0m02:41:58.579187 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_data_lineage.sql
[0m02:41:59.147488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1913038fe0>]}
[0m02:41:59.254331 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:41:59.256549 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:41:59.271654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d190018b560>]}
[0m02:41:59.272157 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:41:59.272512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d190072ade0>]}
[0m02:41:59.274210 [info ] [MainThread]: 
[0m02:41:59.274562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:41:59.274883 [info ] [MainThread]: 
[0m02:41:59.275354 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:41:59.276599 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:41:59.316319 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:41:59.316738 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:41:59.317010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:41:59.337337 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m02:41:59.338902 [debug] [ThreadPool]: On list_datacore: Close
[0m02:41:59.339726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:41:59.340158 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:41:59.346949 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.347299 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:41:59.347595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.348791 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.350042 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.350333 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:41:59.351020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:41:59.351285 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.351578 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:41:59.352053 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:41:59.352794 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:41:59.353075 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:41:59.353348 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:41:59.353870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:41:59.354153 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:41:59.360761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:41:59.370239 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:41:59.370829 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:41:59.371361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.372497 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.373037 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:41:59.373608 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.397764 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m02:41:59.400207 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:41:59.402218 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:41:59.402788 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:41:59.403886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_staging)
[0m02:41:59.407760 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:41:59.408339 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:41:59.408865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.410157 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.410698 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:41:59.411242 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.417699 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m02:41:59.418933 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:41:59.419781 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:41:59.420037 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:41:59.420610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:41:59.423597 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:41:59.423889 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:41:59.424166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.424745 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.424996 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:41:59.425282 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.430760 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:41:59.431866 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:41:59.432678 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:41:59.432934 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:41:59.433857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dws)
[0m02:41:59.437246 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:41:59.437672 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:41:59.437953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.438705 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.438979 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:41:59.439264 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.443031 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:41:59.444372 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:41:59.445229 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:41:59.445513 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:41:59.446114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_metadata)
[0m02:41:59.448857 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:41:59.449170 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:41:59.449450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.450124 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.450409 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:41:59.450697 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.455949 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:41:59.457275 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:41:59.458084 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:41:59.458366 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:41:59.458987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ads)
[0m02:41:59.462210 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:41:59.462531 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:41:59.462810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.463442 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.463717 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:41:59.464005 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.467627 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:41:59.468974 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:41:59.469852 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:41:59.470135 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:41:59.470765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:41:59.473513 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:41:59.473825 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:41:59.474101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:41:59.474770 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:41:59.475050 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:41:59.475355 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:41:59.479820 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:41:59.481252 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:41:59.482137 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:41:59.482426 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:41:59.483879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1900085d60>]}
[0m02:41:59.484701 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.485221 [debug] [MainThread]: On master: BEGIN
[0m02:41:59.485720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:41:59.486751 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:41:59.487242 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.487743 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.488213 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.489006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:41:59.489518 [debug] [MainThread]: On master: Close
[0m02:41:59.492844 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:41:59.493946 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m02:41:59.494869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now model.datacore.meta_table_info)
[0m02:41:59.495626 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:41:59.512762 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:41:59.513661 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:41:59.544417 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:41:59.545149 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.545500 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:41:59.545814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:41:59.546665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.547010 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.547538 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:41:59.552563 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:41:59.558399 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.558803 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:41:59.559921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.561182 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.561552 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:41:59.562844 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.569109 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.569547 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:41:59.570334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:41:59.573024 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.573396 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:41:59.574045 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:41:59.588806 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:41:59.589240 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.589594 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:41:59.591907 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:41:59.598844 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:41:59.599296 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:41:59.600879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:41:59.603271 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:41:59.605344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '545a6c3e-73bb-4bc8-aa31-87fcff043430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19130d1640>]}
[0m02:41:59.605982 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.11s]
[0m02:41:59.606562 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:41:59.608495 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.609152 [debug] [MainThread]: On master: BEGIN
[0m02:41:59.609652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:41:59.610687 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:41:59.611172 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.611668 [debug] [MainThread]: Using duckdb connection "master"
[0m02:41:59.612137 [debug] [MainThread]: On master: COMMIT
[0m02:41:59.612916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:41:59.613436 [debug] [MainThread]: On master: Close
[0m02:41:59.614120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:41:59.614586 [debug] [MainThread]: Connection 'model.datacore.meta_table_info' was properly closed.
[0m02:41:59.615107 [info ] [MainThread]: 
[0m02:41:59.615674 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m02:41:59.616751 [debug] [MainThread]: Command end result
[0m02:41:59.664654 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:41:59.666554 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:41:59.671677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:41:59.671958 [info ] [MainThread]: 
[0m02:41:59.672314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:41:59.672589 [info ] [MainThread]: 
[0m02:41:59.672889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:41:59.673676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.631898, "process_in_blocks": "0", "process_kernel_time": 0.245386, "process_mem_max_rss": "160832", "process_out_blocks": "4056", "process_user_time": 2.712215}
[0m02:41:59.674052 [debug] [MainThread]: Command `dbt run` succeeded at 02:41:59.673973 after 1.63 seconds
[0m02:41:59.674368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1910ca1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1911858530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d19132e5970>]}
[0m02:41:59.674683 [debug] [MainThread]: Flushing usage events
[0m02:42:00.770247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:42:09.348650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75576a033620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557693f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75576a033320>]}


============================== 02:42:09.352897 | 52af4f9b-64fa-4e96-b0ac-f1d432634e26 ==============================
[0m02:42:09.352897 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:42:09.353374 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select metadata.meta_data_lineage', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m02:42:09.555582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75576b8326f0>]}
[0m02:42:09.614479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557594f9eb0>]}
[0m02:42:09.616051 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:42:09.698869 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:42:09.835007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:09.835451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:09.898765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75575932dc10>]}
[0m02:42:10.015892 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:10.017825 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:10.033097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557590a2270>]}
[0m02:42:10.033692 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:42:10.034032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755758f46660>]}
[0m02:42:10.035834 [info ] [MainThread]: 
[0m02:42:10.036214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:42:10.036504 [info ] [MainThread]: 
[0m02:42:10.037019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:42:10.038222 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:42:10.072383 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:42:10.072770 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:42:10.073041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:10.092031 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:42:10.093387 [debug] [ThreadPool]: On list_datacore: Close
[0m02:42:10.094098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:42:10.094506 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:42:10.100686 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.101009 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:42:10.101269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.102344 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.103447 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.103713 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:42:10.104130 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:10.104382 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.104630 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:42:10.105066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:10.105751 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:10.106014 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:10.106259 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:10.106721 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:10.106995 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:42:10.113224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_dws)
[0m02:42:10.118427 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:10.118732 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:42:10.118983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.119637 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.119891 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:10.120149 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.132213 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:42:10.133501 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:42:10.134512 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:42:10.134774 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:42:10.135308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:42:10.137972 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:10.138253 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:42:10.138507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.139186 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.139448 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:10.139700 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.144727 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:10.145872 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:42:10.146683 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:42:10.146940 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:42:10.147482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main)
[0m02:42:10.150912 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:10.151230 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:42:10.151488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.152153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.152411 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:10.152665 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.156091 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:10.157173 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:42:10.157964 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:42:10.158217 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:42:10.158731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_metadata)
[0m02:42:10.160316 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:10.160579 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:42:10.160822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.161576 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.161823 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:10.162078 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.166168 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:42:10.167373 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:42:10.168137 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:42:10.168398 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:42:10.168922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_ads)
[0m02:42:10.171896 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:10.172182 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:42:10.172437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.173065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.173321 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:10.173577 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.178559 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:10.179716 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:42:10.180498 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:42:10.180752 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:42:10.181268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:42:10.184001 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:10.184329 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:42:10.184595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.185393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.185663 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:10.185937 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.190959 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:10.192219 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:42:10.193057 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:42:10.193337 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:42:10.194066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:42:10.196561 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:10.196873 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:42:10.197136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:10.197755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:10.198025 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:10.198312 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:10.201914 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:10.203178 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:42:10.204031 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:42:10.204319 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:42:10.206115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75575952e810>]}
[0m02:42:10.206976 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.207494 [debug] [MainThread]: On master: BEGIN
[0m02:42:10.207965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:10.209231 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:10.209747 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.210231 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.210711 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.211469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:10.211960 [debug] [MainThread]: On master: Close
[0m02:42:10.215278 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:42:10.216171 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.meta_data_lineage ................... [RUN]
[0m02:42:10.217013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now model.datacore.meta_data_lineage)
[0m02:42:10.217688 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:42:10.252472 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:42:10.253123 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:42:10.282729 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:42:10.283439 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.283767 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:42:10.284069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:10.284878 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.285183 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.285632 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:42:10.288990 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:42:10.294122 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.294489 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:10.295503 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.296739 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.297072 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:10.298218 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.303809 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.304185 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:42:10.304905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:10.307281 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.307624 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:42:10.308218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:10.322905 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:10.323321 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.323631 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:10.325398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.387687 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:10.388144 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:42:10.389992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:10.392112 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:42:10.394082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52af4f9b-64fa-4e96-b0ac-f1d432634e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7557591aa360>]}
[0m02:42:10.394644 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.meta_data_lineage .............. [[32mOK[0m in 0.18s]
[0m02:42:10.395229 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:42:10.397039 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.397737 [debug] [MainThread]: On master: BEGIN
[0m02:42:10.398221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:10.399374 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:10.399861 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.400408 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:10.400869 [debug] [MainThread]: On master: COMMIT
[0m02:42:10.401619 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:10.402111 [debug] [MainThread]: On master: Close
[0m02:42:10.402896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:10.403360 [debug] [MainThread]: Connection 'model.datacore.meta_data_lineage' was properly closed.
[0m02:42:10.403862 [info ] [MainThread]: 
[0m02:42:10.404409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m02:42:10.405509 [debug] [MainThread]: Command end result
[0m02:42:10.458812 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:10.462456 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:10.469261 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:42:10.469668 [info ] [MainThread]: 
[0m02:42:10.470184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:10.470478 [info ] [MainThread]: 
[0m02:42:10.470836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:42:10.472254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1747735, "process_in_blocks": "0", "process_kernel_time": 0.223084, "process_mem_max_rss": "155400", "process_out_blocks": "2816", "process_user_time": 2.200829}
[0m02:42:10.472814 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:10.472696 after 1.18 seconds
[0m02:42:10.473312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755769de79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755769495160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7556f909f140>]}
[0m02:42:10.473715 [debug] [MainThread]: Flushing usage events
[0m02:42:11.642178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:42:16.535274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759624be6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596244a3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596265e5e20>]}


============================== 02:42:16.539916 | 3613b94d-9d28-4356-b3cf-7105bdc1e4c8 ==============================
[0m02:42:16.539916 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:42:16.540394 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/home/chun/Develop/datacore', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/home/chun/Develop/datacore/logs', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select metadata'}
[0m02:42:16.745044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613f3c770>]}
[0m02:42:16.804901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596245c91f0>]}
[0m02:42:16.806521 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:42:16.888841 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:42:17.020349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:17.020748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:17.082792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759623c10890>]}
[0m02:42:17.188360 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:17.190124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:17.203870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613f5eea0>]}
[0m02:42:17.204392 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:42:17.204715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613bac530>]}
[0m02:42:17.206494 [info ] [MainThread]: 
[0m02:42:17.206820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:42:17.207086 [info ] [MainThread]: 
[0m02:42:17.207562 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:42:17.212463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:42:17.253208 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:42:17.253594 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:42:17.253863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:17.272912 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:42:17.274233 [debug] [ThreadPool]: On list_datacore: Close
[0m02:42:17.275114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:42:17.275507 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:42:17.281585 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.281910 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:42:17.282168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.283235 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.284331 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.284589 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:42:17.285000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:17.285245 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.285496 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:42:17.285927 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:17.286602 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:17.286860 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:42:17.287099 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:42:17.287482 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:17.287735 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:42:17.290084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_metadata)
[0m02:42:17.295288 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:17.295596 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:42:17.295844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.296537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.296793 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:42:17.297048 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.309135 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:42:17.310439 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:42:17.311455 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:42:17.311719 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:42:17.312254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main)
[0m02:42:17.315136 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:17.315433 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:42:17.315678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.316257 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.316517 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:42:17.316771 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.320741 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:42:17.321853 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:42:17.322671 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:42:17.322930 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:42:17.323453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:42:17.326356 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:17.326673 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:42:17.326920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.327656 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.327908 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:42:17.328163 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.333260 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:17.334453 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:42:17.335220 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:42:17.335487 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:42:17.336013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_ods)
[0m02:42:17.338481 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:17.338776 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:42:17.339029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.339607 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.339859 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:42:17.340115 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.343431 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:17.344577 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:42:17.345361 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:42:17.345614 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:42:17.346135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:42:17.348351 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:17.348635 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:42:17.348877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.349525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.349789 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:42:17.350044 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.355426 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:42:17.356616 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:42:17.357391 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:42:17.357651 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:42:17.358176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m02:42:17.360848 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:17.361131 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:42:17.361383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.362019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.362269 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:42:17.362529 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.366892 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:42:17.368044 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:42:17.368820 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:42:17.369075 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:42:17.369735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:42:17.372193 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:17.372483 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:42:17.372726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:17.373369 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:42:17.373618 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:42:17.373869 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:42:17.377203 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:42:17.378333 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:42:17.379122 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:42:17.379381 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:42:17.380635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbe12870>]}
[0m02:42:17.381488 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.381994 [debug] [MainThread]: On master: BEGIN
[0m02:42:17.382486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:17.383489 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:17.383977 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.384475 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.384943 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.385680 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:17.386170 [debug] [MainThread]: On master: Close
[0m02:42:17.389412 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:42:17.389999 [info ] [Thread-1 (]: 1 of 5 START sql table model main_metadata.meta_data_dictionary ................ [RUN]
[0m02:42:17.390474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_data_dictionary)
[0m02:42:17.390831 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:42:17.399311 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:42:17.399971 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:42:17.432847 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:42:17.433532 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.433882 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:42:17.434225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.435153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.435504 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.435916 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:42:17.439856 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:42:17.445592 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.445990 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:42:17.447032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.448234 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.448602 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:42:17.449741 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.456017 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.456455 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:42:17.457501 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.460118 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.460491 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:42:17.461208 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.476040 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:42:17.476459 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.476802 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:42:17.478600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.485294 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:42:17.485731 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:42:17.487299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.489596 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:42:17.491434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbaaf4d0>]}
[0m02:42:17.492033 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main_metadata.meta_data_dictionary ........... [[32mOK[0m in 0.10s]
[0m02:42:17.492600 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:42:17.492997 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:42:17.493500 [info ] [Thread-1 (]: 2 of 5 START sql table model main_metadata.meta_data_lineage ................... [RUN]
[0m02:42:17.493906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.meta_data_lineage)
[0m02:42:17.494251 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:42:17.576172 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:42:17.576860 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:42:17.579411 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:42:17.579933 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.580262 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:42:17.580590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.581398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.581734 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.582217 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:42:17.585939 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:42:17.586976 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.587343 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:17.588697 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.589842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.590195 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:42:17.591150 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.594053 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.594437 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:42:17.595123 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.597608 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.597969 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:42:17.598624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.599853 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:17.600215 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.600569 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:42:17.602086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.604269 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:42:17.604631 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:42:17.605997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.607322 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:42:17.608488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbee4590>]}
[0m02:42:17.609059 [info ] [Thread-1 (]: 2 of 5 OK created sql table model main_metadata.meta_data_lineage .............. [[32mOK[0m in 0.11s]
[0m02:42:17.609618 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:42:17.610007 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:42:17.610520 [info ] [Thread-1 (]: 3 of 5 START sql table model main_metadata.meta_data_quality_metrics ........... [RUN]
[0m02:42:17.610919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_data_quality_metrics)
[0m02:42:17.611270 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:42:17.614629 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:42:17.615220 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:42:17.617871 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:42:17.618449 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.618794 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:42:17.619123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.619924 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.620261 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.620681 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:42:17.633813 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m02:42:17.635041 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.635414 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:42:17.636453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.637583 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.637938 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:42:17.638913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.641851 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.642329 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m02:42:17.643031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.646869 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.647260 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:42:17.647985 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.649236 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:42:17.649607 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.649948 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:42:17.651536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.653665 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:42:17.654026 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:42:17.655478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.656694 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:42:17.657395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759613aaac30>]}
[0m02:42:17.657955 [info ] [Thread-1 (]: 3 of 5 OK created sql table model main_metadata.meta_data_quality_metrics ...... [[32mOK[0m in 0.05s]
[0m02:42:17.658509 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:42:17.658889 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:42:17.659366 [info ] [Thread-1 (]: 4 of 5 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m02:42:17.659755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.meta_table_info)
[0m02:42:17.660101 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:42:17.671350 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:42:17.672008 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:42:17.674547 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:42:17.675078 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.675412 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:42:17.675723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.676527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.676867 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.677402 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:42:17.682314 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:42:17.683641 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.684011 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:42:17.685021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.686182 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.686550 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:42:17.687935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.690872 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.691253 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:42:17.692114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.694626 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.694994 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:42:17.695661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.696881 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:42:17.697235 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.697580 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:42:17.699087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.701123 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:42:17.701490 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:42:17.702828 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.704043 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:42:17.704688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbf763f0>]}
[0m02:42:17.705246 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.04s]
[0m02:42:17.705801 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:42:17.706688 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:42:17.707210 [info ] [Thread-1 (]: 5 of 5 START sql table model main_metadata.meta_data_asset_catalog ............. [RUN]
[0m02:42:17.707623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.meta_data_asset_catalog)
[0m02:42:17.707967 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:42:17.712120 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:42:17.712748 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:42:17.715480 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:42:17.716052 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.716410 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:42:17.716744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:17.717556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.717895 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.718312 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:42:17.727572 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:42:17.728990 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.729372 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:42:17.730742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.731902 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.732262 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:42:17.733292 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.736175 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.736568 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m02:42:17.737264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.741363 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.741777 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:42:17.742533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:42:17.743794 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:42:17.744158 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.744508 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:42:17.746163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.748263 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:42:17.748637 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:42:17.750057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:42:17.751271 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:42:17.753532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3613b94d-9d28-4356-b3cf-7105bdc1e4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7595fbeb5c10>]}
[0m02:42:17.754113 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main_metadata.meta_data_asset_catalog ........ [[32mOK[0m in 0.05s]
[0m02:42:17.754676 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:42:17.756107 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.756740 [debug] [MainThread]: On master: BEGIN
[0m02:42:17.757169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:17.758248 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:42:17.758819 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.759382 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:17.759906 [debug] [MainThread]: On master: COMMIT
[0m02:42:17.760783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:17.761347 [debug] [MainThread]: On master: Close
[0m02:42:17.762150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:17.762705 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:42:17.763392 [info ] [MainThread]: 
[0m02:42:17.764040 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:42:17.766479 [debug] [MainThread]: Command end result
[0m02:42:17.820508 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:42:17.823142 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:42:17.829575 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:42:17.829919 [info ] [MainThread]: 
[0m02:42:17.830314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:17.830622 [info ] [MainThread]: 
[0m02:42:17.830977 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:42:17.832073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3488854, "process_in_blocks": "0", "process_kernel_time": 0.269089, "process_mem_max_rss": "168852", "process_out_blocks": "3144", "process_user_time": 2.375617}
[0m02:42:17.832525 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:17.832435 after 1.35 seconds
[0m02:42:17.832926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759624a496d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759624a4a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596240ef230>]}
[0m02:42:17.833280 [debug] [MainThread]: Flushing usage events
[0m02:42:19.219677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:43:01.359634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0972013da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a097290aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971d4a510>]}


============================== 02:43:01.363689 | eb7b9c6f-1899-46ba-be4a-478d6eb130d7 ==============================
[0m02:43:01.363689 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:43:01.364167 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'profiles_dir': '/home/chun/Develop/datacore', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run --select metadata', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m02:43:01.563764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0974262b10>]}
[0m02:43:01.622357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971a291c0>]}
[0m02:43:01.623898 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:43:01.705209 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:43:01.837251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m02:43:01.837860 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/README.md
[0m02:43:01.942780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0961d3dd60>]}
[0m02:43:02.047629 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:02.049385 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:02.062422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0961af7c50>]}
[0m02:43:02.062912 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 467 macros
[0m02:43:02.063230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0961d3c5c0>]}
[0m02:43:02.064944 [info ] [MainThread]: 
[0m02:43:02.065262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:02.065534 [info ] [MainThread]: 
[0m02:43:02.065995 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:43:02.071130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:43:02.115488 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:43:02.115883 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:43:02.116158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:02.136650 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m02:43:02.138005 [debug] [ThreadPool]: On list_datacore: Close
[0m02:43:02.138701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m02:43:02.139097 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:43:02.145322 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.145638 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:43:02.145904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.147158 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.148286 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.148565 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:43:02.149126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:43:02.149389 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.149642 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:43:02.150180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:43:02.150881 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:43:02.151152 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:43:02.151408 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:43:02.151843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:43:02.152107 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:43:02.154190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:43:02.159281 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:02.159595 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:43:02.159850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.160652 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.160910 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:02.161169 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.173577 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:43:02.174837 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:43:02.175849 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:43:02.176119 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:43:02.176683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ods)
[0m02:43:02.178636 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:02.178922 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:43:02.179173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.179921 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.180176 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:02.180443 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.184032 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:02.185195 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:43:02.185992 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:43:02.186248 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:43:02.186786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main)
[0m02:43:02.188915 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:02.189202 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:43:02.189459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.190204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.190462 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:02.190717 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.194189 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:02.195245 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:43:02.196035 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:43:02.196293 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:43:02.196821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:43:02.198399 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:02.198665 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:43:02.198912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.199568 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.199820 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:02.200078 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.205318 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:02.206486 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:43:02.207270 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:43:02.207532 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:43:02.208064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m02:43:02.210435 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:02.210736 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:43:02.210982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.211655 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.211910 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:02.212170 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.217255 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:02.218464 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:43:02.219238 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:43:02.219501 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:43:02.220064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_metadata)
[0m02:43:02.222763 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:02.223049 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:43:02.223296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.223890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.224144 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:02.224415 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.228053 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:02.229250 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:43:02.230047 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:43:02.230312 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:43:02.230981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dws)
[0m02:43:02.233990 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:02.234275 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:43:02.234531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:02.235180 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:02.235441 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:02.235699 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:02.239775 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:43:02.240940 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:43:02.241727 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:43:02.241980 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:43:02.243787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0960155070>]}
[0m02:43:02.244619 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.245136 [debug] [MainThread]: On master: BEGIN
[0m02:43:02.245632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:02.246616 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:02.247111 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.247620 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.248093 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.248868 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:02.249387 [debug] [MainThread]: On master: Close
[0m02:43:02.252747 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:43:02.253721 [info ] [Thread-1 (]: 1 of 5 START sql table model main_metadata.meta_data_dictionary ................ [RUN]
[0m02:43:02.254553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now model.datacore.meta_data_dictionary)
[0m02:43:02.255207 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:43:02.265790 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:43:02.266418 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:43:02.354211 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:43:02.354899 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.355233 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:43:02.355548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.356441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.356754 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.357124 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:43:02.362131 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m02:43:02.367534 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.367893 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:43:02.369030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.370139 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.370472 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:43:02.371522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.377202 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.377604 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:43:02.378481 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.380941 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.381274 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:43:02.381935 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.395920 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:43:02.396380 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.396703 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:43:02.398699 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:43:02.403930 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:43:02.404353 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:43:02.405983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.408133 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:43:02.410066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0974261af0>]}
[0m02:43:02.410620 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main_metadata.meta_data_dictionary ........... [[32mOK[0m in 0.15s]
[0m02:43:02.411130 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:43:02.411492 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:43:02.411959 [info ] [Thread-1 (]: 2 of 5 START sql table model main_metadata.meta_data_lineage ................... [RUN]
[0m02:43:02.412343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.meta_data_lineage)
[0m02:43:02.412661 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:43:02.430339 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:43:02.430972 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:43:02.433524 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:43:02.434028 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.434350 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:43:02.434656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.435516 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.435820 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.436253 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:43:02.440500 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:43:02.441549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.441873 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:43:02.443215 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.444405 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.444740 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:43:02.445935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.448715 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.449063 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:43:02.449832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.453511 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.453877 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:43:02.454670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.455866 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:43:02.456199 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.456518 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:43:02.457996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.460086 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:43:02.460440 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:43:02.461936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.463127 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:43:02.463764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0905ef1400>]}
[0m02:43:02.464288 [info ] [Thread-1 (]: 2 of 5 OK created sql table model main_metadata.meta_data_lineage .............. [[32mOK[0m in 0.05s]
[0m02:43:02.464793 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:43:02.465146 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:43:02.465630 [info ] [Thread-1 (]: 3 of 5 START sql table model main_metadata.meta_data_quality_metrics ........... [RUN]
[0m02:43:02.465992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_data_quality_metrics)
[0m02:43:02.466314 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:43:02.469348 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:43:02.469863 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:43:02.472450 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:43:02.472996 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.473320 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:43:02.473630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.474482 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.474790 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.475162 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:43:02.494137 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m02:43:02.495371 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.495730 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:43:02.496903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.498054 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.498414 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:43:02.499475 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.502387 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.502757 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m02:43:02.503509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.505974 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.506344 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:43:02.506997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.508202 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:43:02.508562 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.508895 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:43:02.510456 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.512546 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:43:02.512907 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:43:02.514371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.515583 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:43:02.516631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a09619d7890>]}
[0m02:43:02.517212 [info ] [Thread-1 (]: 3 of 5 OK created sql table model main_metadata.meta_data_quality_metrics ...... [[32mOK[0m in 0.05s]
[0m02:43:02.517760 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:43:02.518142 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:43:02.518622 [info ] [Thread-1 (]: 4 of 5 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m02:43:02.519018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.meta_table_info)
[0m02:43:02.519371 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:43:02.531661 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:43:02.532338 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:43:02.535179 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:43:02.535724 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.536073 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:43:02.536405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.537299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.537642 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.538155 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:43:02.543254 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m02:43:02.544353 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.544707 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:43:02.545715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.546870 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.547221 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:43:02.548199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.551095 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.551474 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:43:02.552195 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.556454 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.556850 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:43:02.557624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.558842 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:43:02.559191 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.559529 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:43:02.561324 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.563366 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:43:02.563719 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:43:02.565137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.566356 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:43:02.567064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0905ae6f00>]}
[0m02:43:02.567642 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.05s]
[0m02:43:02.568181 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:43:02.569116 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:43:02.569568 [info ] [Thread-1 (]: 5 of 5 START sql table model main_metadata.meta_data_asset_catalog ............. [RUN]
[0m02:43:02.569981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.meta_data_asset_catalog)
[0m02:43:02.570350 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:43:02.574759 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:43:02.575363 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:43:02.578115 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:43:02.578667 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.579017 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:43:02.579376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:02.580284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.580631 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.581041 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:43:02.591639 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m02:43:02.593038 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.593425 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:43:02.594549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.595750 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.596106 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:43:02.597098 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.600122 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.600514 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m02:43:02.601185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.603715 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.604085 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:43:02.604729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:43:02.605963 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:43:02.606333 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.606673 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:43:02.608627 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.611102 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:43:02.611461 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:43:02.613039 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:02.614258 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:43:02.615797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7b9c6f-1899-46ba-be4a-478d6eb130d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0905ac6480>]}
[0m02:43:02.616380 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main_metadata.meta_data_asset_catalog ........ [[32mOK[0m in 0.05s]
[0m02:43:02.616881 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:43:02.618430 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.619079 [debug] [MainThread]: On master: BEGIN
[0m02:43:02.619620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:02.620653 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:02.621188 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.621730 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:02.622242 [debug] [MainThread]: On master: COMMIT
[0m02:43:02.623089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:02.623640 [debug] [MainThread]: On master: Close
[0m02:43:02.625151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:02.625675 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:43:02.626323 [info ] [MainThread]: 
[0m02:43:02.626928 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:43:02.629176 [debug] [MainThread]: Command end result
[0m02:43:02.676619 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:02.678589 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:02.684072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:43:02.684390 [info ] [MainThread]: 
[0m02:43:02.684734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:02.685009 [info ] [MainThread]: 
[0m02:43:02.685319 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:43:02.686143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3833032, "process_in_blocks": "0", "process_kernel_time": 0.283375, "process_mem_max_rss": "169296", "process_out_blocks": "4376", "process_user_time": 2.504481}
[0m02:43:02.686550 [debug] [MainThread]: Command `dbt run` succeeded at 02:43:02.686469 after 1.38 seconds
[0m02:43:02.686879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a09762db440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971d4b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0971d4a510>]}
[0m02:43:02.687207 [debug] [MainThread]: Flushing usage events
[0m02:43:04.112206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:43:57.178218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcf6f63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bcec6fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd1105190>]}


============================== 02:43:57.182999 | f6fc059a-8321-4e85-b7f6-cf7ee662979a ==============================
[0m02:43:57.182999 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:43:57.183518 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_toll_transaction_completeness', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/chun/Develop/datacore'}
[0m02:43:57.392849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd0ffe720>]}
[0m02:43:57.451156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bceb39c70>]}
[0m02:43:57.452723 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:43:57.534592 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:43:57.666119 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m02:43:57.666643 [debug] [MainThread]: Partial parsing: deleted file: datacore://macros/metadata/get_all_models.sql
[0m02:43:57.666921 [debug] [MainThread]: Partial parsing: deleted file: datacore://macros/metadata/get_model_lineage.sql
[0m02:43:57.774193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbe77f590>]}
[0m02:43:57.878747 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:57.880512 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:57.902535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbed52090>]}
[0m02:43:57.903073 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 465 macros
[0m02:43:57.903391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbc1a7260>]}
[0m02:43:57.905003 [info ] [MainThread]: 
[0m02:43:57.905325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:57.905588 [info ] [MainThread]: 
[0m02:43:57.906048 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:43:57.911871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore_main_dws'
[0m02:43:57.951621 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:57.952013 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:43:57.952296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:57.970512 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:43:57.970950 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:43:57.971250 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:57.983546 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m02:43:57.984935 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:43:57.986004 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:43:57.986315 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:43:57.986912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main)
[0m02:43:57.989662 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:57.989976 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:43:57.990255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:57.990930 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:57.991210 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:43:57.991515 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:57.995579 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:43:57.996750 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:43:57.997610 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:43:57.997893 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:43:57.998481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_metadata)
[0m02:43:58.000176 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:58.000484 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:43:58.000757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.001346 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.001626 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:43:58.001924 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.005813 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:43:58.007125 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:43:58.007979 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:43:58.008261 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:43:58.008857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_staging)
[0m02:43:58.011513 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:58.011827 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:43:58.012102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.012762 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.013041 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:43:58.013336 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.017132 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:58.018295 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:43:58.019116 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:43:58.019408 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:43:58.019992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dwd)
[0m02:43:58.022475 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:58.022771 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:43:58.023028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.023589 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.023849 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:43:58.024116 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.027820 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:43:58.029030 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:43:58.029867 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:43:58.030148 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:43:58.030723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_ods)
[0m02:43:58.033755 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:58.034655 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:43:58.034964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.035661 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.035947 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:43:58.036240 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.041441 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:58.042623 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:43:58.043394 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:43:58.043662 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:43:58.044197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m02:43:58.104001 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:58.104413 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:43:58.104692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:58.105392 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:43:58.105653 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:43:58.105921 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:43:58.111002 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:43:58.112190 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:43:58.113016 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:43:58.113298 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:43:58.115451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6fc059a-8321-4e85-b7f6-cf7ee662979a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd10c57f0>]}
[0m02:43:58.116293 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.116801 [debug] [MainThread]: On master: BEGIN
[0m02:43:58.117269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:58.118403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:58.118894 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.119393 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.119866 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.120637 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:58.121125 [debug] [MainThread]: On master: Close
[0m02:43:58.124475 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_completeness
[0m02:43:58.125202 [info ] [Thread-1 (]: 1 of 1 START test test_toll_transaction_completeness ........................... [RUN]
[0m02:43:58.125940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now test.datacore.test_toll_transaction_completeness)
[0m02:43:58.126556 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_completeness
[0m02:43:58.139047 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.140085 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_completeness
[0m02:43:58.159255 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.159924 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.160268 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: BEGIN
[0m02:43:58.160603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:58.161559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:43:58.161886 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:43:58.162227 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_completeness"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂÆåÊï¥ÊÄß

SELECT 
    transaction_id,
    station_id,
    vehicle_plate,
    vehicle_type_code,
    payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    transaction_id IS NULL
    OR station_id IS NULL
    OR vehicle_plate IS NULL
    OR vehicle_plate = ''
    OR vehicle_type_code IS NULL
    OR payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:43:58.169424 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:43:58.173692 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: ROLLBACK
[0m02:43:58.174660 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_completeness'
[0m02:43:58.175003 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: Close
[0m02:43:58.175753 [info ] [Thread-1 (]: 1 of 1 PASS test_toll_transaction_completeness ................................. [[32mPASS[0m in 0.05s]
[0m02:43:58.176318 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_completeness
[0m02:43:58.177895 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.178514 [debug] [MainThread]: On master: BEGIN
[0m02:43:58.179014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:58.179986 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:43:58.180487 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.180986 [debug] [MainThread]: Using duckdb connection "master"
[0m02:43:58.181483 [debug] [MainThread]: On master: COMMIT
[0m02:43:58.182247 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:43:58.182789 [debug] [MainThread]: On master: Close
[0m02:43:58.183465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:58.183885 [debug] [MainThread]: Connection 'test.datacore.test_toll_transaction_completeness' was properly closed.
[0m02:43:58.184283 [info ] [MainThread]: 
[0m02:43:58.184719 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:43:58.185600 [debug] [MainThread]: Command end result
[0m02:43:58.228726 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:43:58.230616 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:43:58.236515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:43:58.236811 [info ] [MainThread]: 
[0m02:43:58.237143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:58.237423 [info ] [MainThread]: 
[0m02:43:58.237723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:43:58.238523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1158736, "process_in_blocks": "0", "process_kernel_time": 0.238987, "process_mem_max_rss": "159108", "process_out_blocks": "3960", "process_user_time": 2.164832}
[0m02:43:58.238918 [debug] [MainThread]: Command `dbt test` succeeded at 02:43:58.238836 after 1.12 seconds
[0m02:43:58.239248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bceb97590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bd2db3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706bbc1fa9f0>]}
[0m02:43:58.239574 [debug] [MainThread]: Flushing usage events
[0m02:43:59.353241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:44:57.117663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a7a0e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a88bfa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a725a6f0>]}


============================== 02:44:57.122173 | daff4917-0991-4893-a77a-1f1e6b93d494 ==============================
[0m02:44:57.122173 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:44:57.122665 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'empty': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m02:44:57.323898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a725b380>]}
[0m02:44:57.381794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396f02f00>]}
[0m02:44:57.383326 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:44:57.466360 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:44:57.600018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:44:57.600428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:44:57.663850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a6b2bef0>]}
[0m02:44:57.767271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:44:57.769062 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:44:57.782508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396c5d640>]}
[0m02:44:57.783015 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 465 macros
[0m02:44:57.783335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396a9c7a0>]}
[0m02:44:57.785527 [info ] [MainThread]: 
[0m02:44:57.785852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:57.786117 [info ] [MainThread]: 
[0m02:44:57.786588 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:44:57.792369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m02:44:57.833651 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.834032 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.834298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:57.853468 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:44:57.854794 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.856818 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.857165 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.857459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.858502 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.859519 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.861217 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.861548 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.861802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.862751 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.863733 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.865436 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.865721 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.866032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.867273 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.868248 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.869933 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.870210 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.870526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.871504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.872484 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.875361 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m02:44:57.875738 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m02:44:57.875999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.877380 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.878399 [debug] [ThreadPool]: On list_datacore: Close
[0m02:44:57.879244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_ods)
[0m02:44:57.879644 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ods"
"
[0m02:44:57.885471 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.885781 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.886039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.887259 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.888477 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.888738 [debug] [ThreadPool]: On create_datacore_main_ods: BEGIN
[0m02:44:57.889225 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.889481 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.889727 [debug] [ThreadPool]: On create_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ods"} */

    
    
        create schema if not exists "datacore"."main_ods"
    
[0m02:44:57.890167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.890855 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:44:57.891117 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ods"
[0m02:44:57.891371 [debug] [ThreadPool]: On create_datacore_main_ods: COMMIT
[0m02:44:57.891782 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.892037 [debug] [ThreadPool]: On create_datacore_main_ods: Close
[0m02:44:57.892569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ods, now create_datacore_main_staging)
[0m02:44:57.892967 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_staging"
"
[0m02:44:57.894553 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.894823 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.895074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.896002 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.897050 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.897320 [debug] [ThreadPool]: On create_datacore_main_staging: BEGIN
[0m02:44:57.897806 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.898052 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.898297 [debug] [ThreadPool]: On create_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_staging"} */

    
    
        create schema if not exists "datacore"."main_staging"
    
[0m02:44:57.898875 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.899566 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:44:57.899825 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_staging"
[0m02:44:57.900068 [debug] [ThreadPool]: On create_datacore_main_staging: COMMIT
[0m02:44:57.900464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.900721 [debug] [ThreadPool]: On create_datacore_main_staging: Close
[0m02:44:57.901252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_staging, now create_datacore_main_ads)
[0m02:44:57.901678 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_ads"
"
[0m02:44:57.903179 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.903456 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.903706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.904818 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.905870 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.906131 [debug] [ThreadPool]: On create_datacore_main_ads: BEGIN
[0m02:44:57.906551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.906799 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.907045 [debug] [ThreadPool]: On create_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_ads"} */

    
    
        create schema if not exists "datacore"."main_ads"
    
[0m02:44:57.907484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.908152 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:44:57.908414 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_ads"
[0m02:44:57.908659 [debug] [ThreadPool]: On create_datacore_main_ads: COMMIT
[0m02:44:57.909048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.909315 [debug] [ThreadPool]: On create_datacore_main_ads: Close
[0m02:44:57.909826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_ads, now create_datacore_main_metadata)
[0m02:44:57.910221 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m02:44:57.911705 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.911972 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.912220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.913206 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.914259 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.914526 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m02:44:57.914930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.915177 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.915442 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m02:44:57.915863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.916531 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:44:57.916783 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m02:44:57.917025 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m02:44:57.917442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.917691 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m02:44:57.918189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now create_datacore_main_dws)
[0m02:44:57.918595 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dws"
"
[0m02:44:57.920099 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.920374 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.920622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.921772 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.922825 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.923082 [debug] [ThreadPool]: On create_datacore_main_dws: BEGIN
[0m02:44:57.923501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.923742 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.923984 [debug] [ThreadPool]: On create_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dws"} */

    
    
        create schema if not exists "datacore"."main_dws"
    
[0m02:44:57.924412 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.925072 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:44:57.925334 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dws"
[0m02:44:57.925574 [debug] [ThreadPool]: On create_datacore_main_dws: COMMIT
[0m02:44:57.926034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.926286 [debug] [ThreadPool]: On create_datacore_main_dws: Close
[0m02:44:57.926799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dws, now create_datacore_main_dwd)
[0m02:44:57.927183 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_dwd"
"
[0m02:44:57.928693 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.928959 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m02:44:57.929209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.930328 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.931514 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.931831 [debug] [ThreadPool]: On create_datacore_main_dwd: BEGIN
[0m02:44:57.932373 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.932663 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.932908 [debug] [ThreadPool]: On create_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_dwd"} */

    
    
        create schema if not exists "datacore"."main_dwd"
    
[0m02:44:57.933471 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.934161 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:44:57.934429 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_dwd"
[0m02:44:57.934672 [debug] [ThreadPool]: On create_datacore_main_dwd: COMMIT
[0m02:44:57.935093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:44:57.935394 [debug] [ThreadPool]: On create_datacore_main_dwd: Close
[0m02:44:57.938859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_dwd, now list_datacore_main_ods)
[0m02:44:57.948671 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:44:57.949240 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:44:57.949748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.950846 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.951355 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:44:57.951862 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:57.976944 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m02:44:57.978452 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:44:57.979482 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:44:57.979752 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:44:57.980461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m02:44:57.982750 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:44:57.983037 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:44:57.983291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.983974 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.984251 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:44:57.984550 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:57.991772 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m02:44:57.993178 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:44:57.994094 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:44:57.994383 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:44:57.995002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m02:44:57.997600 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:44:57.997916 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:44:57.998189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:57.998928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:57.999205 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:44:57.999500 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.003244 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.004491 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:44:58.005364 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:44:58.005647 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:44:58.006242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ads)
[0m02:44:58.009490 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:44:58.009823 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:44:58.010101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.010808 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.011079 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:44:58.011373 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.015145 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.016483 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:44:58.017337 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:44:58.017620 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:44:58.018215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_metadata)
[0m02:44:58.087135 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:44:58.087568 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:44:58.087838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.088583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.088855 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:44:58.089129 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.092844 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.094154 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:44:58.095009 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:44:58.095286 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:44:58.096219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dws)
[0m02:44:58.099613 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:44:58.099925 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:44:58.100191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.100820 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.101088 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:44:58.101373 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.104937 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:44:58.106163 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:44:58.106999 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:44:58.107272 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:44:58.107843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m02:44:58.110612 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:44:58.110915 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:44:58.111182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:58.111779 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:44:58.112047 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:44:58.112334 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:44:58.117479 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:44:58.118739 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:44:58.119517 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:44:58.119770 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:44:58.120905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a6986c90>]}
[0m02:44:58.121765 [debug] [MainThread]: Using duckdb connection "master"
[0m02:44:58.122267 [debug] [MainThread]: On master: BEGIN
[0m02:44:58.122752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:58.123868 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:44:58.124367 [debug] [MainThread]: On master: COMMIT
[0m02:44:58.124844 [debug] [MainThread]: Using duckdb connection "master"
[0m02:44:58.125300 [debug] [MainThread]: On master: COMMIT
[0m02:44:58.126086 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:44:58.126596 [debug] [MainThread]: On master: Close
[0m02:44:58.130064 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_lineage
[0m02:44:58.131024 [info ] [Thread-1 (]: 1 of 18 START sql table model main_metadata.meta_data_lineage .................. [RUN]
[0m02:44:58.131821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_data_lineage)
[0m02:44:58.132500 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_lineage
[0m02:44:58.163748 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_lineage"
[0m02:44:58.164429 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_lineage
[0m02:44:58.193647 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_lineage"
[0m02:44:58.194320 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.194640 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: BEGIN
[0m02:44:58.194937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.195709 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.196013 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.196455 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_lineage__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª
-- Ëá™Âä®ËØÜÂà´ ref() Âíå source() ‰æùËµñÂÖ≥Á≥ª



SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_ads.ads_quality_monitoring_dashboard' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_station_performance_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ads.ads_toll_revenue_report' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_metadata.meta_table_info' AS source_table, 'main_metadata.meta_data_asset_catalog' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_toll_revenue_daily' AS source_table, 'main_ads.ads_toll_revenue_report' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_toll_revenue_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dws.dws_traffic_flow_daily' AS source_table, 'main_ads.ads_traffic_trend_analysis' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_dws.dws_traffic_flow_daily' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_dwd.dwd_toll_transaction_detail' AS source_table, 'main_metadata.meta_data_quality_metrics' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_ods.ods_toll_transaction' AS source_table, 'main_dwd.dwd_toll_transaction_detail' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_transaction' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_ods.ods_toll_transaction' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_toll_station' AS source_table, 'main_ods.ods_toll_station' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_vehicle_type_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT 'main_staging.stg_payment_method_dict' AS source_table, 'main_metadata.meta_data_dictionary' AS target_table, 'ËΩ¨Êç¢' AS transformation_type, 'Êï∞ÊçÆËΩ¨Êç¢' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_transaction' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_vehicle_type_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_toll_station' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
UNION ALL
SELECT '.' AS source_table, 'main_staging.stg_payment_method_dict' AS target_table, 'Ê∏ÖÊ¥ó' AS transformation_type, 'Êï∞ÊçÆÊ∏ÖÊ¥óÂíåÊ†áÂáÜÂåñ' AS transformation_desc
    );
  
  
[0m02:44:58.200123 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:44:58.205308 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.205663 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:44:58.206702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.207810 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.208137 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_lineage'
  
[0m02:44:58.209214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.215005 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.215386 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage" rename to "meta_data_lineage__dbt_backup"
[0m02:44:58.216165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.218528 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.218853 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */
alter table "datacore"."main_metadata"."meta_data_lineage__dbt_tmp" rename to "meta_data_lineage"
[0m02:44:58.219472 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.232899 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:44:58.233277 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.233591 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: COMMIT
[0m02:44:58.235256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.241495 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_lineage"
[0m02:44:58.241874 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_lineage"} */

      drop table if exists "datacore"."main_metadata"."meta_data_lineage__dbt_backup" cascade
    
[0m02:44:58.243403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.245539 [debug] [Thread-1 (]: On model.datacore.meta_data_lineage: Close
[0m02:44:58.247297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a6aba840>]}
[0m02:44:58.247858 [info ] [Thread-1 (]: 1 of 18 OK created sql table model main_metadata.meta_data_lineage ............. [[32mOK[0m in 0.11s]
[0m02:44:58.248374 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_lineage
[0m02:44:58.248724 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m02:44:58.249195 [info ] [Thread-1 (]: 2 of 18 START sql table model main_metadata.meta_table_info .................... [RUN]
[0m02:44:58.249573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_lineage, now model.datacore.meta_table_info)
[0m02:44:58.249881 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m02:44:58.260459 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m02:44:58.261094 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m02:44:58.263616 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m02:44:58.264147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.264462 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m02:44:58.264753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.265508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.265809 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.266268 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m02:44:58.271040 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:44:58.272186 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.272520 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:44:58.273417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.274471 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.274787 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m02:44:58.275702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.278277 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.278618 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m02:44:58.279254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.281461 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.281784 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m02:44:58.282380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.283510 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:44:58.283835 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.284135 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m02:44:58.285598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.287456 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m02:44:58.287770 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m02:44:58.289084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.290212 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m02:44:58.290847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396cbf710>]}
[0m02:44:58.291371 [info ] [Thread-1 (]: 2 of 18 OK created sql table model main_metadata.meta_table_info ............... [[32mOK[0m in 0.04s]
[0m02:44:58.291868 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m02:44:58.292215 [debug] [Thread-1 (]: Began running node model.datacore.stg_payment_method_dict
[0m02:44:58.292694 [info ] [Thread-1 (]: 3 of 18 START sql view model main_staging.stg_payment_method_dict .............. [RUN]
[0m02:44:58.293052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_table_info, now model.datacore.stg_payment_method_dict)
[0m02:44:58.293372 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_payment_method_dict
[0m02:44:58.296094 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_payment_method_dict"
[0m02:44:58.296634 [debug] [Thread-1 (]: Began executing node model.datacore.stg_payment_method_dict
[0m02:44:58.312745 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_payment_method_dict"
[0m02:44:58.313413 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.313730 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: BEGIN
[0m02:44:58.314027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.314778 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.315078 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.315393 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

  
  create view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" as (
    -- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    payment_method_code,
    TRIM(payment_method_name) AS payment_method_name,
    TRIM(payment_method_desc) AS payment_method_desc,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."payment_method_dict"
  );

[0m02:44:58.316200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.318712 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.319045 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict" rename to "stg_payment_method_dict__dbt_backup"
[0m02:44:58.319706 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.321896 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.322226 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */
alter view "datacore"."main_staging"."stg_payment_method_dict__dbt_tmp" rename to "stg_payment_method_dict"
[0m02:44:58.322826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.323902 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:44:58.324236 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.324547 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: COMMIT
[0m02:44:58.325820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.329113 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_payment_method_dict"
[0m02:44:58.329477 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_payment_method_dict"} */

      drop view if exists "datacore"."main_staging"."stg_payment_method_dict__dbt_backup" cascade
    
[0m02:44:58.330813 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.331957 [debug] [Thread-1 (]: On model.datacore.stg_payment_method_dict: Close
[0m02:44:58.332503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334851c230>]}
[0m02:44:58.333015 [info ] [Thread-1 (]: 3 of 18 OK created sql view model main_staging.stg_payment_method_dict ......... [[32mOK[0m in 0.04s]
[0m02:44:58.333514 [debug] [Thread-1 (]: Finished running node model.datacore.stg_payment_method_dict
[0m02:44:58.333856 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_station
[0m02:44:58.334320 [info ] [Thread-1 (]: 4 of 18 START sql view model main_staging.stg_toll_station ..................... [RUN]
[0m02:44:58.334676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_payment_method_dict, now model.datacore.stg_toll_station)
[0m02:44:58.334983 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_station
[0m02:44:58.337727 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_station"
[0m02:44:58.338270 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_station
[0m02:44:58.340652 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_station"
[0m02:44:58.341147 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.341468 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: BEGIN
[0m02:44:58.341766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.342612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.342923 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.343239 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

  
  create view "datacore"."main_staging"."stg_toll_station__dbt_tmp" as (
    -- Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    station_id,
    TRIM(station_name) AS station_name,
    TRIM(city) AS city,
    TRIM(highway_code) AS highway_code,
    TRIM(station_type) AS station_type,
    open_date,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."toll_station"
  );

[0m02:44:58.344086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.346511 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.346846 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station" rename to "stg_toll_station__dbt_backup"
[0m02:44:58.347505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.349833 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.350202 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */
alter view "datacore"."main_staging"."stg_toll_station__dbt_tmp" rename to "stg_toll_station"
[0m02:44:58.350946 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.352087 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:44:58.352423 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.352725 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: COMMIT
[0m02:44:58.354112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.356025 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_station"
[0m02:44:58.356352 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_station"} */

      drop view if exists "datacore"."main_staging"."stg_toll_station__dbt_backup" cascade
    
[0m02:44:58.357609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.358710 [debug] [Thread-1 (]: On model.datacore.stg_toll_station: Close
[0m02:44:58.359464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348503410>]}
[0m02:44:58.359978 [info ] [Thread-1 (]: 4 of 18 OK created sql view model main_staging.stg_toll_station ................ [[32mOK[0m in 0.02s]
[0m02:44:58.360475 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_station
[0m02:44:58.360821 [debug] [Thread-1 (]: Began running node model.datacore.stg_toll_transaction
[0m02:44:58.361294 [info ] [Thread-1 (]: 5 of 18 START sql view model main_staging.stg_toll_transaction ................. [RUN]
[0m02:44:58.361812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_station, now model.datacore.stg_toll_transaction)
[0m02:44:58.362123 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_toll_transaction
[0m02:44:58.365283 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_toll_transaction"
[0m02:44:58.365824 [debug] [Thread-1 (]: Began executing node model.datacore.stg_toll_transaction
[0m02:44:58.368247 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_toll_transaction"
[0m02:44:58.368783 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.369098 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: BEGIN
[0m02:44:58.369401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.370137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.370459 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.370852 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

  
  create view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" as (
    -- Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç
-- ÂäüËÉΩÔºöÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñ„ÄÅÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ



WITH raw_data AS (
    SELECT 
        transaction_id,
        station_id,
        lane_id,
        vehicle_plate,
        vehicle_type_code,
        entry_station_id,
        entry_time,
        exit_time,
        payment_method_code,
        toll_amount,
        actual_amount,
        discount_amount,
        transaction_status,
        create_time,
        update_time
    FROM "datacore"."raw"."toll_transaction"
),

cleaned_data AS (
    SELECT 
        -- ‰∏ªÈîÆ
        transaction_id,
        
        -- Êî∂Ë¥πÁ´ô‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        COALESCE(station_id, 'UNKNOWN') AS station_id,
        COALESCE(lane_id, 'UNKNOWN') AS lane_id,
        COALESCE(entry_station_id, 'UNKNOWN') AS entry_station_id,
        
        -- ËΩ¶ËæÜ‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÔºâ
        UPPER(TRIM(COALESCE(vehicle_plate, ''))) AS vehicle_plate,
        COALESCE(vehicle_type_code, 'V01') AS vehicle_type_code,
        
        -- Êó∂Èó¥‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        entry_time,
        exit_time,
        CASE 
            WHEN exit_time < entry_time THEN entry_time + INTERVAL 1 HOUR
            ELSE exit_time
        END AS exit_time_cleaned,
        
        -- ËÆ°ÁÆóÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ
        CAST(EXTRACT(EPOCH FROM (exit_time - entry_time)) AS INTEGER) / 60 AS travel_minutes,
        
        -- ÊîØ‰ªò‰ø°ÊÅØ
        COALESCE(payment_method_code, 'P02') AS payment_method_code,
        
        -- ÈáëÈ¢ù‰ø°ÊÅØÔºàÊ∏ÖÊ¥óÂíåÈ™åËØÅÔºâ
        COALESCE(toll_amount, 0) AS toll_amount,
        COALESCE(actual_amount, 0) AS actual_amount,
        COALESCE(discount_amount, 0) AS discount_amount,
        
        -- ÈáëÈ¢ùÂêàÁêÜÊÄßÊ£ÄÊü•
        CASE 
            WHEN actual_amount < 0 THEN 0
            WHEN actual_amount > toll_amount THEN toll_amount
            ELSE actual_amount
        END AS actual_amount_cleaned,
        
        -- ‰∫§ÊòìÁä∂ÊÄÅ
        COALESCE(transaction_status, 'Ê≠£Â∏∏') AS transaction_status,
        
        -- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞
        CASE 
            WHEN transaction_id IS NULL THEN 'Êï∞ÊçÆÁº∫Â§±'
            WHEN station_id = 'UNKNOWN' THEN 'Êî∂Ë¥πÁ´ôÁº∫Â§±'
            WHEN vehicle_plate = '' THEN 'ËΩ¶ÁâåÁº∫Â§±'
            WHEN exit_time < entry_time THEN 'Êó∂Èó¥ÂºÇÂ∏∏'
            WHEN actual_amount < 0 OR actual_amount > toll_amount THEN 'ÈáëÈ¢ùÂºÇÂ∏∏'
            ELSE 'Ê≠£Â∏∏'
        END AS data_quality_flag,
        
        -- ÂÖÉÊï∞ÊçÆ
        create_time,
        COALESCE(update_time, create_time) AS update_time,
        CURRENT_TIMESTAMP AS etl_time
        
    FROM raw_data
)

SELECT 
    transaction_id,
    station_id,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    entry_station_id,
    entry_time,
    exit_time_cleaned AS exit_time,
    travel_minutes,
    payment_method_code,
    toll_amount,
    actual_amount_cleaned AS actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    create_time,
    update_time,
    etl_time
FROM cleaned_data
  );

[0m02:44:58.372732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.375247 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.375587 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction" rename to "stg_toll_transaction__dbt_backup"
[0m02:44:58.376331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.378544 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.378867 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */
alter view "datacore"."main_staging"."stg_toll_transaction__dbt_tmp" rename to "stg_toll_transaction"
[0m02:44:58.379586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.380868 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:44:58.381223 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.381558 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: COMMIT
[0m02:44:58.383290 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.386986 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_toll_transaction"
[0m02:44:58.387370 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_toll_transaction"} */

      drop view if exists "datacore"."main_staging"."stg_toll_transaction__dbt_backup" cascade
    
[0m02:44:58.388812 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.390046 [debug] [Thread-1 (]: On model.datacore.stg_toll_transaction: Close
[0m02:44:58.390652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348551880>]}
[0m02:44:58.391226 [info ] [Thread-1 (]: 5 of 18 OK created sql view model main_staging.stg_toll_transaction ............ [[32mOK[0m in 0.03s]
[0m02:44:58.391773 [debug] [Thread-1 (]: Finished running node model.datacore.stg_toll_transaction
[0m02:44:58.392148 [debug] [Thread-1 (]: Began running node model.datacore.stg_vehicle_type_dict
[0m02:44:58.392648 [info ] [Thread-1 (]: 6 of 18 START sql view model main_staging.stg_vehicle_type_dict ................ [RUN]
[0m02:44:58.393029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_toll_transaction, now model.datacore.stg_vehicle_type_dict)
[0m02:44:58.393391 [debug] [Thread-1 (]: Began compiling node model.datacore.stg_vehicle_type_dict
[0m02:44:58.396408 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.396974 [debug] [Thread-1 (]: Began executing node model.datacore.stg_vehicle_type_dict
[0m02:44:58.399650 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.400190 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.400540 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: BEGIN
[0m02:44:58.400869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.401726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.402061 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.402418 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

  
  create view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" as (
    -- ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç



SELECT 
    vehicle_type_code,
    TRIM(vehicle_type_name) AS vehicle_type_name,
    TRIM(vehicle_type_desc) AS vehicle_type_desc,
    toll_rate_multiplier,
    CURRENT_TIMESTAMP AS etl_time
FROM "datacore"."raw"."vehicle_type_dict"
  );

[0m02:44:58.403326 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.406088 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.406455 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict" rename to "stg_vehicle_type_dict__dbt_backup"
[0m02:44:58.407144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.409658 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.410021 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */
alter view "datacore"."main_staging"."stg_vehicle_type_dict__dbt_tmp" rename to "stg_vehicle_type_dict"
[0m02:44:58.410711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.411871 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:44:58.412218 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.412550 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: COMMIT
[0m02:44:58.414295 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.416179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.stg_vehicle_type_dict"
[0m02:44:58.416509 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.stg_vehicle_type_dict"} */

      drop view if exists "datacore"."main_staging"."stg_vehicle_type_dict__dbt_backup" cascade
    
[0m02:44:58.418438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:44:58.419667 [debug] [Thread-1 (]: On model.datacore.stg_vehicle_type_dict: Close
[0m02:44:58.420253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334af403b0>]}
[0m02:44:58.420823 [info ] [Thread-1 (]: 6 of 18 OK created sql view model main_staging.stg_vehicle_type_dict ........... [[32mOK[0m in 0.03s]
[0m02:44:58.421371 [debug] [Thread-1 (]: Finished running node model.datacore.stg_vehicle_type_dict
[0m02:44:58.421754 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_station
[0m02:44:58.422399 [info ] [Thread-1 (]: 7 of 18 START sql table model main_ods.ods_toll_station ........................ [RUN]
[0m02:44:58.422812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.stg_vehicle_type_dict, now model.datacore.ods_toll_station)
[0m02:44:58.423148 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_station
[0m02:44:58.426221 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_station"
[0m02:44:58.426791 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_station
[0m02:44:58.429430 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_station"
[0m02:44:58.429965 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.430311 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: BEGIN
[0m02:44:58.430636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.431471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.431798 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.432141 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_station__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®



SELECT 
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    open_date,
    -- ‰∏öÂä°Â≠óÊÆµ
    CASE 
        WHEN station_type = '‰∏ªÁ∫øÊî∂Ë¥πÁ´ô' THEN 1
        ELSE 0
    END AS is_main_station,
    CURRENT_DATE - open_date AS days_since_open,
    etl_time
FROM "datacore"."main_staging"."stg_toll_station"
    );
  
  
[0m02:44:58.434397 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:44:58.435467 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.435812 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:44:58.436736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.437889 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.438239 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_station'
  
[0m02:44:58.439173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.442016 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.442395 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station" rename to "ods_toll_station__dbt_backup"
[0m02:44:58.443097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.445549 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.445904 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */
alter table "datacore"."main_ods"."ods_toll_station__dbt_tmp" rename to "ods_toll_station"
[0m02:44:58.446541 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.447769 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:44:58.448118 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.448461 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: COMMIT
[0m02:44:58.449835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.451873 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_station"
[0m02:44:58.452233 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_station"} */

      drop table if exists "datacore"."main_ods"."ods_toll_station__dbt_backup" cascade
    
[0m02:44:58.453688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.454956 [debug] [Thread-1 (]: On model.datacore.ods_toll_station: Close
[0m02:44:58.455610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33485027b0>]}
[0m02:44:58.456172 [info ] [Thread-1 (]: 7 of 18 OK created sql table model main_ods.ods_toll_station ................... [[32mOK[0m in 0.03s]
[0m02:44:58.456719 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_station
[0m02:44:58.457100 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_dictionary
[0m02:44:58.457594 [info ] [Thread-1 (]: 8 of 18 START sql table model main_metadata.meta_data_dictionary ............... [RUN]
[0m02:44:58.457987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_station, now model.datacore.meta_data_dictionary)
[0m02:44:58.458335 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_dictionary
[0m02:44:58.463490 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_dictionary"
[0m02:44:58.464119 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_dictionary
[0m02:44:58.466801 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_dictionary"
[0m02:44:58.467351 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.467694 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: BEGIN
[0m02:44:58.468028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.468827 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.469161 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.469567 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆÂ≠óÂÖ∏Ë°®
-- ÂäüËÉΩÔºöÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏



-- ËΩ¶ÂûãÂ≠óÂÖ∏
SELECT 
    'vehicle_type' AS dict_type,
    vehicle_type_code AS dict_code,
    vehicle_type_name AS dict_name,
    vehicle_type_desc AS dict_desc,
    toll_rate_multiplier AS dict_value,
    'Êî∂Ë¥πÊîøÁ≠ñ' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_vehicle_type_dict"
UNION ALL
-- ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏
SELECT 
    'payment_method' AS dict_type,
    payment_method_code AS dict_code,
    payment_method_name AS dict_name,
    payment_method_desc AS dict_desc,
    NULL AS dict_value,
    'ÊîØ‰ªòÁ≥ªÁªü' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM "datacore"."main_staging"."stg_payment_method_dict"
UNION ALL
-- ‰∫§ÊòìÁä∂ÊÄÅÂ≠óÂÖ∏
SELECT 
    'transaction_status' AS dict_type,
    status_code AS dict_code,
    status_name AS dict_name,
    status_desc AS dict_desc,
    NULL AS dict_value,
    '‰∏öÂä°ËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS status_code, 'Ê≠£Â∏∏' AS status_name, 'Ê≠£Â∏∏‰∫§Êòì' AS status_desc
    UNION ALL SELECT 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏', 'ÂºÇÂ∏∏‰∫§Êòì'
    UNION ALL SELECT 'ÈÄÉË¥π', 'ÈÄÉË¥π', 'ÈÄÉË¥π‰∫§Êòì'
    UNION ALL SELECT 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöú', 'ËÆæÂ§áÊïÖÈöúÂØºËá¥'
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±'
) AS status_dict
UNION ALL
-- Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞Â≠óÂÖ∏
SELECT 
    'data_quality_flag' AS dict_type,
    flag_code AS dict_code,
    flag_name AS dict_name,
    flag_desc AS dict_desc,
    NULL AS dict_value,
    'Êï∞ÊçÆË¥®ÈáèËßÑÂàô' AS dict_source,
    CURRENT_TIMESTAMP AS create_time
FROM (
    SELECT 'Ê≠£Â∏∏' AS flag_code, 'Ê≠£Â∏∏' AS flag_name, 'Êï∞ÊçÆË¥®ÈáèÊ≠£Â∏∏' AS flag_desc
    UNION ALL SELECT 'Êï∞ÊçÆÁº∫Â§±', 'Êï∞ÊçÆÁº∫Â§±', 'ÂÖ≥ÈîÆÂ≠óÊÆµÁº∫Â§±'
    UNION ALL SELECT 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ôÁº∫Â§±', 'Êî∂Ë¥πÁ´ô‰ø°ÊÅØÁº∫Â§±'
    UNION ALL SELECT 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÁº∫Â§±', 'ËΩ¶ÁâåÂè∑Áº∫Â§±'
    UNION ALL SELECT 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÂºÇÂ∏∏', 'Êó∂Èó¥ÈÄªËæëÂºÇÂ∏∏'
    UNION ALL SELECT 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÂºÇÂ∏∏', 'ÈáëÈ¢ùÈÄªËæëÂºÇÂ∏∏'
) AS quality_dict
    );
  
  
[0m02:44:58.473885 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:44:58.475002 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.475368 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:44:58.476331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.477490 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.477846 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_dictionary'
  
[0m02:44:58.478788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.481669 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.482031 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary" rename to "meta_data_dictionary__dbt_backup"
[0m02:44:58.482724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.485155 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.485508 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */
alter table "datacore"."main_metadata"."meta_data_dictionary__dbt_tmp" rename to "meta_data_dictionary"
[0m02:44:58.486138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.487366 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:44:58.487736 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.488066 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: COMMIT
[0m02:44:58.489543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.491600 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_dictionary"
[0m02:44:58.491952 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_dictionary"} */

      drop table if exists "datacore"."main_metadata"."meta_data_dictionary__dbt_backup" cascade
    
[0m02:44:58.493341 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.494547 [debug] [Thread-1 (]: On model.datacore.meta_data_dictionary: Close
[0m02:44:58.495410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e33a8727260>]}
[0m02:44:58.495966 [info ] [Thread-1 (]: 8 of 18 OK created sql table model main_metadata.meta_data_dictionary .......... [[32mOK[0m in 0.04s]
[0m02:44:58.496506 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_dictionary
[0m02:44:58.496891 [debug] [Thread-1 (]: Began running node model.datacore.ods_toll_transaction
[0m02:44:58.497376 [info ] [Thread-1 (]: 9 of 18 START sql table model main_ods.ods_toll_transaction .................... [RUN]
[0m02:44:58.497765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_dictionary, now model.datacore.ods_toll_transaction)
[0m02:44:58.498113 [debug] [Thread-1 (]: Began compiling node model.datacore.ods_toll_transaction
[0m02:44:58.502287 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ods_toll_transaction"
[0m02:44:58.502905 [debug] [Thread-1 (]: Began executing node model.datacore.ods_toll_transaction
[0m02:44:58.505614 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ods_toll_transaction"
[0m02:44:58.506155 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.506508 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: BEGIN
[0m02:44:58.506841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:58.507664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.508001 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.508397 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

  
    
    

    create  table
      "datacore"."main_ods"."ods_toll_transaction__dbt_tmp"
  
    as (
      -- ODSÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®
-- ÂäüËÉΩÔºö‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ



SELECT 
    t.transaction_id,
    t.station_id,
    s.station_name,
    s.city,
    s.highway_code,
    s.station_type,
    t.lane_id,
    t.vehicle_plate,
    t.vehicle_type_code,
    vt.vehicle_type_name,
    vt.vehicle_type_desc,
    t.entry_station_id,
    es.station_name AS entry_station_name,
    t.entry_time,
    t.exit_time,
    t.travel_minutes,
    t.payment_method_code,
    pm.payment_method_name,
    pm.payment_method_desc,
    t.toll_amount,
    t.actual_amount,
    t.discount_amount,
    t.transaction_status,
    t.data_quality_flag,
    -- ‰∏öÂä°Â≠óÊÆµ
    DATE(t.exit_time) AS transaction_date,
    EXTRACT(HOUR FROM t.exit_time) AS transaction_hour,
    EXTRACT(DOW FROM t.exit_time) AS day_of_week,
    CASE 
        WHEN t.transaction_status = 'Ê≠£Â∏∏' THEN 1 
        ELSE 0 
    END AS is_normal_transaction,
    t.create_time,
    t.update_time,
    t.etl_time
FROM "datacore"."main_staging"."stg_toll_transaction" t
LEFT JOIN "datacore"."main_staging"."stg_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_toll_station" es ON t.entry_station_id = es.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
    );
  
  
[0m02:44:58.720297 [debug] [Thread-1 (]: SQL status: OK in 0.211 seconds
[0m02:44:58.721588 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.721923 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m02:44:58.723005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.724104 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.724600 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ods'
      AND table_name = 'ods_toll_transaction'
  
[0m02:44:58.725544 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:58.728159 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.728506 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction" rename to "ods_toll_transaction__dbt_backup"
[0m02:44:58.729319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.731594 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.731923 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */
alter table "datacore"."main_ods"."ods_toll_transaction__dbt_tmp" rename to "ods_toll_transaction"
[0m02:44:58.732578 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:58.733723 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:44:58.734052 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:58.734364 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: COMMIT
[0m02:44:59.007292 [debug] [Thread-1 (]: SQL status: OK in 0.272 seconds
[0m02:44:59.009618 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ods_toll_transaction"
[0m02:44:59.009955 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ods_toll_transaction"} */

      drop table if exists "datacore"."main_ods"."ods_toll_transaction__dbt_backup" cascade
    
[0m02:44:59.011732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.012958 [debug] [Thread-1 (]: On model.datacore.ods_toll_transaction: Close
[0m02:44:59.022446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348502db0>]}
[0m02:44:59.023096 [info ] [Thread-1 (]: 9 of 18 OK created sql table model main_ods.ods_toll_transaction ............... [[32mOK[0m in 0.52s]
[0m02:44:59.023612 [debug] [Thread-1 (]: Finished running node model.datacore.ods_toll_transaction
[0m02:44:59.024581 [debug] [Thread-1 (]: Began running node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.024991 [info ] [Thread-1 (]: 10 of 18 START sql table model main_dwd.dwd_toll_transaction_detail ............ [RUN]
[0m02:44:59.025379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ods_toll_transaction, now model.datacore.dwd_toll_transaction_detail)
[0m02:44:59.025698 [debug] [Thread-1 (]: Began compiling node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.030508 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.031126 [debug] [Thread-1 (]: Began executing node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.033648 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.034195 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.034536 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: BEGIN
[0m02:44:59.034850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.035664 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.035974 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.036330 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

  
    
    

    create  table
      "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp"
  
    as (
      -- DWDÂ±ÇÔºöÊî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆ
-- ÂäüËÉΩÔºö‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÔºå‰æø‰∫éÂêéÁª≠ÂàÜÊûê



SELECT 
    transaction_id,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    lane_id,
    vehicle_plate,
    vehicle_type_code,
    vehicle_type_name,
    vehicle_type_desc,
    entry_station_id,
    entry_station_name,
    entry_time,
    exit_time,
    travel_minutes,
    -- ËÆ°ÁÆóÈÄöË°åË∑ùÁ¶ªÔºà‰º∞ÁÆóÔºåÂü∫‰∫éÊó∂Èó¥Ôºâ
    CASE 
        WHEN travel_minutes > 0 THEN 
            ROUND(travel_minutes * 60 / 100.0, 2)  -- ÂÅáËÆæÂπ≥ÂùáÈÄüÂ∫¶100km/h
        ELSE 0
    END AS estimated_distance_km,
    payment_method_code,
    payment_method_name,
    payment_method_desc,
    toll_amount,
    actual_amount,
    discount_amount,
    transaction_status,
    data_quality_flag,
    transaction_date,
    transaction_hour,
    day_of_week,
    is_normal_transaction,
    -- ‰∏öÂä°ÂàÜÁ±ª
    CASE 
        WHEN transaction_hour BETWEEN 6 AND 9 THEN 'Êó©È´òÂ≥∞'
        WHEN transaction_hour BETWEEN 17 AND 20 THEN 'ÊôöÈ´òÂ≥∞'
        WHEN transaction_hour BETWEEN 22 AND 6 THEN 'Â§úÈó¥'
        ELSE 'Âπ≥Â≥∞'
    END AS time_period,
    CASE 
        WHEN day_of_week IN (0, 6) THEN 'Âë®Êú´'  -- DOW: 0=Âë®Êó•, 6=Âë®ÂÖ≠
        ELSE 'Â∑•‰ΩúÊó•'
    END AS day_type,
    create_time,
    update_time,
    etl_time
FROM "datacore"."main_ods"."ods_toll_transaction"
    );
  
  
[0m02:44:59.255749 [debug] [Thread-1 (]: SQL status: OK in 0.219 seconds
[0m02:44:59.257520 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.257859 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m02:44:59.259255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.260432 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.260767 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dwd'
      AND table_name = 'dwd_toll_transaction_detail'
  
[0m02:44:59.261762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.264817 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.265178 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail" rename to "dwd_toll_transaction_detail__dbt_backup"
[0m02:44:59.265939 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.268285 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.268627 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */
alter table "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_tmp" rename to "dwd_toll_transaction_detail"
[0m02:44:59.269297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.270532 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:44:59.270866 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.271176 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: COMMIT
[0m02:44:59.541055 [debug] [Thread-1 (]: SQL status: OK in 0.269 seconds
[0m02:44:59.543451 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dwd_toll_transaction_detail"
[0m02:44:59.543791 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dwd_toll_transaction_detail"} */

      drop table if exists "datacore"."main_dwd"."dwd_toll_transaction_detail__dbt_backup" cascade
    
[0m02:44:59.545453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.546829 [debug] [Thread-1 (]: On model.datacore.dwd_toll_transaction_detail: Close
[0m02:44:59.554954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334afb61b0>]}
[0m02:44:59.555842 [info ] [Thread-1 (]: 10 of 18 OK created sql table model main_dwd.dwd_toll_transaction_detail ....... [[32mOK[0m in 0.53s]
[0m02:44:59.556425 [debug] [Thread-1 (]: Finished running node model.datacore.dwd_toll_transaction_detail
[0m02:44:59.557886 [debug] [Thread-1 (]: Began running node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.558299 [info ] [Thread-1 (]: 11 of 18 START sql table model main_ads.ads_quality_monitoring_dashboard ....... [RUN]
[0m02:44:59.558732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dwd_toll_transaction_detail, now model.datacore.ads_quality_monitoring_dashboard)
[0m02:44:59.559087 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.562939 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.563579 [debug] [Thread-1 (]: Began executing node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.566256 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.566842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.567170 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: BEGIN
[0m02:44:59.567512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.568392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.568708 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.569090 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø
-- ÂäüËÉΩÔºöÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶



SELECT 
    transaction_date,
    -- ÊÄª‰ΩìË¥®ÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transactions,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal,
    -- Ë¥®ÈáèÁéá
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÂºÇÂ∏∏Á±ªÂûãÂàÜÂ∏É
    SUM(CASE WHEN transaction_status = 'ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS status_abnormal_count,
    SUM(CASE WHEN transaction_status = 'ÈÄÉË¥π' THEN 1 ELSE 0 END) AS status_evasion_count,
    SUM(CASE WHEN transaction_status = 'ËÆæÂ§áÊïÖÈöú' THEN 1 ELSE 0 END) AS status_equipment_failure_count,
    SUM(CASE WHEN transaction_status = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS status_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êï∞ÊçÆÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êî∂Ë¥πÁ´ôÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_station_missing_count,
    SUM(CASE WHEN data_quality_flag = 'ËΩ¶ÁâåÁº∫Â§±' THEN 1 ELSE 0 END) AS quality_plate_missing_count,
    SUM(CASE WHEN data_quality_flag = 'Êó∂Èó¥ÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_time_abnormal_count,
    SUM(CASE WHEN data_quality_flag = 'ÈáëÈ¢ùÂºÇÂ∏∏' THEN 1 ELSE 0 END) AS quality_amount_abnormal_count,
    -- ÂëäË≠¶Ê†áËÆ∞
    CASE 
        WHEN SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 90 THEN 'ÂëäË≠¶'
        WHEN SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) < 95 THEN 'ÂëäË≠¶'
        ELSE 'Ê≠£Â∏∏'
    END AS alert_status,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:44:59.579221 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m02:44:59.580384 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.580722 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m02:44:59.581734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.582842 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.583175 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_quality_monitoring_dashboard'
  
[0m02:44:59.584372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.586997 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.587352 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard" rename to "ads_quality_monitoring_dashboard__dbt_backup"
[0m02:44:59.588160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.590440 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.590774 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */
alter table "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_tmp" rename to "ads_quality_monitoring_dashboard"
[0m02:44:59.591419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.592558 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:44:59.592891 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.593199 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: COMMIT
[0m02:44:59.594817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.596746 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_quality_monitoring_dashboard"
[0m02:44:59.597076 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_quality_monitoring_dashboard"} */

      drop table if exists "datacore"."main_ads"."ads_quality_monitoring_dashboard__dbt_backup" cascade
    
[0m02:44:59.598465 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.599646 [debug] [Thread-1 (]: On model.datacore.ads_quality_monitoring_dashboard: Close
[0m02:44:59.600625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396bb4b60>]}
[0m02:44:59.601174 [info ] [Thread-1 (]: 11 of 18 OK created sql table model main_ads.ads_quality_monitoring_dashboard .. [[32mOK[0m in 0.04s]
[0m02:44:59.601685 [debug] [Thread-1 (]: Finished running node model.datacore.ads_quality_monitoring_dashboard
[0m02:44:59.602041 [debug] [Thread-1 (]: Began running node model.datacore.dws_station_performance_daily
[0m02:44:59.602525 [info ] [Thread-1 (]: 12 of 18 START sql table model main_dws.dws_station_performance_daily .......... [RUN]
[0m02:44:59.602889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_quality_monitoring_dashboard, now model.datacore.dws_station_performance_daily)
[0m02:44:59.603206 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_station_performance_daily
[0m02:44:59.607875 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_station_performance_daily"
[0m02:44:59.608471 [debug] [Thread-1 (]: Began executing node model.datacore.dws_station_performance_daily
[0m02:44:59.610978 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_station_performance_daily"
[0m02:44:59.611535 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.611859 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: BEGIN
[0m02:44:59.612171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.613069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.613386 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.613737 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄª
-- ÂäüËÉΩÔºöÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    -- ‰∫§ÊòìÈáèÊåáÊ†á
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    COUNT(DISTINCT lane_id) AS active_lanes,
    -- Êî∂ÂÖ•ÊåáÊ†á
    SUM(actual_amount) AS total_revenue,
    AVG(actual_amount) AS avg_revenue_per_transaction,
    -- ÊïàÁéáÊåáÊ†á
    AVG(travel_minutes) AS avg_processing_time_minutes,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS normal_rate,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS data_quality_rate,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS etc_rate,
    -- È´òÂ≥∞Êó∂ÊÆµÂç†ÊØî
    SUM(CASE WHEN time_period IN ('Êó©È´òÂ≥∞', 'ÊôöÈ´òÂ≥∞') THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS peak_hour_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type
    );
  
  
[0m02:44:59.673476 [debug] [Thread-1 (]: SQL status: OK in 0.059 seconds
[0m02:44:59.674907 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.675286 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m02:44:59.676577 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.678015 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.678409 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_station_performance_daily'
  
[0m02:44:59.679634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.682745 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.683145 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily" rename to "dws_station_performance_daily__dbt_backup"
[0m02:44:59.683973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.686621 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.686997 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */
alter table "datacore"."main_dws"."dws_station_performance_daily__dbt_tmp" rename to "dws_station_performance_daily"
[0m02:44:59.687728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.689026 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:44:59.689406 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.689749 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: COMMIT
[0m02:44:59.692898 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:44:59.695287 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_station_performance_daily"
[0m02:44:59.695667 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_station_performance_daily"} */

      drop table if exists "datacore"."main_dws"."dws_station_performance_daily__dbt_backup" cascade
    
[0m02:44:59.697177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.698526 [debug] [Thread-1 (]: On model.datacore.dws_station_performance_daily: Close
[0m02:44:59.708151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348585580>]}
[0m02:44:59.708972 [info ] [Thread-1 (]: 12 of 18 OK created sql table model main_dws.dws_station_performance_daily ..... [[32mOK[0m in 0.11s]
[0m02:44:59.709543 [debug] [Thread-1 (]: Finished running node model.datacore.dws_station_performance_daily
[0m02:44:59.709941 [debug] [Thread-1 (]: Began running node model.datacore.dws_toll_revenue_daily
[0m02:44:59.710576 [info ] [Thread-1 (]: 13 of 18 START sql table model main_dws.dws_toll_revenue_daily ................. [RUN]
[0m02:44:59.711015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_station_performance_daily, now model.datacore.dws_toll_revenue_daily)
[0m02:44:59.711381 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_toll_revenue_daily
[0m02:44:59.715035 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.715665 [debug] [Thread-1 (]: Began executing node model.datacore.dws_toll_revenue_daily
[0m02:44:59.718443 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.719037 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.719403 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: BEGIN
[0m02:44:59.719739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.720636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.720972 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.721375 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name,
    -- Ê±áÊÄªÊåáÊ†á
    COUNT(*) AS transaction_count,
    COUNT(DISTINCT vehicle_plate) AS vehicle_count,
    SUM(toll_amount) AS total_toll_amount,
    SUM(actual_amount) AS total_actual_amount,
    SUM(discount_amount) AS total_discount_amount,
    AVG(actual_amount) AS avg_transaction_amount,
    MAX(actual_amount) AS max_transaction_amount,
    MIN(actual_amount) AS min_transaction_amount,
    -- Ê≠£Â∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transaction_count,
    SUM(CASE WHEN is_normal_transaction = 1 THEN actual_amount ELSE 0 END) AS normal_transaction_amount,
    -- ÂºÇÂ∏∏‰∫§ÊòìÁªüËÆ°
    SUM(CASE WHEN is_normal_transaction = 0 THEN 1 ELSE 0 END) AS abnormal_transaction_count,
    -- Êï∞ÊçÆË¥®ÈáèÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_normal_count,
    SUM(CASE WHEN data_quality_flag != 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS quality_abnormal_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    vehicle_type_code,
    vehicle_type_name,
    payment_method_code,
    payment_method_name
    );
  
  
[0m02:44:59.817009 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m02:44:59.818327 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.818659 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m02:44:59.819762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.820856 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.821181 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_toll_revenue_daily'
  
[0m02:44:59.822131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.824882 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.825225 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily" rename to "dws_toll_revenue_daily__dbt_backup"
[0m02:44:59.826077 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.828390 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.828720 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */
alter table "datacore"."main_dws"."dws_toll_revenue_daily__dbt_tmp" rename to "dws_toll_revenue_daily"
[0m02:44:59.829361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.830541 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:44:59.830871 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.831179 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: COMMIT
[0m02:44:59.843477 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m02:44:59.845778 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_toll_revenue_daily"
[0m02:44:59.846105 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_toll_revenue_daily"} */

      drop table if exists "datacore"."main_dws"."dws_toll_revenue_daily__dbt_backup" cascade
    
[0m02:44:59.847563 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.848777 [debug] [Thread-1 (]: On model.datacore.dws_toll_revenue_daily: Close
[0m02:44:59.862938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396f02870>]}
[0m02:44:59.863709 [info ] [Thread-1 (]: 13 of 18 OK created sql table model main_dws.dws_toll_revenue_daily ............ [[32mOK[0m in 0.15s]
[0m02:44:59.864220 [debug] [Thread-1 (]: Finished running node model.datacore.dws_toll_revenue_daily
[0m02:44:59.864581 [debug] [Thread-1 (]: Began running node model.datacore.dws_traffic_flow_daily
[0m02:44:59.865234 [info ] [Thread-1 (]: 14 of 18 START sql table model main_dws.dws_traffic_flow_daily ................. [RUN]
[0m02:44:59.865636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_toll_revenue_daily, now model.datacore.dws_traffic_flow_daily)
[0m02:44:59.865965 [debug] [Thread-1 (]: Began compiling node model.datacore.dws_traffic_flow_daily
[0m02:44:59.870660 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.871257 [debug] [Thread-1 (]: Began executing node model.datacore.dws_traffic_flow_daily
[0m02:44:59.873713 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.874233 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.874566 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: BEGIN
[0m02:44:59.874874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.875839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.876148 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.876504 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

  
    
    

    create  table
      "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp"
  
    as (
      -- DWSÂ±ÇÔºöÊó•ËΩ¶ÊµÅÈáèÊ±áÊÄª
-- ÂäüËÉΩÔºöÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè



SELECT 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type,
    -- ËΩ¶ÊµÅÈáèÊåáÊ†á
    COUNT(*) AS total_vehicles,
    COUNT(DISTINCT vehicle_plate) AS unique_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' THEN 1 ELSE 0 END) AS passenger_vehicle_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code != 'V01' THEN 1 ELSE 0 END) AS bus_count,
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code >= 'V05' THEN 1 ELSE 0 END) AS truck_count,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(travel_minutes) AS avg_travel_minutes,
    -- ÊîØ‰ªòÊñπÂºèÂàÜÂ∏É
    SUM(CASE WHEN payment_method_code = 'P01' THEN 1 ELSE 0 END) AS etc_count,
    SUM(CASE WHEN payment_method_code != 'P01' THEN 1 ELSE 0 END) AS non_etc_count,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(etl_time) AS last_update_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY 
    transaction_date,
    station_id,
    station_name,
    city,
    highway_code,
    station_type,
    time_period,
    day_type
    );
  
  
[0m02:44:59.932496 [debug] [Thread-1 (]: SQL status: OK in 0.055 seconds
[0m02:44:59.933821 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.934174 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m02:44:59.935339 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.936478 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.936950 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_dws'
      AND table_name = 'dws_traffic_flow_daily'
  
[0m02:44:59.937989 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.940844 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.941230 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily" rename to "dws_traffic_flow_daily__dbt_backup"
[0m02:44:59.942318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.944865 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.945206 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */
alter table "datacore"."main_dws"."dws_traffic_flow_daily__dbt_tmp" rename to "dws_traffic_flow_daily"
[0m02:44:59.945962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:44:59.947111 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:44:59.947445 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.947746 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: COMMIT
[0m02:44:59.951439 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:44:59.953569 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.dws_traffic_flow_daily"
[0m02:44:59.953899 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.dws_traffic_flow_daily"} */

      drop table if exists "datacore"."main_dws"."dws_traffic_flow_daily__dbt_backup" cascade
    
[0m02:44:59.955247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.956460 [debug] [Thread-1 (]: On model.datacore.dws_traffic_flow_daily: Close
[0m02:44:59.967310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334857e9c0>]}
[0m02:44:59.968044 [info ] [Thread-1 (]: 14 of 18 OK created sql table model main_dws.dws_traffic_flow_daily ............ [[32mOK[0m in 0.10s]
[0m02:44:59.968647 [debug] [Thread-1 (]: Finished running node model.datacore.dws_traffic_flow_daily
[0m02:44:59.969038 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_quality_metrics
[0m02:44:59.969640 [info ] [Thread-1 (]: 15 of 18 START sql table model main_metadata.meta_data_quality_metrics ......... [RUN]
[0m02:44:59.970191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.dws_traffic_flow_daily, now model.datacore.meta_data_quality_metrics)
[0m02:44:59.970549 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_quality_metrics
[0m02:44:59.974144 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_quality_metrics"
[0m02:44:59.974766 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_quality_metrics
[0m02:44:59.977658 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_quality_metrics"
[0m02:44:59.978260 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.978623 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: BEGIN
[0m02:44:59.978957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:59.979941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.980276 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.980702 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®
-- ÂäüËÉΩÔºöËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø



SELECT 
    transaction_date AS metric_date,
    'dwd_toll_transaction_detail' AS table_name,
    -- ÂÆåÊï¥ÊÄßÊåáÊ†á
    COUNT(*) AS total_records,
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_transaction_id,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) AS complete_station_id,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) AS complete_vehicle_plate,
    -- ÂÆåÊï¥ÊÄßÁéá
    SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS transaction_id_completeness_rate,
    SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS station_id_completeness_rate,
    SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS vehicle_plate_completeness_rate,
    -- ÂáÜÁ°ÆÊÄßÊåáÊ†á
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) AS normal_transactions,
    SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS accuracy_rate,
    -- ‰∏ÄËá¥ÊÄßÊåáÊ†á
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) AS consistent_records,
    SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS consistency_rate,
    -- ÂèäÊó∂ÊÄßÊåáÊ†á
    MAX(etl_time) AS last_etl_time,
    CURRENT_TIMESTAMP - MAX(etl_time) AS etl_delay,
    -- ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ
    (
        (SUM(CASE WHEN transaction_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN station_id IS NOT NULL THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN vehicle_plate IS NOT NULL AND vehicle_plate != '' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN is_normal_transaction = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2 +
        (SUM(CASE WHEN data_quality_flag = 'Ê≠£Â∏∏' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) * 0.2
    ) AS overall_quality_score,
    CURRENT_TIMESTAMP AS metric_time
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
GROUP BY transaction_date
    );
  
  
[0m02:44:59.992906 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m02:44:59.994079 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.994416 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:44:59.995447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:44:59.996539 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:44:59.996867 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_quality_metrics'
  
[0m02:44:59.997785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.000553 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.000901 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics" rename to "meta_data_quality_metrics__dbt_backup"
[0m02:45:00.001711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.004016 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.004362 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */
alter table "datacore"."main_metadata"."meta_data_quality_metrics__dbt_tmp" rename to "meta_data_quality_metrics"
[0m02:45:00.005004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.006155 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:45:00.006495 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.006799 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: COMMIT
[0m02:45:00.008411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.010404 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_quality_metrics"
[0m02:45:00.010742 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_quality_metrics"} */

      drop table if exists "datacore"."main_metadata"."meta_data_quality_metrics__dbt_backup" cascade
    
[0m02:45:00.012079 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.013266 [debug] [Thread-1 (]: On model.datacore.meta_data_quality_metrics: Close
[0m02:45:00.014097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396927110>]}
[0m02:45:00.014653 [info ] [Thread-1 (]: 15 of 18 OK created sql table model main_metadata.meta_data_quality_metrics .... [[32mOK[0m in 0.04s]
[0m02:45:00.015219 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_quality_metrics
[0m02:45:00.015589 [debug] [Thread-1 (]: Began running node model.datacore.ads_toll_revenue_report
[0m02:45:00.016082 [info ] [Thread-1 (]: 16 of 18 START sql table model main_ads.ads_toll_revenue_report ................ [RUN]
[0m02:45:00.016485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_data_quality_metrics, now model.datacore.ads_toll_revenue_report)
[0m02:45:00.016806 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_toll_revenue_report
[0m02:45:00.021710 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_toll_revenue_report"
[0m02:45:00.022455 [debug] [Thread-1 (]: Began executing node model.datacore.ads_toll_revenue_report
[0m02:45:00.025277 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_toll_revenue_report"
[0m02:45:00.025871 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.026274 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: BEGIN
[0m02:45:00.026649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.027565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.027911 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.028299 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöÊî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®
-- ÂäüËÉΩÔºöÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®



SELECT 
    transaction_date,
    city,
    highway_code,
    -- ÊÄª‰ΩìÊåáÊ†á
    SUM(total_actual_amount) AS daily_revenue,
    SUM(transaction_count) AS daily_transactions,
    SUM(vehicle_count) AS daily_vehicles,
    AVG(avg_transaction_amount) AS avg_transaction_amount,
    -- ÊåâÊîØ‰ªòÊñπÂºè
    SUM(CASE WHEN payment_method_code = 'P01' THEN total_actual_amount ELSE 0 END) AS etc_revenue,
    SUM(CASE WHEN payment_method_code != 'P01' THEN total_actual_amount ELSE 0 END) AS non_etc_revenue,
    -- ÊåâËΩ¶Âûã
    SUM(CASE WHEN vehicle_type_code LIKE 'V0%' AND vehicle_type_code < 'V05' THEN total_actual_amount ELSE 0 END) AS passenger_revenue,
    SUM(CASE WHEN vehicle_type_code >= 'V05' THEN total_actual_amount ELSE 0 END) AS truck_revenue,
    -- Ë¥®ÈáèÊåáÊ†á
    SUM(normal_transaction_count) * 100.0 / SUM(transaction_count) AS normal_rate,
    SUM(quality_normal_count) * 100.0 / SUM(transaction_count) AS data_quality_rate,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_toll_revenue_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code
    );
  
  
[0m02:45:00.039471 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m02:45:00.040706 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.041043 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m02:45:00.042131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.043269 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.043664 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_toll_revenue_report'
  
[0m02:45:00.045006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.048089 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.048488 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report" rename to "ads_toll_revenue_report__dbt_backup"
[0m02:45:00.049380 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.051918 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.052278 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */
alter table "datacore"."main_ads"."ads_toll_revenue_report__dbt_tmp" rename to "ads_toll_revenue_report"
[0m02:45:00.052951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.054205 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:45:00.054577 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.054911 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: COMMIT
[0m02:45:00.057832 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:00.059883 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_toll_revenue_report"
[0m02:45:00.060214 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_toll_revenue_report"} */

      drop table if exists "datacore"."main_ads"."ads_toll_revenue_report__dbt_backup" cascade
    
[0m02:45:00.061542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.062730 [debug] [Thread-1 (]: On model.datacore.ads_toll_revenue_report: Close
[0m02:45:00.067369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3348533ad0>]}
[0m02:45:00.067999 [info ] [Thread-1 (]: 16 of 18 OK created sql table model main_ads.ads_toll_revenue_report ........... [[32mOK[0m in 0.05s]
[0m02:45:00.068610 [debug] [Thread-1 (]: Finished running node model.datacore.ads_toll_revenue_report
[0m02:45:00.069003 [debug] [Thread-1 (]: Began running node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.069559 [info ] [Thread-1 (]: 17 of 18 START sql table model main_ads.ads_traffic_trend_analysis ............. [RUN]
[0m02:45:00.070147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_toll_revenue_report, now model.datacore.ads_traffic_trend_analysis)
[0m02:45:00.070514 [debug] [Thread-1 (]: Began compiling node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.074041 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.074678 [debug] [Thread-1 (]: Began executing node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.077436 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.078003 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.078368 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: BEGIN
[0m02:45:00.078706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.079624 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.079967 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.080362 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

  
    
    

    create  table
      "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp"
  
    as (
      -- ADSÂ±ÇÔºöËΩ¶ÊµÅË∂ãÂäøÂàÜÊûê
-- ÂäüËÉΩÔºöËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê



SELECT 
    transaction_date,
    city,
    highway_code,
    day_type,
    -- ËΩ¶ÊµÅÈáèË∂ãÂäø
    SUM(total_vehicles) AS daily_vehicles,
    SUM(unique_vehicles) AS daily_unique_vehicles,
    -- Êó∂ÊÆµÂàÜÂ∏É
    SUM(CASE WHEN time_period = 'Êó©È´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS morning_peak_vehicles,
    SUM(CASE WHEN time_period = 'ÊôöÈ´òÂ≥∞' THEN total_vehicles ELSE 0 END) AS evening_peak_vehicles,
    SUM(CASE WHEN time_period = 'Âπ≥Â≥∞' THEN total_vehicles ELSE 0 END) AS normal_vehicles,
    SUM(CASE WHEN time_period = 'Â§úÈó¥' THEN total_vehicles ELSE 0 END) AS night_vehicles,
    -- ËΩ¶ÂûãÂàÜÂ∏É
    SUM(passenger_vehicle_count) AS passenger_vehicles,
    SUM(bus_count) AS bus_vehicles,
    SUM(truck_count) AS truck_vehicles,
    -- ETC‰ΩøÁî®Áéá
    SUM(etc_count) * 100.0 / SUM(total_vehicles) AS etc_usage_rate,
    -- Âπ≥ÂùáÈÄöË°åÊó∂Èïø
    AVG(avg_travel_minutes) AS avg_travel_minutes,
    -- Êó∂Èó¥Áª¥Â∫¶
    MAX(last_update_time) AS last_update_time
FROM "datacore"."main_dws"."dws_traffic_flow_daily"
GROUP BY 
    transaction_date,
    city,
    highway_code,
    day_type
    );
  
  
[0m02:45:00.088268 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m02:45:00.089548 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.089887 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m02:45:00.091019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.092253 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.092632 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_ads'
      AND table_name = 'ads_traffic_trend_analysis'
  
[0m02:45:00.093703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.096792 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.097179 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis" rename to "ads_traffic_trend_analysis__dbt_backup"
[0m02:45:00.097945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.100466 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.100828 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */
alter table "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_tmp" rename to "ads_traffic_trend_analysis"
[0m02:45:00.101493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.102842 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:45:00.103200 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.103552 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: COMMIT
[0m02:45:00.106390 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:00.108444 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.ads_traffic_trend_analysis"
[0m02:45:00.108778 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.ads_traffic_trend_analysis"} */

      drop table if exists "datacore"."main_ads"."ads_traffic_trend_analysis__dbt_backup" cascade
    
[0m02:45:00.110147 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.111349 [debug] [Thread-1 (]: On model.datacore.ads_traffic_trend_analysis: Close
[0m02:45:00.114082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396f80ce0>]}
[0m02:45:00.114652 [info ] [Thread-1 (]: 17 of 18 OK created sql table model main_ads.ads_traffic_trend_analysis ........ [[32mOK[0m in 0.04s]
[0m02:45:00.115231 [debug] [Thread-1 (]: Finished running node model.datacore.ads_traffic_trend_analysis
[0m02:45:00.115593 [debug] [Thread-1 (]: Began running node model.datacore.meta_data_asset_catalog
[0m02:45:00.116070 [info ] [Thread-1 (]: 18 of 18 START sql table model main_metadata.meta_data_asset_catalog ........... [RUN]
[0m02:45:00.116484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.ads_traffic_trend_analysis, now model.datacore.meta_data_asset_catalog)
[0m02:45:00.116801 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_data_asset_catalog
[0m02:45:00.122773 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_data_asset_catalog"
[0m02:45:00.123484 [debug] [Thread-1 (]: Began executing node model.datacore.meta_data_asset_catalog
[0m02:45:00.126319 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_data_asset_catalog"
[0m02:45:00.126876 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.127230 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: BEGIN
[0m02:45:00.127622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:00.128541 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.128882 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.129297 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÊï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï
-- ÂäüËÉΩÔºöÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞



WITH table_stats AS (
    SELECT 
        'dwd.dwd_toll_transaction_detail' AS table_name,
        COUNT(*) AS record_count,
        MAX(etl_time) AS last_update_time
    FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_toll_revenue_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_toll_revenue_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'dws.dws_traffic_flow_daily',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_dws"."dws_traffic_flow_daily"
    GROUP BY 1
    UNION ALL
    SELECT 
        'ads.ads_toll_revenue_report',
        COUNT(*),
        MAX(last_update_time)
    FROM "datacore"."main_ads"."ads_toll_revenue_report"
    GROUP BY 1
)

SELECT 
    ti.schema_name,
    ti.table_name,
    ti.table_description,
    ti.business_domain,
    ti.data_layer,
    ti.owner,
    COALESCE(ts.record_count, 0) AS record_count,
    COALESCE(ts.last_update_time, CURRENT_TIMESTAMP) AS last_update_time,
    -- ËµÑ‰∫ßÁ≠âÁ∫ßËØÑ‰º∞
    CASE 
        WHEN ti.data_layer IN ('dwd', 'dws') THEN 'Ê†∏ÂøÉËµÑ‰∫ß'
        WHEN ti.data_layer = 'ads' THEN 'Â∫îÁî®ËµÑ‰∫ß'
        ELSE 'Âü∫Á°ÄËµÑ‰∫ß'
    END AS asset_level,
    -- ‰ΩøÁî®È¢ëÁéáËØÑ‰º∞ÔºàÂü∫‰∫éÊõ¥Êñ∞È¢ëÁéáÔºâ
    CASE 
        WHEN ti.update_frequency = 'ÂÆûÊó∂' THEN 'È´òÈ¢ë'
        WHEN ti.update_frequency = 'Êó•' THEN '‰∏≠È¢ë'
        ELSE '‰ΩéÈ¢ë'
    END AS usage_frequency,
    -- Êï∞ÊçÆÊñ∞È≤úÂ∫¶
    CASE 
        WHEN ts.last_update_time IS NULL THEN 'Êú™Áü•'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 1 DAY THEN 'Êñ∞È≤ú'
        WHEN CURRENT_TIMESTAMP - ts.last_update_time < INTERVAL 7 DAY THEN 'ËæÉÊñ∞'
        ELSE 'ÈôàÊóß'
    END AS data_freshness,
    CURRENT_TIMESTAMP AS catalog_time
FROM "datacore"."main_metadata"."meta_table_info" ti
LEFT JOIN table_stats ts ON CONCAT(ti.schema_name, '.', ti.table_name) = ts.table_name
    );
  
  
[0m02:45:00.137441 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:45:00.138776 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.139117 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:45:00.140273 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.141404 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.141733 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_data_asset_catalog'
  
[0m02:45:00.142666 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.145426 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.145780 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog" rename to "meta_data_asset_catalog__dbt_backup"
[0m02:45:00.146515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.148847 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.149183 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */
alter table "datacore"."main_metadata"."meta_data_asset_catalog__dbt_tmp" rename to "meta_data_asset_catalog"
[0m02:45:00.149827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m02:45:00.150983 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:45:00.151314 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.151617 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: COMMIT
[0m02:45:00.153396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.155381 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_data_asset_catalog"
[0m02:45:00.155716 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_data_asset_catalog"} */

      drop table if exists "datacore"."main_metadata"."meta_data_asset_catalog__dbt_backup" cascade
    
[0m02:45:00.157030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:00.158210 [debug] [Thread-1 (]: On model.datacore.meta_data_asset_catalog: Close
[0m02:45:00.160915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daff4917-0991-4893-a77a-1f1e6b93d494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e334854af00>]}
[0m02:45:00.161473 [info ] [Thread-1 (]: 18 of 18 OK created sql table model main_metadata.meta_data_asset_catalog ...... [[32mOK[0m in 0.04s]
[0m02:45:00.161970 [debug] [Thread-1 (]: Finished running node model.datacore.meta_data_asset_catalog
[0m02:45:00.163922 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:00.164551 [debug] [MainThread]: On master: BEGIN
[0m02:45:00.165072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:00.166689 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m02:45:00.167224 [debug] [MainThread]: On master: COMMIT
[0m02:45:00.167763 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:00.168277 [debug] [MainThread]: On master: COMMIT
[0m02:45:00.169187 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:45:00.169742 [debug] [MainThread]: On master: Close
[0m02:45:00.173355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:00.173982 [debug] [MainThread]: Connection 'model.datacore.meta_data_asset_catalog' was properly closed.
[0m02:45:00.175056 [info ] [MainThread]: 
[0m02:45:00.175779 [info ] [MainThread]: Finished running 14 table models, 4 view models in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m02:45:00.182095 [debug] [MainThread]: Command end result
[0m02:45:00.228992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:45:00.231865 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:45:00.239420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:45:00.239789 [info ] [MainThread]: 
[0m02:45:00.240223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:00.240572 [info ] [MainThread]: 
[0m02:45:00.240951 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m02:45:00.242457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1755335, "process_in_blocks": "0", "process_kernel_time": 0.904887, "process_mem_max_rss": "301924", "process_out_blocks": "33816", "process_user_time": 4.613822}
[0m02:45:00.243197 [debug] [MainThread]: Command `dbt run` succeeded at 02:45:00.243105 after 3.18 seconds
[0m02:45:00.243658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396fdc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396cb35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3396b3eae0>]}
[0m02:45:00.244018 [debug] [MainThread]: Flushing usage events
[0m02:45:02.032064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:45:06.521570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345ea2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345af3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345d085f0>]}


============================== 02:45:06.525350 | 05702971-fb36-4ef4-865c-d218aace7e48 ==============================
[0m02:45:06.525350 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:45:06.525835 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'log_path': '/home/chun/Develop/datacore/logs', 'profiles_dir': '/home/chun/Develop/datacore', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True'}
[0m02:45:06.728684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1335907b60>]}
[0m02:45:06.787902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d13455bd100>]}
[0m02:45:06.789507 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m02:45:06.874151 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m02:45:07.007025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:45:07.007434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:45:07.068258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d13359c0410>]}
[0m02:45:07.172523 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:45:07.174287 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:45:07.195679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d133538d280>]}
[0m02:45:07.196189 [info ] [MainThread]: Found 1 seed, 18 models, 15 data tests, 4 sources, 465 macros
[0m02:45:07.196514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1335360e60>]}
[0m02:45:07.198851 [info ] [MainThread]: 
[0m02:45:07.199189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:45:07.199464 [info ] [MainThread]: 
[0m02:45:07.199927 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:45:07.205678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore_main_metadata'
[0m02:45:07.245987 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:45:07.246379 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m02:45:07.246656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:07.265071 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:45:07.265511 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m02:45:07.265829 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.279207 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m02:45:07.280671 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m02:45:07.281750 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m02:45:07.282038 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m02:45:07.282665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main_dwd)
[0m02:45:07.286998 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:45:07.287355 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m02:45:07.287618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.288514 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.288777 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m02:45:07.289045 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.294538 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:45:07.295703 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m02:45:07.296515 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m02:45:07.296781 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m02:45:07.297396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_staging)
[0m02:45:07.299535 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:45:07.299848 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m02:45:07.300120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.300801 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.301075 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m02:45:07.301366 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.305540 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:45:07.306828 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m02:45:07.307686 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m02:45:07.307968 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m02:45:07.308554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m02:45:07.311076 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:45:07.311394 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m02:45:07.311670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.312440 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.312712 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m02:45:07.312998 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.316618 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m02:45:07.317887 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m02:45:07.318742 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m02:45:07.319023 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m02:45:07.319595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_ads)
[0m02:45:07.322176 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:45:07.322496 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m02:45:07.322769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.323389 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.323662 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m02:45:07.323948 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.327939 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:45:07.329197 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m02:45:07.330034 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m02:45:07.330311 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m02:45:07.330878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main)
[0m02:45:07.333568 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:45:07.333876 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m02:45:07.334146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.334827 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.335095 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m02:45:07.335401 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.340502 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m02:45:07.341561 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m02:45:07.342372 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m02:45:07.342644 [debug] [ThreadPool]: On list_datacore_main: Close
[0m02:45:07.343221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ods)
[0m02:45:07.345028 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:45:07.345330 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m02:45:07.345602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:07.346230 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:45:07.346514 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m02:45:07.346799 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m02:45:07.351350 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m02:45:07.352573 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m02:45:07.353402 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m02:45:07.353676 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m02:45:07.355075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05702971-fb36-4ef4-865c-d218aace7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1347c9da30>]}
[0m02:45:07.356030 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.356518 [debug] [MainThread]: On master: BEGIN
[0m02:45:07.356894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:07.357844 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:45:07.358236 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.358628 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.359122 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.359909 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:45:07.360448 [debug] [MainThread]: On master: Close
[0m02:45:07.365076 [debug] [Thread-1 (]: Began running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.365863 [info ] [Thread-1 (]: 1 of 15 START test not_null_dwd_toll_transaction_detail_transaction_id ......... [RUN]
[0m02:45:07.366767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90)
[0m02:45:07.367448 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.397285 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.398397 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.415771 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.416372 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.416686 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: BEGIN
[0m02:45:07.416980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.417770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.418074 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"
[0m02:45:07.418385 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.419370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.422930 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: ROLLBACK
[0m02:45:07.423779 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90'
[0m02:45:07.424091 [debug] [Thread-1 (]: On test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90: Close
[0m02:45:07.424807 [info ] [Thread-1 (]: 1 of 15 PASS not_null_dwd_toll_transaction_detail_transaction_id ............... [[32mPASS[0m in 0.06s]
[0m02:45:07.425398 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90
[0m02:45:07.425784 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.426237 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_payment_method_dict_payment_method_code ........ [RUN]
[0m02:45:07.426718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_dwd_toll_transaction_detail_transaction_id.4a484e8a90, now test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c)
[0m02:45:07.427060 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.430825 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.431426 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.433433 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.433960 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.434300 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: BEGIN
[0m02:45:07.434636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.435467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.435799 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"
[0m02:45:07.436138 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_method_code
from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.437688 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.439108 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: ROLLBACK
[0m02:45:07.440016 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c'
[0m02:45:07.440365 [debug] [Thread-1 (]: On test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c: Close
[0m02:45:07.441000 [info ] [Thread-1 (]: 2 of 15 PASS not_null_stg_payment_method_dict_payment_method_code .............. [[32mPASS[0m in 0.01s]
[0m02:45:07.441581 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c
[0m02:45:07.441956 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.442378 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_toll_station_station_id ........................ [RUN]
[0m02:45:07.442786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_payment_method_dict_payment_method_code.e67f273a4c, now test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2)
[0m02:45:07.443121 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.508694 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.509422 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.511428 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.511941 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.512275 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: BEGIN
[0m02:45:07.512604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.513581 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.513908 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"
[0m02:45:07.514237 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_station"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.515470 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.516856 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: ROLLBACK
[0m02:45:07.517762 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2'
[0m02:45:07.518089 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2: Close
[0m02:45:07.519076 [info ] [Thread-1 (]: 3 of 15 PASS not_null_stg_toll_station_station_id .............................. [[32mPASS[0m in 0.08s]
[0m02:45:07.519654 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2
[0m02:45:07.520026 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.520426 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_toll_transaction_station_id .................... [RUN]
[0m02:45:07.520825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_station_station_id.6c0a4878c2, now test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde)
[0m02:45:07.521164 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.524798 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.525364 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.527287 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.527835 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.528223 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: BEGIN
[0m02:45:07.528558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.529353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.529676 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"
[0m02:45:07.530006 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select station_id
from "datacore"."main_staging"."stg_toll_transaction"
where station_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.533252 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.534724 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: ROLLBACK
[0m02:45:07.535619 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde'
[0m02:45:07.535953 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde: Close
[0m02:45:07.536589 [info ] [Thread-1 (]: 4 of 15 PASS not_null_stg_toll_transaction_station_id .......................... [[32mPASS[0m in 0.02s]
[0m02:45:07.537148 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde
[0m02:45:07.537527 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.537916 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_toll_transaction_transaction_id ................ [RUN]
[0m02:45:07.538322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_station_id.0b92522fde, now test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b)
[0m02:45:07.538660 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.542285 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.542863 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.544739 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.545332 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.545670 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: BEGIN
[0m02:45:07.545996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.546770 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.547093 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"
[0m02:45:07.547433 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.550557 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.551970 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: ROLLBACK
[0m02:45:07.552878 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b'
[0m02:45:07.553214 [debug] [Thread-1 (]: On test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b: Close
[0m02:45:07.553853 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_toll_transaction_transaction_id ...................... [[32mPASS[0m in 0.02s]
[0m02:45:07.554426 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b
[0m02:45:07.554802 [debug] [Thread-1 (]: Began running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.555200 [info ] [Thread-1 (]: 6 of 15 START test not_null_stg_vehicle_type_dict_vehicle_type_code ............ [RUN]
[0m02:45:07.555617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_toll_transaction_transaction_id.224adf139b, now test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728)
[0m02:45:07.555953 [debug] [Thread-1 (]: Began compiling node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.559660 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.560244 [debug] [Thread-1 (]: Began executing node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.562171 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.562709 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.563052 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: BEGIN
[0m02:45:07.563394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.564171 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.564513 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"
[0m02:45:07.564855 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vehicle_type_code
from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is null



  
  
      
    ) dbt_internal_test
[0m02:45:07.566183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.567570 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: ROLLBACK
[0m02:45:07.568471 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728'
[0m02:45:07.568807 [debug] [Thread-1 (]: On test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728: Close
[0m02:45:07.569434 [info ] [Thread-1 (]: 6 of 15 PASS not_null_stg_vehicle_type_dict_vehicle_type_code .................. [[32mPASS[0m in 0.01s]
[0m02:45:07.569999 [debug] [Thread-1 (]: Finished running node test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728
[0m02:45:07.570392 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.570815 [info ] [Thread-1 (]: 7 of 15 START test test_toll_transaction_accuracy .............................. [RUN]
[0m02:45:07.571236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.not_null_stg_vehicle_type_dict_vehicle_type_code.5a77079728, now test.datacore.test_toll_transaction_accuracy)
[0m02:45:07.571580 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.574226 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.574853 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.577098 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.577690 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.578021 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: BEGIN
[0m02:45:07.578350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.579138 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.579467 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_accuracy"
[0m02:45:07.579830 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_accuracy"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂáÜÁ°ÆÊÄß

SELECT 
    transaction_id,
    toll_amount,
    actual_amount,
    discount_amount
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    actual_amount < 0
    OR actual_amount > toll_amount
    OR discount_amount < 0
    OR discount_amount > toll_amount
    OR (actual_amount + discount_amount) > toll_amount * 1.1  -- ÂÖÅËÆ∏10%ËØØÂ∑Æ
  
  
      
    ) dbt_internal_test
[0m02:45:07.583280 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.584820 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: ROLLBACK
[0m02:45:07.585730 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_accuracy'
[0m02:45:07.586064 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_accuracy: Close
[0m02:45:07.586712 [info ] [Thread-1 (]: 7 of 15 PASS test_toll_transaction_accuracy .................................... [[32mPASS[0m in 0.02s]
[0m02:45:07.587285 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_accuracy
[0m02:45:07.587669 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_completeness
[0m02:45:07.588078 [info ] [Thread-1 (]: 8 of 15 START test test_toll_transaction_completeness .......................... [RUN]
[0m02:45:07.588483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_accuracy, now test.datacore.test_toll_transaction_completeness)
[0m02:45:07.588814 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_completeness
[0m02:45:07.591414 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.591975 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_completeness
[0m02:45:07.595603 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.596162 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.596509 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: BEGIN
[0m02:45:07.596833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.597621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.597946 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_completeness"
[0m02:45:07.598292 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_completeness"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂÆåÊï¥ÊÄß

SELECT 
    transaction_id,
    station_id,
    vehicle_plate,
    vehicle_type_code,
    payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    transaction_id IS NULL
    OR station_id IS NULL
    OR vehicle_plate IS NULL
    OR vehicle_plate = ''
    OR vehicle_type_code IS NULL
    OR payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:45:07.607223 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m02:45:07.608748 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: ROLLBACK
[0m02:45:07.609646 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_completeness'
[0m02:45:07.609976 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_completeness: Close
[0m02:45:07.610603 [info ] [Thread-1 (]: 8 of 15 PASS test_toll_transaction_completeness ................................ [[32mPASS[0m in 0.02s]
[0m02:45:07.611181 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_completeness
[0m02:45:07.611564 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_consistency
[0m02:45:07.611956 [info ] [Thread-1 (]: 9 of 15 START test test_toll_transaction_consistency ........................... [RUN]
[0m02:45:07.612361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_completeness, now test.datacore.test_toll_transaction_consistency)
[0m02:45:07.612699 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_consistency
[0m02:45:07.615320 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.615878 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_consistency
[0m02:45:07.617776 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.618286 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.618630 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: BEGIN
[0m02:45:07.618951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.619893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.620222 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_consistency"
[0m02:45:07.620571 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_consistency"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆ‰∏ÄËá¥ÊÄß

SELECT 
    transaction_id,
    entry_time,
    exit_time,
    travel_minutes
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail"
WHERE 
    exit_time < entry_time
    OR travel_minutes < 0
    OR travel_minutes > 1440  -- Ë∂ÖËøá24Â∞èÊó∂ËßÜ‰∏∫ÂºÇÂ∏∏
  
  
      
    ) dbt_internal_test
[0m02:45:07.623441 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:07.624923 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: ROLLBACK
[0m02:45:07.625821 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_consistency'
[0m02:45:07.626153 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_consistency: Close
[0m02:45:07.627097 [info ] [Thread-1 (]: 9 of 15 PASS test_toll_transaction_consistency ................................. [[32mPASS[0m in 0.01s]
[0m02:45:07.627696 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_consistency
[0m02:45:07.628067 [debug] [Thread-1 (]: Began running node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.628475 [info ] [Thread-1 (]: 10 of 15 START test test_toll_transaction_referential_integrity ................ [RUN]
[0m02:45:07.628867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_consistency, now test.datacore.test_toll_transaction_referential_integrity)
[0m02:45:07.629210 [debug] [Thread-1 (]: Began compiling node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.632674 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.633280 [debug] [Thread-1 (]: Began executing node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.635322 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.635868 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.636211 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: BEGIN
[0m02:45:07.636556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.637358 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.637693 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.test_toll_transaction_referential_integrity"
[0m02:45:07.638058 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.test_toll_transaction_referential_integrity"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- ÊµãËØïÔºöÊî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÂºïÁî®ÂÆåÊï¥ÊÄß

SELECT 
    t.transaction_id,
    t.station_id,
    t.vehicle_type_code,
    t.payment_method_code
FROM "datacore"."main_dwd"."dwd_toll_transaction_detail" t
LEFT JOIN "datacore"."main_ods"."ods_toll_station" s ON t.station_id = s.station_id
LEFT JOIN "datacore"."main_staging"."stg_vehicle_type_dict" vt ON t.vehicle_type_code = vt.vehicle_type_code
LEFT JOIN "datacore"."main_staging"."stg_payment_method_dict" pm ON t.payment_method_code = pm.payment_method_code
WHERE 
    s.station_id IS NULL
    OR vt.vehicle_type_code IS NULL
    OR pm.payment_method_code IS NULL
  
  
      
    ) dbt_internal_test
[0m02:45:07.646454 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m02:45:07.647931 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: ROLLBACK
[0m02:45:07.648798 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.test_toll_transaction_referential_integrity'
[0m02:45:07.649115 [debug] [Thread-1 (]: On test.datacore.test_toll_transaction_referential_integrity: Close
[0m02:45:07.649884 [info ] [Thread-1 (]: 10 of 15 PASS test_toll_transaction_referential_integrity ...................... [[32mPASS[0m in 0.02s]
[0m02:45:07.650414 [debug] [Thread-1 (]: Finished running node test.datacore.test_toll_transaction_referential_integrity
[0m02:45:07.650791 [debug] [Thread-1 (]: Began running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.651194 [info ] [Thread-1 (]: 11 of 15 START test unique_dwd_toll_transaction_detail_transaction_id .......... [RUN]
[0m02:45:07.651594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.test_toll_transaction_referential_integrity, now test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716)
[0m02:45:07.651930 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.657841 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.658427 [debug] [Thread-1 (]: Began executing node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.660393 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.660913 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.661251 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: BEGIN
[0m02:45:07.661582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.662370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.662799 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"
[0m02:45:07.663140 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_dwd"."dwd_toll_transaction_detail"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.698185 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:45:07.699850 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: ROLLBACK
[0m02:45:07.700707 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716'
[0m02:45:07.701025 [debug] [Thread-1 (]: On test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716: Close
[0m02:45:07.703589 [info ] [Thread-1 (]: 11 of 15 PASS unique_dwd_toll_transaction_detail_transaction_id ................ [[32mPASS[0m in 0.05s]
[0m02:45:07.704107 [debug] [Thread-1 (]: Finished running node test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716
[0m02:45:07.704478 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.704889 [info ] [Thread-1 (]: 12 of 15 START test unique_stg_payment_method_dict_payment_method_code ......... [RUN]
[0m02:45:07.705281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_dwd_toll_transaction_detail_transaction_id.ac8359b716, now test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1)
[0m02:45:07.705636 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.709440 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.710031 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.711982 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.712517 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.712862 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: BEGIN
[0m02:45:07.713198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.713994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.714339 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"
[0m02:45:07.714686 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_method_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_payment_method_dict"
where payment_method_code is not null
group by payment_method_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.717015 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:07.718577 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: ROLLBACK
[0m02:45:07.719488 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1'
[0m02:45:07.719829 [debug] [Thread-1 (]: On test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1: Close
[0m02:45:07.720845 [info ] [Thread-1 (]: 12 of 15 PASS unique_stg_payment_method_dict_payment_method_code ............... [[32mPASS[0m in 0.02s]
[0m02:45:07.721403 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1
[0m02:45:07.721784 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.722186 [info ] [Thread-1 (]: 13 of 15 START test unique_stg_toll_station_station_id ......................... [RUN]
[0m02:45:07.722607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_payment_method_dict_payment_method_code.c4ffbc9bb1, now test.datacore.unique_stg_toll_station_station_id.7201f48e61)
[0m02:45:07.722950 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.726591 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.727177 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.729191 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.729758 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.730097 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: BEGIN
[0m02:45:07.730434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.731243 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.731579 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_station_station_id.7201f48e61"
[0m02:45:07.731915 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_station_station_id.7201f48e61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    station_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_station"
where station_id is not null
group by station_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.735295 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m02:45:07.736846 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: ROLLBACK
[0m02:45:07.737771 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_station_station_id.7201f48e61'
[0m02:45:07.738114 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_station_station_id.7201f48e61: Close
[0m02:45:07.739679 [info ] [Thread-1 (]: 13 of 15 PASS unique_stg_toll_station_station_id ............................... [[32mPASS[0m in 0.02s]
[0m02:45:07.740229 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_station_station_id.7201f48e61
[0m02:45:07.740622 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.741022 [info ] [Thread-1 (]: 14 of 15 START test unique_stg_toll_transaction_transaction_id ................. [RUN]
[0m02:45:07.741424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_station_station_id.7201f48e61, now test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27)
[0m02:45:07.741769 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.747346 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.747965 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.749872 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.750405 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.750746 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: BEGIN
[0m02:45:07.751073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.751874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.752205 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"
[0m02:45:07.752554 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_toll_transaction"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.777739 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m02:45:07.779623 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: ROLLBACK
[0m02:45:07.780586 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27'
[0m02:45:07.780933 [debug] [Thread-1 (]: On test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27: Close
[0m02:45:07.783859 [info ] [Thread-1 (]: 14 of 15 PASS unique_stg_toll_transaction_transaction_id ....................... [[32mPASS[0m in 0.04s]
[0m02:45:07.784391 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27
[0m02:45:07.784746 [debug] [Thread-1 (]: Began running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.785131 [info ] [Thread-1 (]: 15 of 15 START test unique_stg_vehicle_type_dict_vehicle_type_code ............. [RUN]
[0m02:45:07.785537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.datacore.unique_stg_toll_transaction_transaction_id.a48b447e27, now test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd)
[0m02:45:07.785877 [debug] [Thread-1 (]: Began compiling node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.789580 [debug] [Thread-1 (]: Writing injected SQL for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.790165 [debug] [Thread-1 (]: Began executing node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.792136 [debug] [Thread-1 (]: Writing runtime sql for node "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.792688 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.793031 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: BEGIN
[0m02:45:07.793370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:07.794177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:45:07.794516 [debug] [Thread-1 (]: Using duckdb connection "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"
[0m02:45:07.794857 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vehicle_type_code as unique_field,
    count(*) as n_records

from "datacore"."main_staging"."stg_vehicle_type_dict"
where vehicle_type_code is not null
group by vehicle_type_code
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:45:07.797133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m02:45:07.798671 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: ROLLBACK
[0m02:45:07.799597 [debug] [Thread-1 (]: Failed to rollback 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd'
[0m02:45:07.799935 [debug] [Thread-1 (]: On test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd: Close
[0m02:45:07.801040 [info ] [Thread-1 (]: 15 of 15 PASS unique_stg_vehicle_type_dict_vehicle_type_code ................... [[32mPASS[0m in 0.02s]
[0m02:45:07.801591 [debug] [Thread-1 (]: Finished running node test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd
[0m02:45:07.803599 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.804401 [debug] [MainThread]: On master: BEGIN
[0m02:45:07.804893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:07.805859 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m02:45:07.806250 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.806646 [debug] [MainThread]: Using duckdb connection "master"
[0m02:45:07.807014 [debug] [MainThread]: On master: COMMIT
[0m02:45:07.807686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:45:07.808080 [debug] [MainThread]: On master: Close
[0m02:45:07.808657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:07.809019 [debug] [MainThread]: Connection 'test.datacore.unique_stg_vehicle_type_dict_vehicle_type_code.94ab9557bd' was properly closed.
[0m02:45:07.809458 [info ] [MainThread]: 
[0m02:45:07.809896 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m02:45:07.813402 [debug] [MainThread]: Command end result
[0m02:45:07.844369 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m02:45:07.846410 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m02:45:07.852965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m02:45:07.853284 [info ] [MainThread]: 
[0m02:45:07.853648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:07.853928 [info ] [MainThread]: 
[0m02:45:07.854238 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m02:45:07.855140 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3859557, "process_in_blocks": "0", "process_kernel_time": 0.323683, "process_mem_max_rss": "189624", "process_out_blocks": "3080", "process_user_time": 2.6056}
[0m02:45:07.855563 [debug] [MainThread]: Command `dbt test` succeeded at 02:45:07.855478 after 1.39 seconds
[0m02:45:07.855906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1345af20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d12ed48aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1335961a30>]}
[0m02:45:07.856244 [debug] [MainThread]: Flushing usage events
[0m02:45:09.035570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:33.477695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff811dc0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff80e616d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff818e5c40>]}


============================== 03:12:33.482046 | de6b10e5-7f65-4710-9e37-ed8c60706693 ==============================
[0m03:12:33.482046 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:12:33.482575 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/home/chun/Develop/datacore/logs', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/chun/Develop/datacore', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select meta_table_info meta_column_info', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m03:12:33.702472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff80e1f290>]}
[0m03:12:33.767188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff7cb143e0>]}
[0m03:12:33.768918 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:12:33.852134 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:12:33.988533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 7 files changed.
[0m03:12:33.989152 [debug] [MainThread]: Partial parsing: added file: datacore://macros/metadata/generate_column_info.sql
[0m03:12:33.989479 [debug] [MainThread]: Partial parsing: added file: datacore://models/metadata/meta_column_info.sql
[0m03:12:33.990246 [debug] [MainThread]: Partial parsing: updated file: datacore://models/staging/schema.yml
[0m03:12:33.990796 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m03:12:33.991442 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dws/schema.yml
[0m03:12:33.991936 [debug] [MainThread]: Partial parsing: updated file: datacore://models/ods/schema.yml
[0m03:12:33.992555 [debug] [MainThread]: Partial parsing: updated file: datacore://models/ads/schema.yml
[0m03:12:33.993042 [debug] [MainThread]: Partial parsing: updated file: datacore://models/dwd/schema.yml
[0m03:12:33.993434 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/generate_table_info.sql
[0m03:12:34.645290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff70037ef0>]}
[0m03:12:34.754035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:12:34.756088 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:12:34.770148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff7009adb0>]}
[0m03:12:34.770618 [info ] [MainThread]: Found 1 seed, 19 models, 15 data tests, 4 sources, 466 macros
[0m03:12:34.770925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff81727890>]}
[0m03:12:34.772649 [info ] [MainThread]: 
[0m03:12:34.772959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:34.773221 [info ] [MainThread]: 
[0m03:12:34.773642 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:12:34.778056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m03:12:34.813532 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:12:34.813957 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:12:34.814231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:34.833799 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m03:12:34.835261 [debug] [ThreadPool]: On list_datacore: Close
[0m03:12:34.836219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m03:12:34.836625 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m03:12:34.842815 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.843154 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:12:34.843427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.844610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.845790 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.846059 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m03:12:34.846585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:12:34.846839 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.847099 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m03:12:34.847608 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:12:34.848310 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:12:34.848577 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:12:34.848821 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:12:34.849245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:12:34.849519 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m03:12:34.852598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_ods)
[0m03:12:34.858972 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:12:34.859365 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m03:12:34.859626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.860370 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.860629 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:12:34.860891 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.872762 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m03:12:34.874089 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m03:12:34.875108 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m03:12:34.875385 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m03:12:34.875935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_staging)
[0m03:12:34.878198 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:12:34.878489 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m03:12:34.878738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.879572 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.879825 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:12:34.880081 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.884254 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:12:34.885533 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m03:12:34.886369 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m03:12:34.886626 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m03:12:34.887164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main)
[0m03:12:34.889907 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:12:34.890201 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m03:12:34.890470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.891044 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.891295 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:12:34.891559 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.896874 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:12:34.898015 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m03:12:34.898844 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m03:12:34.899104 [debug] [ThreadPool]: On list_datacore_main: Close
[0m03:12:34.899671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_dwd)
[0m03:12:34.901273 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:12:34.901550 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m03:12:34.901799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.902382 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.902631 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:12:34.902884 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.906341 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:12:34.907518 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m03:12:34.908339 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m03:12:34.908597 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m03:12:34.909127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now list_datacore_main_dws)
[0m03:12:34.911142 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:12:34.911431 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m03:12:34.911678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.912239 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.912502 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:12:34.912761 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.916904 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:12:34.918149 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m03:12:34.918966 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m03:12:34.919224 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m03:12:34.919801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_ads)
[0m03:12:34.922272 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:12:34.922556 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m03:12:34.922803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.923592 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.923843 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:12:34.924099 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.927540 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:12:34.928758 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m03:12:34.929551 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m03:12:34.929806 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m03:12:34.930573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_metadata)
[0m03:12:34.933067 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:12:34.933357 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m03:12:34.933605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:34.934178 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:12:34.934437 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:12:34.934692 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m03:12:34.939516 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m03:12:34.940781 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m03:12:34.941597 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m03:12:34.941853 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m03:12:34.944181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff70f65a30>]}
[0m03:12:34.945071 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:34.945640 [debug] [MainThread]: On master: BEGIN
[0m03:12:34.946159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:34.947384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:12:34.947914 [debug] [MainThread]: On master: COMMIT
[0m03:12:34.948450 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:34.948959 [debug] [MainThread]: On master: COMMIT
[0m03:12:34.949815 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:12:34.950381 [debug] [MainThread]: On master: Close
[0m03:12:34.953812 [debug] [Thread-1 (]: Began running node model.datacore.meta_column_info
[0m03:12:34.954410 [info ] [Thread-1 (]: 1 of 2 START sql table model main_metadata.meta_column_info .................... [RUN]
[0m03:12:34.954881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now model.datacore.meta_column_info)
[0m03:12:34.955229 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_column_info
[0m03:12:34.965906 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_column_info"
[0m03:12:34.966528 [debug] [Thread-1 (]: Began executing node model.datacore.meta_column_info
[0m03:12:34.997096 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_column_info"
[0m03:12:34.997767 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:34.998082 [debug] [Thread-1 (]: On model.datacore.meta_column_info: BEGIN
[0m03:12:34.998386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:34.999207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:34.999513 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.000366 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_column_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöÂ≠óÊÆµ‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®Â≠óÊÆµÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- Â≠óÊÆµ‰∏≠ÊñáÂêç‰ªé schema.yml ÁöÑ columns meta Â≠óÊÆµËé∑Âèñ



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'asset_level' AS column_name, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_name_cn, 'ËµÑ‰∫ßÁ≠âÁ∫ßÔºöÊ†∏ÂøÉËµÑ‰∫ß/Â∫îÁî®ËµÑ‰∫ß/Âü∫Á°ÄËµÑ‰∫ß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'usage_frequency' AS column_name, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_name_cn, '‰ΩøÁî®È¢ëÁéáÔºöÈ´òÈ¢ë/‰∏≠È¢ë/‰ΩéÈ¢ë' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'data_freshness' AS column_name, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_name_cn, 'Êï∞ÊçÆÊñ∞È≤úÂ∫¶ÔºöÊñ∞È≤ú/ËæÉÊñ∞/ÈôàÊóß' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'metric_date' AS column_name, 'ÊåáÊ†áÊó•Êúü' AS column_name_cn, 'ÊåáÊ†áÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'overall_quality_score' AS column_name, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜ' AS column_name_cn, 'ÁªºÂêàË¥®ÈáèÂæóÂàÜÔºà0-100Ôºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'completeness_rate' AS column_name, 'ÂÆåÊï¥ÊÄßÁéá' AS column_name_cn, 'ÂÆåÊï¥ÊÄßÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'accuracy_rate' AS column_name, 'ÂáÜÁ°ÆÁéá' AS column_name_cn, 'ÂáÜÁ°ÆÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'consistency_rate' AS column_name, '‰∏ÄËá¥Áéá' AS column_name_cn, '‰∏ÄËá¥Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_type' AS column_name, 'Â≠óÂÖ∏Á±ªÂûã' AS column_name_cn, 'Â≠óÂÖ∏Á±ªÂûã' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_code' AS column_name, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_name_cn, 'Â≠óÂÖ∏ÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_name' AS column_name, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_name_cn, 'Â≠óÂÖ∏ÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_desc' AS column_name, 'Â≠óÂÖ∏ÊèèËø∞' AS column_name_cn, 'Â≠óÂÖ∏ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_value' AS column_name, 'Â≠óÂÖ∏ÂÄº' AS column_name_cn, 'Â≠óÂÖ∏ÂÄº' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'dict_source' AS column_name, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_name_cn, 'Â≠óÂÖ∏Êù•Ê∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'source_table' AS column_name, 'Ê∫êË°®' AS column_name_cn, 'Ê∫êË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'target_table' AS column_name, 'ÁõÆÊ†áË°®' AS column_name_cn, 'ÁõÆÊ†áË°®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_type' AS column_name, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_name_cn, 'ËΩ¨Êç¢Á±ªÂûãÔºöÊ∏ÖÊ¥ó/ÂÖ≥ËÅî/ËΩ¨Êç¢/Ê±áÊÄª/ËÅöÂêà' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'transformation_desc' AS column_name, 'ËΩ¨Êç¢ÊèèËø∞' AS column_name_cn, 'ËΩ¨Êç¢ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôIDÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'highway_code' AS column_name, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_name_cn, 'È´òÈÄüÂÖ¨Ë∑ØÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìIDÔºåÂîØ‰∏ÄÊ†áËØÜ‰∏ÄÁ¨î‰∫§Êòì' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'entry_time' AS column_name, 'ÂÖ•Âè£Êó∂Èó¥' AS column_name_cn, 'ÂÖ•Âè£Êó∂Èó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'exit_time' AS column_name, 'Âá∫Âè£Êó∂Èó¥' AS column_name_cn, 'Âá∫Âè£Êó∂Èó¥ÔºàÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'travel_minutes' AS column_name, 'ÈÄöË°åÊó∂Èïø' AS column_name_cn, 'ÈÄöË°åÊó∂ÈïøÔºàÂàÜÈíüÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºåÂ∑≤Ê∏ÖÊ¥óÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'data_quality_flag' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊ†áËÆ∞ÔºöÊ≠£Â∏∏/Êï∞ÊçÆÁº∫Â§±/Êî∂Ë¥πÁ´ôÁº∫Â§±/ËΩ¶ÁâåÁº∫Â§±/Êó∂Èó¥ÂºÇÂ∏∏/ÈáëÈ¢ùÂºÇÂ∏∏' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_code' AS column_name, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†Å' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'payment_method_name' AS column_name, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_name_cn, 'ÊîØ‰ªòÊñπÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_code' AS column_name, 'ËΩ¶ÂûãÁºñÁ†Å' AS column_name_cn, 'ËΩ¶ÂûãÁºñÁ†ÅÔºå‰∏ªÈîÆ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'toll_rate_multiplier' AS column_name, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_name_cn, 'Êî∂Ë¥πË¥πÁéáÁ≥ªÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'schema_name' AS column_name, 'Ê®°ÂºèÂêçÁß∞' AS column_name_cn, 'Ê®°ÂºèÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name' AS column_name, 'Ë°®Âêç' AS column_name_cn, 'Ë°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_name_cn' AS column_name, '‰∏≠ÊñáË°®Âêç' AS column_name_cn, '‰∏≠ÊñáË°®Âêç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'table_description' AS column_name, 'Ë°®ÊèèËø∞' AS column_name_cn, 'Ë°®ÊèèËø∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'business_domain' AS column_name, '‰∏öÂä°Âüü' AS column_name_cn, '‰∏öÂä°Âüü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_source' AS column_name, 'Êï∞ÊçÆÊ∫ê' AS column_name_cn, 'Êï∞ÊçÆÊ∫ê' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'update_frequency' AS column_name, 'Êõ¥Êñ∞È¢ëÁéá' AS column_name_cn, 'Êõ¥Êñ∞È¢ëÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'owner' AS column_name, 'Ë¥üË¥£‰∫∫' AS column_name_cn, 'Ë¥üË¥£‰∫∫/ÈÉ®Èó®' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'data_layer' AS column_name, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_name_cn, 'Êï∞ÊçÆÂàÜÂ±Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'total_actual_amount' AS column_name, 'Êó•ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Êó•ÂÆûÊî∂ÈáëÈ¢ùÊ±áÊÄªÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'transaction_count' AS column_name, '‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, '‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'vehicle_count' AS column_name, 'ËΩ¶ËæÜÊï∞' AS column_name_cn, 'ËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'total_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'etc_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'total_vehicles' AS column_name, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_name_cn, 'ÊÄªËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'unique_vehicles' AS column_name, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_name_cn, 'ÂîØ‰∏ÄËΩ¶ËæÜÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'daily_vehicles' AS column_name, 'Êó•ËΩ¶ÊµÅÈáè' AS column_name_cn, 'Êó•ËΩ¶ÊµÅÈáè' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'etc_usage_rate' AS column_name, 'ETC‰ΩøÁî®Áéá' AS column_name_cn, 'ETC‰ΩøÁî®Áéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'city' AS column_name, 'ÂüéÂ∏Ç' AS column_name_cn, 'ÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_revenue' AS column_name, 'Êó•Êî∂ÂÖ•' AS column_name_cn, 'Êó•Êî∂ÂÖ•ÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'daily_transactions' AS column_name, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_name_cn, 'Êó•‰∫§ÊòìÁ¨îÊï∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'normal_rate' AS column_name, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_name_cn, 'Ê≠£Â∏∏‰∫§ÊòìÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'data_quality_rate' AS column_name, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁéá' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'alert_status' AS column_name, 'ÂëäË≠¶Áä∂ÊÄÅ' AS column_name_cn, 'ÂëäË≠¶Áä∂ÊÄÅÔºöÊ≠£Â∏∏/ÂëäË≠¶' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_id' AS column_name, '‰∫§ÊòìID' AS column_name_cn, '‰∫§ÊòìID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_id' AS column_name, 'Êî∂Ë¥πÁ´ôID' AS column_name_cn, 'Êî∂Ë¥πÁ´ôID' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'station_name' AS column_name, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_name_cn, 'Êî∂Ë¥πÁ´ôÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'city' AS column_name, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_name_cn, 'ÊâÄÂ±ûÂüéÂ∏Ç' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_plate' AS column_name, 'ËΩ¶ÁâåÂè∑' AS column_name_cn, 'ËΩ¶ÁâåÂè∑' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'vehicle_type_name' AS column_name, 'ËΩ¶ÂûãÂêçÁß∞' AS column_name_cn, 'ËΩ¶ÂûãÂêçÁß∞' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'toll_amount' AS column_name, 'Â∫îÊî∂ÈáëÈ¢ù' AS column_name_cn, 'Â∫îÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'actual_amount' AS column_name, 'ÂÆûÊî∂ÈáëÈ¢ù' AS column_name_cn, 'ÂÆûÊî∂ÈáëÈ¢ùÔºàÂÖÉÔºâ' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'transaction_date' AS column_name, '‰∫§ÊòìÊó•Êúü' AS column_name_cn, '‰∫§ÊòìÊó•Êúü' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'time_period' AS column_name, 'Êó∂ÊÆµÂàÜÁ±ª' AS column_name_cn, 'Êó∂ÊÆµÂàÜÁ±ªÔºöÊó©È´òÂ≥∞/ÊôöÈ´òÂ≥∞/Âπ≥Â≥∞/Â§úÈó¥' AS column_description, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'day_type' AS column_name, 'Êó•ÊúüÁ±ªÂûã' AS column_name_cn, 'Êó•ÊúüÁ±ªÂûãÔºöÂ∑•‰ΩúÊó•/Âë®Êú´' AS column_description, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:12:35.016858 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m03:12:35.022781 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.023164 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */
alter table "datacore"."main_metadata"."meta_column_info__dbt_tmp" rename to "meta_column_info"
[0m03:12:35.024178 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.037679 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:12:35.038115 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.038432 [debug] [Thread-1 (]: On model.datacore.meta_column_info: COMMIT
[0m03:12:35.040522 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:12:35.045520 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_column_info"
[0m03:12:35.045879 [debug] [Thread-1 (]: On model.datacore.meta_column_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_column_info"} */

      drop table if exists "datacore"."main_metadata"."meta_column_info__dbt_backup" cascade
    
[0m03:12:35.046570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:12:35.048725 [debug] [Thread-1 (]: On model.datacore.meta_column_info: Close
[0m03:12:35.050700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff29caba70>]}
[0m03:12:35.051277 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main_metadata.meta_column_info ............... [[32mOK[0m in 0.09s]
[0m03:12:35.051799 [debug] [Thread-1 (]: Finished running node model.datacore.meta_column_info
[0m03:12:35.052165 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m03:12:35.052646 [info ] [Thread-1 (]: 2 of 2 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m03:12:35.053017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.datacore.meta_column_info, now model.datacore.meta_table_info)
[0m03:12:35.053345 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m03:12:35.057619 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m03:12:35.058227 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m03:12:35.061054 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m03:12:35.061644 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.061994 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m03:12:35.062345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:35.063376 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.063715 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.064277 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï' AS table_name_cn, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®' AS table_name_cn, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®' AS table_name_cn, 'Êï∞ÊçÆË°ÄÁºòÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑË°ÄÁºòÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_column_info' AS table_name, 'meta_column_info' AS table_name_cn, '' AS table_description, 'Êú™ÂàÜÁ±ª' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®' AS table_name_cn, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªË°®' AS table_name_cn, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªË°®' AS table_name_cn, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêË°®' AS table_name_cn, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®' AS table_name_cn, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:12:35.071246 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m03:12:35.077294 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.077709 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:12:35.078870 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.080128 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.080495 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:12:35.081460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.084485 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.084862 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m03:12:35.085656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:12:35.088179 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.088552 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m03:12:35.089214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m03:12:35.092573 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:12:35.092955 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.093298 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:12:35.094868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.097104 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:12:35.097470 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m03:12:35.098880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:12:35.100178 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m03:12:35.100906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6b10e5-7f65-4710-9e37-ed8c60706693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff2a06b020>]}
[0m03:12:35.101521 [info ] [Thread-1 (]: 2 of 2 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.05s]
[0m03:12:35.102066 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m03:12:35.103669 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:35.104288 [debug] [MainThread]: On master: BEGIN
[0m03:12:35.104797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:35.105729 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:12:35.106224 [debug] [MainThread]: On master: COMMIT
[0m03:12:35.106728 [debug] [MainThread]: Using duckdb connection "master"
[0m03:12:35.107205 [debug] [MainThread]: On master: COMMIT
[0m03:12:35.107990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:12:35.108504 [debug] [MainThread]: On master: Close
[0m03:12:35.109182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:35.109662 [debug] [MainThread]: Connection 'model.datacore.meta_table_info' was properly closed.
[0m03:12:35.110231 [info ] [MainThread]: 
[0m03:12:35.110791 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m03:12:35.112115 [debug] [MainThread]: Command end result
[0m03:12:35.161144 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:12:35.162859 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:12:35.168017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m03:12:35.168325 [info ] [MainThread]: 
[0m03:12:35.168650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:12:35.168923 [info ] [MainThread]: 
[0m03:12:35.169224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m03:12:35.170018 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7442186, "process_in_blocks": "1104", "process_kernel_time": 0.232362, "process_mem_max_rss": "161872", "process_out_blocks": "4424", "process_user_time": 2.814394}
[0m03:12:35.170414 [debug] [MainThread]: Command `dbt run` succeeded at 03:12:35.170329 after 1.74 seconds
[0m03:12:35.170725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff8573f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff70d9ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff836099d0>]}
[0m03:12:35.171035 [debug] [MainThread]: Flushing usage events
[0m03:12:36.605126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:14:09.324247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035ad4e6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aaac0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035ab603bc0>]}


============================== 03:14:09.327870 | d534b6c9-6ee9-4ce7-a897-c32e3b830165 ==============================
[0m03:14:09.327870 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:14:09.328348 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select meta_table_info', 'log_path': '/home/chun/Develop/datacore/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/chun/Develop/datacore', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False'}
[0m03:14:09.531044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035a6720890>]}
[0m03:14:09.591726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035ab0a7080>]}
[0m03:14:09.593924 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:14:09.692464 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:14:09.832320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:14:09.833149 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/schema.yml
[0m03:14:09.833480 [debug] [MainThread]: Partial parsing: updated file: datacore://models/metadata/meta_data_lineage.sql
[0m03:14:09.833830 [debug] [MainThread]: Partial parsing: updated file: datacore://macros/metadata/generate_lineage.sql
[0m03:14:10.221762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035981b6de0>]}
[0m03:14:10.422817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:14:10.424773 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:14:10.439314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035980f4b90>]}
[0m03:14:10.439854 [info ] [MainThread]: Found 1 seed, 19 models, 15 data tests, 4 sources, 466 macros
[0m03:14:10.440165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aefdbd70>]}
[0m03:14:10.441774 [info ] [MainThread]: 
[0m03:14:10.442091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:14:10.442367 [info ] [MainThread]: 
[0m03:14:10.442814 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:14:10.444027 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_datacore'
[0m03:14:10.484157 [debug] [ThreadPool]: Using duckdb connection "list_datacore"
[0m03:14:10.484552 [debug] [ThreadPool]: On list_datacore: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"datacore"'
    
  
  
[0m03:14:10.484825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:10.504436 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m03:14:10.505777 [debug] [ThreadPool]: On list_datacore: Close
[0m03:14:10.506483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore, now create_datacore_main_metadata)
[0m03:14:10.506874 [debug] [ThreadPool]: Creating schema "database: "datacore"
schema: "main_metadata"
"
[0m03:14:10.512916 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.513230 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
        select type from duckdb_databases()
        where lower(database_name)='datacore'
        and type='sqlite'
    
  
[0m03:14:10.513501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.514823 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.515929 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.516206 [debug] [ThreadPool]: On create_datacore_main_metadata: BEGIN
[0m03:14:10.516644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:14:10.516894 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.517145 [debug] [ThreadPool]: On create_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "create_datacore_main_metadata"} */

    
    
        create schema if not exists "datacore"."main_metadata"
    
[0m03:14:10.517602 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:14:10.518289 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:14:10.518566 [debug] [ThreadPool]: Using duckdb connection "create_datacore_main_metadata"
[0m03:14:10.518816 [debug] [ThreadPool]: On create_datacore_main_metadata: COMMIT
[0m03:14:10.519203 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:14:10.519473 [debug] [ThreadPool]: On create_datacore_main_metadata: Close
[0m03:14:10.526260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_datacore_main_metadata, now list_datacore_main_metadata)
[0m03:14:10.535319 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:14:10.535868 [debug] [ThreadPool]: On list_datacore_main_metadata: BEGIN
[0m03:14:10.536363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.537446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.537931 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_metadata"
[0m03:14:10.538444 [debug] [ThreadPool]: On list_datacore_main_metadata: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_metadata"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_metadata'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.553296 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m03:14:10.554589 [debug] [ThreadPool]: On list_datacore_main_metadata: ROLLBACK
[0m03:14:10.555576 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_metadata'
[0m03:14:10.555848 [debug] [ThreadPool]: On list_datacore_main_metadata: Close
[0m03:14:10.556385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_metadata, now list_datacore_main)
[0m03:14:10.559667 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:14:10.559952 [debug] [ThreadPool]: On list_datacore_main: BEGIN
[0m03:14:10.560195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.560759 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.561009 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main"
[0m03:14:10.561266 [debug] [ThreadPool]: On list_datacore_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.564602 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:14:10.565654 [debug] [ThreadPool]: On list_datacore_main: ROLLBACK
[0m03:14:10.566434 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main'
[0m03:14:10.566688 [debug] [ThreadPool]: On list_datacore_main: Close
[0m03:14:10.567207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main, now list_datacore_main_ods)
[0m03:14:10.570111 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:14:10.570440 [debug] [ThreadPool]: On list_datacore_main_ods: BEGIN
[0m03:14:10.570693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.571408 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.571668 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ods"
[0m03:14:10.571930 [debug] [ThreadPool]: On list_datacore_main_ods: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ods"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ods'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.577854 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m03:14:10.579024 [debug] [ThreadPool]: On list_datacore_main_ods: ROLLBACK
[0m03:14:10.579811 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ods'
[0m03:14:10.580071 [debug] [ThreadPool]: On list_datacore_main_ods: Close
[0m03:14:10.580625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ods, now list_datacore_main_ads)
[0m03:14:10.582815 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:14:10.583106 [debug] [ThreadPool]: On list_datacore_main_ads: BEGIN
[0m03:14:10.583363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.583940 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.584196 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_ads"
[0m03:14:10.584467 [debug] [ThreadPool]: On list_datacore_main_ads: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_ads"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_ads'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.588329 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:14:10.589489 [debug] [ThreadPool]: On list_datacore_main_ads: ROLLBACK
[0m03:14:10.590254 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_ads'
[0m03:14:10.590700 [debug] [ThreadPool]: On list_datacore_main_ads: Close
[0m03:14:10.591232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_ads, now list_datacore_main_staging)
[0m03:14:10.593552 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:14:10.593832 [debug] [ThreadPool]: On list_datacore_main_staging: BEGIN
[0m03:14:10.594076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.594621 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.594874 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_staging"
[0m03:14:10.595133 [debug] [ThreadPool]: On list_datacore_main_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_staging"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.599228 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:14:10.600410 [debug] [ThreadPool]: On list_datacore_main_staging: ROLLBACK
[0m03:14:10.601187 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_staging'
[0m03:14:10.601447 [debug] [ThreadPool]: On list_datacore_main_staging: Close
[0m03:14:10.602228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_staging, now list_datacore_main_dws)
[0m03:14:10.605084 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:14:10.605372 [debug] [ThreadPool]: On list_datacore_main_dws: BEGIN
[0m03:14:10.605616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.606164 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.606423 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dws"
[0m03:14:10.606683 [debug] [ThreadPool]: On list_datacore_main_dws: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dws"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dws'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.610072 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:14:10.611224 [debug] [ThreadPool]: On list_datacore_main_dws: ROLLBACK
[0m03:14:10.612013 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dws'
[0m03:14:10.612266 [debug] [ThreadPool]: On list_datacore_main_dws: Close
[0m03:14:10.612784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_datacore_main_dws, now list_datacore_main_dwd)
[0m03:14:10.615334 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:14:10.615623 [debug] [ThreadPool]: On list_datacore_main_dwd: BEGIN
[0m03:14:10.615868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:10.616476 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:14:10.616730 [debug] [ThreadPool]: Using duckdb connection "list_datacore_main_dwd"
[0m03:14:10.616985 [debug] [ThreadPool]: On list_datacore_main_dwd: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "connection_name": "list_datacore_main_dwd"} */
select
      'datacore' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_dwd'
    and lower(table_catalog) = 'datacore'
  
[0m03:14:10.620292 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:14:10.621537 [debug] [ThreadPool]: On list_datacore_main_dwd: ROLLBACK
[0m03:14:10.622341 [debug] [ThreadPool]: Failed to rollback 'list_datacore_main_dwd'
[0m03:14:10.622598 [debug] [ThreadPool]: On list_datacore_main_dwd: Close
[0m03:14:10.623707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70359805ad50>]}
[0m03:14:10.624596 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.625119 [debug] [MainThread]: On master: BEGIN
[0m03:14:10.625649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:14:10.626698 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:14:10.627241 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.627803 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.628333 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.629202 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:14:10.629766 [debug] [MainThread]: On master: Close
[0m03:14:10.633339 [debug] [Thread-1 (]: Began running node model.datacore.meta_table_info
[0m03:14:10.634252 [info ] [Thread-1 (]: 1 of 1 START sql table model main_metadata.meta_table_info ..................... [RUN]
[0m03:14:10.634999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_datacore_main_dwd, now model.datacore.meta_table_info)
[0m03:14:10.635617 [debug] [Thread-1 (]: Began compiling node model.datacore.meta_table_info
[0m03:14:10.667898 [debug] [Thread-1 (]: Writing injected SQL for node "model.datacore.meta_table_info"
[0m03:14:10.668632 [debug] [Thread-1 (]: Began executing node model.datacore.meta_table_info
[0m03:14:10.702018 [debug] [Thread-1 (]: Writing runtime sql for node "model.datacore.meta_table_info"
[0m03:14:10.702778 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.703147 [debug] [Thread-1 (]: On model.datacore.meta_table_info: BEGIN
[0m03:14:10.703508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:14:10.704380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.704733 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.705296 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

  
    
    

    create  table
      "datacore"."main_metadata"."meta_table_info__dbt_tmp"
  
    as (
      -- ÂÖÉÊï∞ÊçÆÁÆ°ÁêÜÔºöË°®‰ø°ÊÅØË°®ÔºàËá™Âä®ÂåñÁîüÊàêÔºâ
-- ÂäüËÉΩÔºö‰ªé dbt graph Ëá™Âä®ÊèêÂèñÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ
-- ‰∏öÂä°‰ø°ÊÅØ‰ªé schema.yml ÁöÑ meta Â≠óÊÆµËé∑ÂèñÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàô‰ΩøÁî®ÈªòËÆ§ÂÄº



SELECT 'main_metadata' AS schema_name, 'meta_data_asset_catalog' AS table_name, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩï' AS table_name_cn, 'Êï∞ÊçÆËµÑ‰∫ßÁõÆÂΩïÔºåÊï∞ÊçÆËµÑ‰∫ßÊ∏ÖÂçïÂíå‰ª∑ÂÄºËØÑ‰º∞' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_quality_metrics' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÊåáÊ†áË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË¥®ÈáèÊåáÊ†áÂíåË∂ãÂäø' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_dictionary' AS table_name, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®' AS table_name_cn, 'Êï∞ÊçÆÂ≠óÂÖ∏Ë°®ÔºåÁªü‰∏ÄÁÆ°ÁêÜ‰∏öÂä°Êï∞ÊçÆÂ≠óÂÖ∏' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_column_info' AS table_name, 'meta_column_info' AS table_name_cn, '' AS table_description, 'Êú™ÂàÜÁ±ª' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊ∏ÖÊ¥óË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊï∞ÊçÆÊ∏ÖÊ¥óÂ±ÇÔºåËøõË°åÊï∞ÊçÆÊ∏ÖÊ¥ó„ÄÅÊ†áÂáÜÂåñÂíåÂºÇÂ∏∏ÂÄºÂ§ÑÁêÜ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_payment_method_dict' AS table_name, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ÊîØ‰ªòÊñπÂºèÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'ÊîØ‰ªòÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'ÊîØ‰ªò‰∏≠ÂøÉ' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_staging' AS schema_name, 'stg_vehicle_type_dict' AS table_name, 'ËΩ¶ÂûãÂ≠óÂÖ∏Ê∏ÖÊ¥óË°®' AS table_name_cn, 'ËΩ¶ÂûãÂ≠óÂÖ∏Êï∞ÊçÆÊ∏ÖÊ¥óÂ±Ç' AS table_description, 'Âü∫Á°ÄÊï∞ÊçÆ' AS business_domain, 'Êî∂Ë¥πÊîøÁ≠ñ' AS data_source, 'ÊåâÊîøÁ≠ñË∞ÉÊï¥' AS update_frequency, 'ÊîøÁ≠ñÊ≥ïËßÑÈÉ®' AS owner, 'main_staging' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_table_info' AS table_name, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®' AS table_name_cn, 'Ë°®‰ø°ÊÅØÂÖÉÊï∞ÊçÆË°®ÔºåËÆ∞ÂΩïÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_toll_revenue_daily' AS table_name, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªË°®' AS table_name_cn, 'Êó•Êî∂Ë¥πÊî∂ÂÖ•Ê±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅËΩ¶Âûã„ÄÅÊîØ‰ªòÊñπÂºèÁ≠âÁª¥Â∫¶Ê±áÊÄª' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_station_performance_daily' AS table_name, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊó•Áª©ÊïàÊ±áÊÄªÔºåÊî∂Ë¥πÁ´ôÁª¥Â∫¶ÁöÑÁªºÂêàÁª©ÊïàÊåáÊ†á' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dws' AS schema_name, 'dws_traffic_flow_daily' AS table_name, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªË°®' AS table_name_cn, 'Êó•ËΩ¶ÊµÅÈáèÊ±áÊÄªÔºåÊåâÊó•Êúü„ÄÅÊî∂Ë¥πÁ´ô„ÄÅÊó∂ÊÆµÁ≠âÁª¥Â∫¶Ê±áÊÄªËΩ¶ÊµÅÈáè' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dws' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_transaction' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®Ôºå‰øùÊåÅ‰∏öÂä°ÂéüÂßãÈÄªËæëÔºåÂÖ≥ËÅîÂ≠óÂÖ∏Ë°®ÔºåÂ¢ûÂä†‰∏öÂä°Â≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ods' AS schema_name, 'ods_toll_station' AS table_name, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆË°®' AS table_name_cn, 'Êî∂Ë¥πÁ´ôÊìç‰ΩúÊï∞ÊçÆÂ≠òÂÇ®' AS table_description, 'Ë∑ØÁΩëÁÆ°ÁêÜ' AS business_domain, 'Ë∑ØÁΩëÁÆ°ÁêÜÁ≥ªÁªü' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Ë∑ØÁΩëÁÆ°ÁêÜÈÉ®' AS owner, 'main_ods' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_traffic_trend_analysis' AS table_name, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêË°®' AS table_name_cn, 'ËΩ¶ÊµÅË∂ãÂäøÂàÜÊûêÔºåËΩ¶ÊµÅË∂ãÂäøÂíåÊ®°ÂºèÂàÜÊûê' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_toll_revenue_report' AS table_name, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®' AS table_name_cn, 'Êî∂Ë¥πÊî∂ÂÖ•Êä•Ë°®ÔºåÈù¢Âêë‰∏öÂä°Â∫îÁî®ÁöÑÊî∂ÂÖ•Êä•Ë°®' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'Êó•' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_ads' AS schema_name, 'ads_quality_monitoring_dashboard' AS table_name, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùø' AS table_name_cn, 'Êï∞ÊçÆË¥®ÈáèÁõëÊéßÁúãÊùøÔºåÊï∞ÊçÆË¥®ÈáèÁõëÊéßÂíåÂëäË≠¶' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êï∞ÊçÆÁÆ°ÁêÜÈÉ®' AS owner, 'main_ads' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_dwd' AS schema_name, 'dwd_toll_transaction_detail' AS table_name, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜË°®' AS table_name_cn, 'Êî∂Ë¥π‰∫§ÊòìÊòéÁªÜÊï∞ÊçÆÂ±ÇÔºåÂåÖÂê´ÂÆåÊï¥ÁöÑ‰∏öÂä°ÊòéÁªÜÊï∞ÊçÆÂíå‰∏öÂä°ÂàÜÁ±ªÂ≠óÊÆµ' AS table_description, 'Êî∂Ë¥π‰∏öÂä°' AS business_domain, 'Êî∂Ë¥πÁ≥ªÁªü' AS data_source, 'ÂÆûÊó∂' AS update_frequency, 'Êî∂Ë¥π‰∏≠ÂøÉ' AS owner, 'main_dwd' AS data_layer, CURRENT_TIMESTAMP AS create_time
UNION ALL
SELECT 'main_metadata' AS schema_name, 'meta_data_lineage' AS table_name, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®' AS table_name_cn, 'Êï∞ÊçÆÊ∫ØÊ∫êÂÖ≥Á≥ªË°®ÔºåËÆ∞ÂΩïÊï∞ÊçÆË°®‰πãÈó¥ÁöÑÊ∫ØÊ∫êÂÖ≥Á≥ª' AS table_description, 'Êï∞ÊçÆÁÆ°ÁêÜ' AS business_domain, 'Êï∞ÊçÆ‰∏≠Âè∞' AS data_source, 'ÊåâÈúÄ' AS update_frequency, 'Êï∞ÊçÆÂõ¢Èòü' AS owner, 'main_metadata' AS data_layer, CURRENT_TIMESTAMP AS create_time
    );
  
  
[0m03:14:10.713620 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m03:14:10.719689 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.720091 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:14:10.721236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.722475 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.722833 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_metadata'
      AND table_name = 'meta_table_info'
  
[0m03:14:10.723864 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.730373 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.730836 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info" rename to "meta_table_info__dbt_backup"
[0m03:14:10.731768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.735994 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.736406 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */
alter table "datacore"."main_metadata"."meta_table_info__dbt_tmp" rename to "meta_table_info"
[0m03:14:10.737362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.752624 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:14:10.753103 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.753469 [debug] [Thread-1 (]: On model.datacore.meta_table_info: COMMIT
[0m03:14:10.755546 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:14:10.761849 [debug] [Thread-1 (]: Using duckdb connection "model.datacore.meta_table_info"
[0m03:14:10.762318 [debug] [Thread-1 (]: On model.datacore.meta_table_info: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "datacore", "target_name": "dev", "node_id": "model.datacore.meta_table_info"} */

      drop table if exists "datacore"."main_metadata"."meta_table_info__dbt_backup" cascade
    
[0m03:14:10.763962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:14:10.766319 [debug] [Thread-1 (]: On model.datacore.meta_table_info: Close
[0m03:14:10.768488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd534b6c9-6ee9-4ce7-a897-c32e3b830165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703558575340>]}
[0m03:14:10.769096 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_metadata.meta_table_info ................ [[32mOK[0m in 0.13s]
[0m03:14:10.769666 [debug] [Thread-1 (]: Finished running node model.datacore.meta_table_info
[0m03:14:10.771161 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.771970 [debug] [MainThread]: On master: BEGIN
[0m03:14:10.772547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:14:10.773740 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:14:10.774297 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.774869 [debug] [MainThread]: Using duckdb connection "master"
[0m03:14:10.775424 [debug] [MainThread]: On master: COMMIT
[0m03:14:10.776346 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:14:10.776911 [debug] [MainThread]: On master: Close
[0m03:14:10.777711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:14:10.778227 [debug] [MainThread]: Connection 'model.datacore.meta_table_info' was properly closed.
[0m03:14:10.778812 [info ] [MainThread]: 
[0m03:14:10.779445 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m03:14:10.780679 [debug] [MainThread]: Command end result
[0m03:14:10.830579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/chun/Develop/datacore/target/manifest.json
[0m03:14:10.832425 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/chun/Develop/datacore/target/semantic_manifest.json
[0m03:14:10.837559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/chun/Develop/datacore/target/run_results.json
[0m03:14:10.837857 [info ] [MainThread]: 
[0m03:14:10.838215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:14:10.838497 [info ] [MainThread]: 
[0m03:14:10.838797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:14:10.839617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5676045, "process_in_blocks": "0", "process_kernel_time": 0.246135, "process_mem_max_rss": "160004", "process_out_blocks": "4168", "process_user_time": 2.597876}
[0m03:14:10.840014 [debug] [MainThread]: Command `dbt run` succeeded at 03:14:10.839931 after 1.57 seconds
[0m03:14:10.840352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aa9dffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aa9959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7035aa995490>]}
[0m03:14:10.840673 [debug] [MainThread]: Flushing usage events
[0m03:14:11.976048 [debug] [MainThread]: An error was encountered while trying to flush usage events
